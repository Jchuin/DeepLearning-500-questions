<!DOCTYPE html><html><head>
      <title>&#x7B2C;&#x5341;&#x4E03;&#x7AE0;_&#x6A21;&#x578B;&#x538B;&#x7F29;&#x3001;&#x52A0;&#x901F;&#x53CA;&#x79FB;&#x52A8;&#x7AEF;&#x90E8;&#x7F72;</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css">
      
      
      
      
      
      
      
      
      

      <style> 
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
 
      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <ul>
<li><a href="#%E7%AC%AC%E5%8D%81%E4%B8%83%E7%AB%A0-%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9%E5%8F%8A%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%83%A8%E7%BD%B2">&#x7B2C;&#x5341;&#x4E03;&#x7AE0; &#x6A21;&#x578B;&#x538B;&#x7F29;&#x53CA;&#x79FB;&#x52A8;&#x7AEF;&#x90E8;&#x7F72;</a>
<ul>
<li><a href="#171-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9%E5%92%8C%E5%8A%A0%E9%80%9F">17.1 &#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x548C;&#x52A0;&#x901F;&#xFF1F;</a></li>
<li><a href="#172-%E7%9B%AE%E5%89%8D%E6%9C%89%E5%93%AA%E4%BA%9B%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9%E6%96%B9%E6%B3%95">17.2 &#x76EE;&#x524D;&#x6709;&#x54EA;&#x4E9B;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x65B9;&#x6CD5;&#xFF1F;</a>
<ul>
<li><a href="#1721-%E5%89%8D%E7%AB%AF%E5%8E%8B%E7%BC%A9">17.2.1 &#x524D;&#x7AEF;&#x538B;&#x7F29;</a></li>
<li><a href="#1722-%E5%90%8E%E7%AB%AF%E5%8E%8B%E7%BC%A9">17.2.2 &#x540E;&#x7AEF;&#x538B;&#x7F29;</a></li>
</ul>
</li>
<li><a href="#173-%E7%9B%AE%E5%89%8D%E6%9C%89%E5%93%AA%E4%BA%9B%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B%E4%BC%98%E5%8C%96%E5%8A%A0%E9%80%9F%E6%96%B9%E6%B3%95">17.3 &#x76EE;&#x524D;&#x6709;&#x54EA;&#x4E9B;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#x4F18;&#x5316;&#x52A0;&#x901F;&#x65B9;&#x6CD5;&#xFF1F;</a></li>
<li><a href="#174-%E5%BD%B1%E5%93%8D%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E9%80%9F%E5%BA%A6%E7%9A%844%E4%B8%AA%E5%9B%A0%E7%B4%A0%E5%86%8D%E7%A8%8D%E5%BE%AE%E8%AF%A6%E7%BB%86%E4%B8%80%E7%82%B9">17.4 &#x5F71;&#x54CD;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x901F;&#x5EA6;&#x7684;4&#x4E2A;&#x56E0;&#x7D20;&#xFF08;&#x518D;&#x7A0D;&#x5FAE;&#x8BE6;&#x7EC6;&#x4E00;&#x70B9;&#xFF09;</a></li>
<li><a href="#175-%E6%94%B9%E5%8F%98%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E5%AE%9E%E7%8E%B0%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9-%E5%8A%A0%E9%80%9F">17.5 &#x6539;&#x53D8;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x8BBE;&#x8BA1;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x5B9E;&#x73B0;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x3001;&#x52A0;&#x901F;&#xFF1F;</a>
<ul>
<li><a href="#1-group-convolution">1. Group convolution</a></li>
<li><a href="#2-depthwise-separable-convolution">2. Depthwise separable convolution</a></li>
<li><a href="#3-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%9A%84channel%E7%9B%B8%E5%90%8C%E6%97%B6mac%E6%9C%80%E5%B0%8F">3. &#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7684;channel&#x76F8;&#x540C;&#x65F6;&#xFF0C;MAC&#x6700;&#x5C0F;</a></li>
<li><a href="#4-%E5%87%8F%E5%B0%91%E7%BB%84%E5%8D%B7%E7%A7%AF%E7%9A%84%E6%95%B0%E9%87%8F">4. &#x51CF;&#x5C11;&#x7EC4;&#x5377;&#x79EF;&#x7684;&#x6570;&#x91CF;</a></li>
<li><a href="#5-%E5%87%8F%E5%B0%91%E7%BD%91%E7%BB%9C%E7%A2%8E%E7%89%87%E5%8C%96%E7%A8%8B%E5%BA%A6%E5%88%86%E6%94%AF%E6%95%B0%E9%87%8F">5. &#x51CF;&#x5C11;&#x7F51;&#x7EDC;&#x788E;&#x7247;&#x5316;&#x7A0B;&#x5EA6;(&#x5206;&#x652F;&#x6570;&#x91CF;)</a></li>
<li><a href="#6-%E5%87%8F%E5%B0%91%E5%85%83%E7%B4%A0%E7%BA%A7%E6%93%8D%E4%BD%9C">6. &#x51CF;&#x5C11;&#x5143;&#x7D20;&#x7EA7;&#x64CD;&#x4F5C;</a></li>
</ul>
</li>
<li><a href="#176-%E5%B8%B8%E7%94%A8%E7%9A%84%E8%BD%BB%E9%87%8F%E7%BA%A7%E7%BD%91%E7%BB%9C%E6%9C%89%E5%93%AA%E4%BA%9B%E5%86%8D%E7%90%A2%E7%A3%A8%E4%B8%8B%E8%AF%AD%E8%A8%80%E5%92%8C%E6%8E%92%E7%89%88">17.6 &#x5E38;&#x7528;&#x7684;&#x8F7B;&#x91CF;&#x7EA7;&#x7F51;&#x7EDC;&#x6709;&#x54EA;&#x4E9B;&#xFF1F;&#xFF08;&#x518D;&#x7422;&#x78E8;&#x4E0B;&#x8BED;&#x8A00;&#x548C;&#x6392;&#x7248;&#xFF09;</a>
<ul>
<li><a href="#1-sequeezenet">1. SequeezeNet</a>
<ul>
<li><a href="#11-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">1.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</a></li>
<li><a href="#12-%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">1.2 &#x7F51;&#x7EDC;&#x67B6;&#x6784;</a></li>
<li><a href="#13%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C">1.3&#x5B9E;&#x9A8C;&#x7ED3;&#x679C;</a></li>
</ul>
</li>
<li><a href="#2-mobilenet">2. MobileNet</a>
<ul>
<li><a href="#21-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">2.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</a></li>
<li><a href="#22-%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">2.2 &#x7F51;&#x7EDC;&#x67B6;&#x6784;</a></li>
<li><a href="#23-%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C">2.3 &#x5B9E;&#x9A8C;&#x7ED3;&#x679C;</a></li>
</ul>
</li>
<li><a href="#3-mobilenet-v2">3. MobileNet-v2</a>
<ul>
<li><a href="#31-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">3.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</a></li>
<li><a href="#32-%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">3.2 &#x7F51;&#x7EDC;&#x67B6;&#x6784;</a></li>
</ul>
</li>
<li><a href="#4-xception">4. Xception</a>
<ul>
<li><a href="#41%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">4.1&#x8BBE;&#x8BA1;&#x601D;&#x60F3;</a></li>
<li><a href="#42%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">4.2&#x7F51;&#x7EDC;&#x67B6;&#x6784;</a></li>
</ul>
</li>
<li><a href="#5-shufflenet-v1">5. ShuffleNet-v1</a>
<ul>
<li><a href="#51-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">5.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</a></li>
<li><a href="#52-%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">5.2 &#x7F51;&#x7EDC;&#x67B6;&#x6784;</a></li>
</ul>
</li>
<li><a href="#6-shufflenet-v2">6. ShuffleNet-v2</a>
<ul>
<li><a href="#61-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">6.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</a></li>
<li><a href="#62-%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84">6.2 &#x7F51;&#x7EDC;&#x7ED3;&#x6784;</a></li>
<li><a href="#64-shufflenet-v2%E5%85%B7%E6%9C%89%E9%AB%98%E7%B2%BE%E5%BA%A6%E7%9A%84%E5%8E%9F%E5%9B%A0">6.4  ShuffleNet-v2&#x5177;&#x6709;&#x9AD8;&#x7CBE;&#x5EA6;&#x7684;&#x539F;&#x56E0;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#177-%E7%8E%B0%E6%9C%89%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6%E5%8F%8A%E5%85%B6%E7%89%B9%E7%82%B9">17.7 &#x73B0;&#x6709;&#x79FB;&#x52A8;&#x7AEF;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#x53CA;&#x5176;&#x7279;&#x70B9;</a>
<ul>
<li><a href="#1771-ncnn">17.7.1 NCNN</a></li>
<li><a href="#1772-qnnpack">17.7.2 QNNPACK</a></li>
<li><a href="#1773-prestissimo">17.7.3 Prestissimo</a></li>
<li><a href="#1774-mdlmobile-deep-learning">17.7.4 MDL&#xFF08;mobile-deep-learning&#xFF09;</a></li>
<li><a href="#1775-paddle-mobile">17.7.5 Paddle-Mobile</a></li>
<li><a href="#1776-mace-mobile-ai-compute-engine">17.7.6 MACE&#xFF08; Mobile AI Compute Engine&#xFF09;</a></li>
<li><a href="#1777-feathercnn">17.7.7 FeatherCNN</a></li>
<li><a href="#1778-tensorflow-lite">17.7.8 TensorFlow Lite</a></li>
<li><a href="#1779-pocketflow">17.7.9 PocketFlow</a></li>
<li><a href="#17710-%E5%85%B6%E4%BB%96%E5%87%A0%E6%AC%BE%E6%94%AF%E6%8C%81%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6">17.7.10 &#x5176;&#x4ED6;&#x51E0;&#x6B3E;&#x652F;&#x6301;&#x79FB;&#x52A8;&#x7AEF;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x7684;&#x5F00;&#x6E90;&#x6846;&#x67B6;</a></li>
<li><a href="#17711-mdl-ncnn%E5%92%8C-tflite%E6%AF%94%E8%BE%83">17.7.11 MDL&#x3001;NCNN&#x548C; TFLite&#x6BD4;&#x8F83;</a></li>
</ul>
</li>
<li><a href="#178-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2">17.8 &#x79FB;&#x52A8;&#x7AEF;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#x90E8;&#x7F72;</a>
<ul>
<li><a href="#1781-%E4%BB%A5ncnn%E4%B8%BA%E4%BE%8B">17.8.1 &#x4EE5;NCNN&#x4E3A;&#x4F8B;</a></li>
<li><a href="#1782-%E4%BB%A5qnnpack%E4%B8%BA%E4%BE%8B">17.8.2 &#x4EE5;QNNPACK&#x4E3A;&#x4F8B;</a></li>
<li><a href="#1784-%E5%9C%A8android%E6%89%8B%E6%9C%BA%E4%B8%8A%E4%BD%BF%E7%94%A8mace%E5%AE%9E%E7%8E%B0%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB">17.8.4 &#x5728;Android&#x624B;&#x673A;&#x4E0A;&#x4F7F;&#x7528;MACE&#x5B9E;&#x73B0;&#x56FE;&#x50CF;&#x5206;&#x7C7B;</a></li>
<li><a href="#1783-%E5%9C%A8android%E6%89%8B%E6%9C%BA%E4%B8%8A%E4%BD%BF%E7%94%A8paddlemobile%E5%AE%9E%E7%8E%B0%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB">17.8.3 &#x5728;Android&#x624B;&#x673A;&#x4E0A;&#x4F7F;&#x7528;PaddleMobile&#x5B9E;&#x73B0;&#x56FE;&#x50CF;&#x5206;&#x7C7B;</a></li>
</ul>
</li>
<li><a href="#179-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2%E7%96%91%E9%9A%BE">17.9 &#x79FB;&#x52A8;&#x7AEF;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#x90E8;&#x7F72;&#x7591;&#x96BE;</a></li>
</ul>
</li>
</ul>
<h1 class="mume-header" id="%E7%AC%AC%E5%8D%81%E4%B8%83%E7%AB%A0-%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9%E5%8F%8A%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%83%A8%E7%BD%B2">&#x7B2C;&#x5341;&#x4E03;&#x7AE0; &#x6A21;&#x578B;&#x538B;&#x7F29;&#x53CA;&#x79FB;&#x52A8;&#x7AEF;&#x90E8;&#x7F72;</h1>

<pre class="language-text">Markdown Revision 1;
Date: 2018/11/4
Editor: &#x8C08;&#x7EE7;&#x52C7;
Contact: scutjy2015@163.com
updata:&#x8D35;&#x5DDE;&#x5927;&#x5B66;&#x7855;&#x58EB;&#x5F20;&#x8FBE;&#x5CF0;
</pre>
<h2 class="mume-header" id="171-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9%E5%92%8C%E5%8A%A0%E9%80%9F">17.1 &#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x548C;&#x52A0;&#x901F;&#xFF1F;</h2>

<p>&#xFF08;1&#xFF09;&#x968F;&#x7740;AI&#x6280;&#x672F;&#x7684;&#x98DE;&#x901F;&#x53D1;&#x5C55;&#xFF0C;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#x7684;&#x516C;&#x53F8;&#x5E0C;&#x671B;&#x5728;&#x81EA;&#x5DF1;&#x7684;&#x79FB;&#x52A8;&#x7AEF;&#x4EA7;&#x54C1;&#x4E2D;&#x6CE8;&#x5165;AI&#x80FD;&#x529B;</p>
<p>&#xFF08;2&#xFF09;&#x5BF9;&#x4E8E;&#x5728;&#x7EBF;&#x5B66;&#x4E60;&#x548C;&#x589E;&#x91CF;&#x5B66;&#x4E60;&#x7B49;&#x5B9E;&#x65F6;&#x5E94;&#x7528;&#x800C;&#x8A00;&#xFF0C;&#x5982;&#x4F55;&#x51CF;&#x5C11;&#x542B;&#x6709;&#x5927;&#x91CF;&#x5C42;&#x7EA7;&#x53CA;&#x7ED3;&#x70B9;&#x7684;&#x5927;&#x578B;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x6240;&#x9700;&#x8981;&#x7684;&#x5185;&#x5B58;&#x548C;&#x8BA1;&#x7B97;&#x91CF;&#x663E;&#x5F97;&#x6781;&#x4E3A;&#x91CD;&#x8981;&#x3002;<br>
&#xFF08;3&#xFF09;&#x667A;&#x80FD;&#x8BBE;&#x5907;&#x7684;&#x6D41;&#x884C;&#x63D0;&#x4F9B;&#x4E86;&#x5185;&#x5B58;&#x3001;CPU&#x3001;&#x80FD;&#x8017;&#x548C;&#x5BBD;&#x5E26;&#x7B49;&#x8D44;&#x6E90;&#xFF0C;&#x4F7F;&#x5F97;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#x90E8;&#x7F72;&#x5728;&#x667A;&#x80FD;&#x79FB;&#x52A8;&#x8BBE;&#x5907;&#x4E0A;&#x53D8;&#x5F97;&#x53EF;&#x884C;&#x3002;<br>
&#xFF08;4&#xFF09;&#x9AD8;&#x6548;&#x7684;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x6709;&#x6548;&#x7684;&#x5E2E;&#x52A9;&#x5D4C;&#x5165;&#x5F0F;&#x8BBE;&#x5907;&#x3001;&#x5206;&#x5E03;&#x5F0F;&#x7CFB;&#x7EDF;&#x5B8C;&#x6210;&#x590D;&#x6742;&#x5DE5;&#x4F5C;&#xFF0C;&#x5728;&#x79FB;&#x52A8;&#x7AEF;&#x90E8;&#x7F72;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6709;&#x5F88;&#x91CD;&#x8981;&#x7684;&#x610F;&#x4E49;&#x3002;</p>
<h2 class="mume-header" id="172-%E7%9B%AE%E5%89%8D%E6%9C%89%E5%93%AA%E4%BA%9B%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9%E6%96%B9%E6%B3%95">17.2 &#x76EE;&#x524D;&#x6709;&#x54EA;&#x4E9B;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x65B9;&#x6CD5;&#xFF1F;</h2>

<p><a href="https://blog.csdn.net/wspba/article/details/75671573">https://blog.csdn.net/wspba/article/details/75671573</a><br>
<a href="https://blog.csdn.net/Touch_Dream/article/details/78441332">https://blog.csdn.net/Touch_Dream/article/details/78441332</a></p>
<h3 class="mume-header" id="1721-%E5%89%8D%E7%AB%AF%E5%8E%8B%E7%BC%A9">17.2.1 &#x524D;&#x7AEF;&#x538B;&#x7F29;</h3>

<p>&#xFF08;1&#xFF09;&#x77E5;&#x8BC6;&#x84B8;&#x998F;&#xFF08;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#xFF09;<br>
&#x4E00;&#x4E2A;&#x590D;&#x6742;&#x7684;&#x6A21;&#x578B;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;&#x662F;&#x7531;&#x591A;&#x4E2A;&#x7B80;&#x5355;&#x6A21;&#x578B;&#x6216;&#x8005;&#x5F3A;&#x7EA6;&#x675F;&#x6761;&#x4EF6;&#x8BAD;&#x7EC3;&#x800C;&#x6765;&#xFF0C;&#x5177;&#x6709;&#x5F88;&#x597D;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x4F46;&#x662F;&#x53C2;&#x6570;&#x91CF;&#x5F88;&#x5927;&#xFF0C;&#x8BA1;&#x7B97;&#x6548;&#x7387;&#x4F4E;&#xFF0C;&#x800C;&#x5C0F;&#x6A21;&#x578B;&#x8BA1;&#x7B97;&#x6548;&#x7387;&#x9AD8;&#xFF0C;&#x4F46;&#x662F;&#x5176;&#x6027;&#x80FD;&#x8F83;&#x5DEE;&#x3002;&#x77E5;&#x8BC6;&#x84B8;&#x998F;&#x662F;&#x8BA9;&#x590D;&#x6742;&#x6A21;&#x578B;&#x5B66;&#x4E60;&#x5230;&#x7684;&#x77E5;&#x8BC6;&#x8FC1;&#x79FB;&#x5230;&#x5C0F;&#x6A21;&#x578B;&#x5F53;&#x4E2D;,&#x4F7F;&#x5176;&#x4FDD;&#x6301;&#x5176;&#x5FEB;&#x901F;&#x7684;&#x8BA1;&#x7B97;&#x901F;&#x5EA6;&#x524D;&#x63D0;&#x4E0B;&#xFF0C;&#x540C;&#x65F6;&#x62E5;&#x6709;&#x590D;&#x6742;&#x6A21;&#x578B;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x8FBE;&#x5230;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x7684;&#x76EE;&#x7684;&#x3002;&#x4F46;&#x4E0E;&#x526A;&#x679D;&#x3001;&#x91CF;&#x5316;&#x7B49;&#x65B9;&#x6CD5;&#x60F3;&#x6BD4;&#xFF0C;&#x6548;&#x679C;&#x8F83;&#x5DEE;&#x3002;(<a href="https://blog.csdn.net/Lucifer_zzq/article/details/79489248">https://blog.csdn.net/Lucifer_zzq/article/details/79489248</a>)<br>
&#xFF08;2&#xFF09;&#x7D27;&#x51D1;&#x7684;&#x6A21;&#x578B;&#x7ED3;&#x6784;&#x8BBE;&#x8BA1;&#xFF08;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#xFF09;<br>
&#x7D27;&#x51D1;&#x7684;&#x6A21;&#x578B;&#x7ED3;&#x6784;&#x8BBE;&#x8BA1;&#x4E3B;&#x8981;&#x662F;&#x5BF9;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5377;&#x79EF;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x6539;&#x8FDB;&#xFF0C;&#x6BD4;&#x5982;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;3x3&#x7684;&#x5377;&#x79EF;&#x66FF;&#x6362;&#x4E00;&#x4E2A;5x5&#x7684;&#x5377;&#x79EF;&#x3001;&#x4F7F;&#x7528;&#x6DF1;&#x5EA6;&#x53EF;&#x5206;&#x79BB;&#x5377;&#x79EF;&#x7B49;&#x7B49;&#x65B9;&#x5F0F;&#x964D;&#x4F4E;&#x8BA1;&#x7B97;&#x53C2;&#x6570;&#x91CF;&#x3002;<br>
&#xFF08;3&#xFF09;&#x6EE4;&#x6CE2;&#x5668;&#x5C42;&#x9762;&#x7684;&#x526A;&#x679D;&#xFF08;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#xFF09;<br>
&#x53C2;&#x8003;&#x94FE;&#x63A5;  <a href="https://blog.csdn.net/JNingWei/article/details/79218745">https://blog.csdn.net/JNingWei/article/details/79218745</a> &#x8865;&#x5145;&#x4F18;&#x7F3A;&#x70B9;<br>
&#x6EE4;&#x6CE2;&#x5668;&#x5C42;&#x9762;&#x7684;&#x526A;&#x679D;&#x5C5E;&#x4E8E;&#x975E;&#x7ED3;&#x6784;&#x82B1;&#x526A;&#x679D;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x5BF9;&#x8F83;&#x5C0F;&#x7684;&#x6743;&#x91CD;&#x77E9;&#x9635;&#x6574;&#x4E2A;&#x5254;&#x9664;&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x6574;&#x4E2A;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x8FDB;&#x884C;&#x5FAE;&#x8C03;&#x3002;&#x6B64;&#x65B9;&#x5F0F;&#x7531;&#x4E8E;&#x526A;&#x679D;&#x8FC7;&#x4E8E;&#x7C97;&#x653E;&#xFF0C;&#x5BB9;&#x6613;&#x5BFC;&#x81F4;&#x7CBE;&#x5EA6;&#x635F;&#x5931;&#x8F83;&#x5927;&#xFF0C;&#x800C;&#x4E14;&#x90E8;&#x5206;&#x6743;&#x91CD;&#x77E9;&#x9635;&#x4E2D;&#x4F1A;&#x5B58;&#x7559;&#x4E00;&#x4E9B;&#x8F83;&#x5C0F;&#x7684;&#x6743;&#x91CD;&#x9020;&#x6210;&#x5197;&#x4F59;&#xFF0C;&#x526A;&#x679D;&#x4E0D;&#x5F7B;&#x5E95;&#x3002;</p>
<h3 class="mume-header" id="1722-%E5%90%8E%E7%AB%AF%E5%8E%8B%E7%BC%A9">17.2.2 &#x540E;&#x7AEF;&#x538B;&#x7F29;</h3>

<p>&#xFF08;1&#xFF09;&#x4F4E;&#x79E9;&#x8FD1;&#x4F3C;   &#xFF08;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#xFF0C;&#x53C2;&#x8003;&#x94FE;&#x63A5;&#x8865;&#x5145;&#x4F18;&#x7F3A;&#x70B9;&#xFF09;<br>
&#x5728;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#xFF0C;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x90FD;&#x662F;&#x4EE5;&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x3002;&#x5BF9;&#x4E8E;&#x590D;&#x6742;&#x7F51;&#x7EDC;&#xFF0C;&#x6743;&#x91CD;&#x77E9;&#x9635;&#x5F80;&#x5F80;&#x975E;&#x5E38;&#x5927;&#xFF0C;&#x975E;&#x5E38;&#x6D88;&#x8017;&#x5B58;&#x50A8;&#x548C;&#x8BA1;&#x7B97;&#x8D44;&#x6E90;&#x3002;&#x4F4E;&#x79E9;&#x8FD1;&#x4F3C;&#x5C31;&#x662F;&#x7528;&#x82E5;&#x5E72;&#x4E2A;&#x4F4E;&#x79E9;&#x77E9;&#x9635;&#x7EC4;&#x5408;&#x91CD;&#x6784;&#x5927;&#x7684;&#x6743;&#x91CD;&#x77E9;&#x9635;&#xFF0C;&#x4EE5;&#x6B64;&#x964D;&#x4F4E;&#x5B58;&#x50A8;&#x548C;&#x8BA1;&#x7B97;&#x8D44;&#x6E90;&#x6D88;&#x8017;&#x3002;<br>
&#x4F18;&#x70B9;&#xFF1A;</p>
<ul>
<li>
<p>&#x53EF;&#x4EE5;&#x964D;&#x4F4E;&#x5B58;&#x50A8;&#x548C;&#x8BA1;&#x7B97;&#x6D88;&#x8017;&#xFF1B;</p>
</li>
<li>
<p>&#x4E00;&#x822C;&#x53EF;&#x4EE5;&#x538B;&#x7F29;2-3&#x500D;&#xFF1B;&#x7CBE;&#x5EA6;&#x51E0;&#x4E4E;&#x6CA1;&#x6709;&#x635F;&#x5931;&#xFF1B;</p>
</li>
</ul>
<p>&#x7F3A;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x6A21;&#x578B;&#x8D8A;&#x590D;&#x6742;&#xFF0C;&#x6743;&#x91CD;&#x77E9;&#x9635;&#x8D8A;&#x5927;&#xFF0C;&#x5229;&#x7528;&#x4F4E;&#x79E9;&#x8FD1;&#x4F3C;&#x91CD;&#x6784;&#x53C2;&#x6570;&#x77E9;&#x9635;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x6A21;&#x578B;&#x7684;&#x6027;&#x80FD;</li>
</ul>
<p>&#xFF08;2&#xFF09;&#x672A;&#x52A0;&#x9650;&#x5236;&#x7684;&#x526A;&#x679D;   &#xFF08;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#xFF0C;&#x53C2;&#x8003;&#x94FE;&#x63A5;&#x8865;&#x5145;&#x4F18;&#x7F3A;&#x70B9;&#xFF09;<br>
&#x526A;&#x679D;&#x64CD;&#x4F5C;&#x5305;&#x62EC;&#xFF1A;&#x975E;&#x7ED3;&#x6784;&#x5316;&#x526A;&#x679D;&#x548C;&#x7ED3;&#x6784;&#x5316;&#x526A;&#x679D;&#x3002;&#x975E;&#x7ED3;&#x6784;&#x5316;&#x526A;&#x679D;&#x662F;&#x5BF9;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x6743;&#x91CD;&#x8F83;&#x5C0F;&#x7684;&#x6743;&#x91CD;&#x6216;&#x8005;&#x6743;&#x91CD;&#x77E9;&#x9635;&#x8FDB;&#x5254;&#x9664;&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x6574;&#x4E2A;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x8FDB;&#x884C;&#x5FAE;&#x8C03;&#xFF1B;&#x7ED3;&#x6784;&#x5316;&#x526A;&#x679D;&#x662F;&#x5728;&#x7F51;&#x7EDC;&#x4F18;&#x5316;&#x76EE;&#x6807;&#x4E2D;&#x52A0;&#x5165;&#x6743;&#x91CD;&#x7A00;&#x758F;&#x6B63;&#x5219;&#x9879;&#xFF0C;&#x4F7F;&#x90E8;&#x5206;&#x6743;&#x91CD;&#x5728;&#x8BAD;&#x7EC3;&#x65F6;&#x8D8B;&#x4E8E;0&#x3002;</p>
<p>&#x4F18;&#x70B9;&#xFF1A;</p>
<ul>
<li>
<p>&#x4FDD;&#x6301;&#x6A21;&#x578B;&#x6027;&#x80FD;&#x4E0D;&#x635F;&#x5931;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x51CF;&#x5C11;&#x53C2;&#x6570;&#x91CF;9-11&#x500D;&#xFF1B;</p>
</li>
<li>
<p>&#x5254;&#x9664;&#x4E0D;&#x91CD;&#x8981;&#x7684;&#x6743;&#x91CD;&#xFF0C;&#x53EF;&#x4EE5;&#x52A0;&#x5FEB;&#x8BA1;&#x7B97;&#x901F;&#x5EA6;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x6A21;&#x578B;&#x7684;&#x6CDB;&#x5316;&#x80FD;&#x529B;&#xFF1B;</p>
</li>
</ul>
<p>&#x7F3A;&#x70B9;&#xFF1A;</p>
<ul>
<li>
<p>&#x975E;&#x7ED3;&#x6784;&#x5316;&#x526A;&#x679D;&#x4F1A;&#x589E;&#x52A0;&#x5185;&#x5B58;&#x8BBF;&#x95EE;&#x6210;&#x672C;&#xFF1B;</p>
</li>
<li>
<p>&#x6781;&#x5EA6;&#x4F9D;&#x8D56;&#x4E13;&#x95E8;&#x7684;&#x8FD0;&#x884C;&#x5E93;&#x548C;&#x7279;&#x6B8A;&#x7684;&#x8FD0;&#x884C;&#x5E73;&#x53F0;&#xFF0C;&#x4E0D;&#x5177;&#x6709;&#x901A;&#x7528;&#x6027;&#xFF1B;</p>
</li>
<li>
<p>&#x538B;&#x7F29;&#x7387;&#x8FC7;&#x5927;&#x65F6;&#xFF0C;&#x7834;&#x574F;&#x6027;&#x80FD;&#xFF1B;</p>
</li>
</ul>
<p>&#xFF08;3&#xFF09;&#x53C2;&#x6570;&#x91CF;&#x5316;   &#xFF08;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#xFF0C;&#x53C2;&#x8003;&#x94FE;&#x63A5;&#x8865;&#x5145;&#x4F18;&#x7F3A;&#x70B9;&#xFF09;<br>
&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x53C2;&#x6570;&#x7C7B;&#x578B;&#x4E00;&#x822C;&#x662F;32&#x4F4D;&#x6D6E;&#x70B9;&#x578B;&#xFF0C;&#x4F7F;&#x7528;&#x8F83;&#x5C0F;&#x7684;&#x7CBE;&#x5EA6;&#x4EE3;&#x66FF;32&#x4F4D;&#x6240;&#x8868;&#x793A;&#x7684;&#x7CBE;&#x5EA6;&#x3002;&#x6216;&#x8005;&#x662F;&#x5C06;&#x591A;&#x4E2A;&#x6743;&#x91CD;&#x6620;&#x5C04;&#x5230;&#x540C;&#x4E00;&#x6570;&#x503C;&#xFF0C;&#x6743;&#x91CD;&#x5171;&#x4EAB;<br>
&#x4F18;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x6A21;&#x578B;&#x6027;&#x80FD;&#x635F;&#x5931;&#x5F88;&#x5C0F;&#xFF0C;&#x5927;&#x5C0F;&#x51CF;&#x5C11;8-16&#x500D;&#xFF1B;</li>
</ul>
<p>&#x7F3A;&#x70B9;&#xFF1A;</p>
<ul>
<li>
<p>&#x538B;&#x7F29;&#x7387;&#x5927;&#x65F6;&#xFF0C;&#x6027;&#x80FD;&#x663E;&#x8457;&#x4E0B;&#x964D;&#xFF1B;</p>
</li>
<li>
<p>&#x4F9D;&#x8D56;&#x4E13;&#x95E8;&#x7684;&#x8FD0;&#x884C;&#x5E93;&#xFF0C;&#x901A;&#x7528;&#x6027;&#x8F83;&#x5DEE;&#xFF1B;</p>
</li>
</ul>
<p>&#xFF08;4&#xFF09;&#x4E8C;&#x503C;&#x7F51;&#x7EDC;  &#xFF08;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#xFF0C;&#x53C2;&#x8003;&#x94FE;&#x63A5;&#x8865;&#x5145;&#x4F18;&#x7F3A;&#x70B9;&#xFF09;<br>
&#x5BF9;&#x4E8E;32bit&#x6D6E;&#x70B9;&#x578B;&#x6570;&#x7528;1bit&#x4E8C;&#x8FDB;&#x5236;&#x6570;-1&#x6216;&#x8005;1&#x8868;&#x793A;&#x3002;<br>
&#x4F18;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x7F51;&#x7EDC;&#x4F53;&#x79EF;&#x5C0F;&#xFF0C;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#x5FEB;</li>
</ul>
<p>&#x76EE;&#x524D;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x65B9;&#x6CD5;&#x7684;&#x7814;&#x7A76;&#x4E3B;&#x8981;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x65B9;&#x5411;&#xFF1A;<br>
&#xFF08;1&#xFF09;&#x66F4;&#x7CBE;&#x7EC6;&#x6A21;&#x578B;&#x7684;&#x8BBE;&#x8BA1;&#x3002;&#x76EE;&#x524D;&#x5F88;&#x591A;&#x7F51;&#x7EDC;&#x57FA;&#x4E8E;&#x6A21;&#x5757;&#x5316;&#x8BBE;&#x8BA1;&#x601D;&#x60F3;&#xFF0C;&#x5728;&#x6DF1;&#x5EA6;&#x548C;&#x5BBD;&#x5EA6;&#x4E24;&#x4E2A;&#x7EF4;&#x5EA6;&#x4E0A;&#x90FD;&#x5F88;&#x5927;&#xFF0C;&#x5BFC;&#x81F4;&#x53C2;&#x6570;&#x5197;&#x4F59;&#x3002;&#x56E0;&#x6B64;&#x6709;&#x5F88;&#x591A;&#x5173;&#x4E8E;&#x6A21;&#x578B;&#x8BBE;&#x8BA1;&#x7684;&#x7814;&#x7A76;&#xFF0C;&#x5982;SqueezeNet&#x3001;MobileNet&#x7B49;&#xFF0C;&#x4F7F;&#x7528;&#x66F4;&#x52A0;&#x7EC6;&#x81F4;&#x3001;&#x9AD8;&#x6548;&#x7684;&#x6A21;&#x578B;&#x8BBE;&#x8BA1;&#xFF0C;&#x80FD;&#x591F;&#x5F88;&#x5927;&#x7A0B;&#x5EA6;&#x7684;&#x51CF;&#x5C11;&#x6A21;&#x578B;&#x5C3A;&#x5BF8;&#xFF0C;&#x5E76;&#x4E14;&#x4E5F;&#x5177;&#x6709;&#x4E0D;&#x9519;&#x7684;&#x6027;&#x80FD;&#x3002;<br>
&#xFF08;2&#xFF09;&#x6A21;&#x578B;&#x88C1;&#x526A;&#x3002;&#x7ED3;&#x6784;&#x590D;&#x6742;&#x7684;&#x7F51;&#x7EDC;&#x5177;&#x6709;&#x975E;&#x5E38;&#x597D;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x5176;&#x53C2;&#x6570;&#x4E5F;&#x5B58;&#x5728;&#x5197;&#x4F59;&#xFF0C;&#x56E0;&#x6B64;&#x5BF9;&#x4E8E;&#x5DF2;&#x8BAD;&#x7EC3;&#x597D;&#x7684;&#x6A21;&#x578B;&#x7F51;&#x7EDC;&#xFF0C;&#x53EF;&#x4EE5;&#x5BFB;&#x627E;&#x4E00;&#x79CD;&#x6709;&#x6548;&#x7684;&#x8BC4;&#x5224;&#x624B;&#x6BB5;&#xFF0C;&#x5C06;&#x4E0D;&#x91CD;&#x8981;&#x7684;connection&#x6216;&#x8005;filter&#x8FDB;&#x884C;&#x88C1;&#x526A;&#x6765;&#x51CF;&#x5C11;&#x6A21;&#x578B;&#x7684;&#x5197;&#x4F59;&#x3002;<br>
&#xFF08;3&#xFF09;&#x6838;&#x7684;&#x7A00;&#x758F;&#x5316;&#x3002;&#x5728;&#x8BAD;&#x7EC3;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5BF9;&#x6743;&#x91CD;&#x7684;&#x66F4;&#x65B0;&#x8FDB;&#x884C;&#x8BF1;&#x5BFC;&#xFF0C;&#x4F7F;&#x5176;&#x66F4;&#x52A0;&#x7A00;&#x758F;&#xFF0C;&#x5BF9;&#x4E8E;&#x7A00;&#x758F;&#x77E9;&#x9635;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x66F4;&#x52A0;&#x7D27;&#x81F4;&#x7684;&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#xFF0C;&#x5982;CSC&#xFF0C;&#x4F46;&#x662F;&#x4F7F;&#x7528;&#x7A00;&#x758F;&#x77E9;&#x9635;&#x64CD;&#x4F5C;&#x5728;&#x786C;&#x4EF6;&#x5E73;&#x53F0;&#x4E0A;&#x8FD0;&#x7B97;&#x6548;&#x7387;&#x4E0D;&#x9AD8;&#xFF0C;&#x5BB9;&#x6613;&#x53D7;&#x5230;&#x5E26;&#x5BBD;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x56E0;&#x6B64;&#x52A0;&#x901F;&#x5E76;&#x4E0D;&#x660E;&#x663E;&#x3002;<br>
&#xFF08;4&#xFF09;&#x91CF;&#x5316;<br>
&#xFF08;5&#xFF09;Low-rank&#x5206;&#x89E3;<br>
&#xFF08;6&#xFF09;&#x8FC1;&#x79FB;&#x5B66;&#x4E60;</p>
<h2 class="mume-header" id="173-%E7%9B%AE%E5%89%8D%E6%9C%89%E5%93%AA%E4%BA%9B%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E6%A8%A1%E5%9E%8B%E4%BC%98%E5%8C%96%E5%8A%A0%E9%80%9F%E6%96%B9%E6%B3%95">17.3 &#x76EE;&#x524D;&#x6709;&#x54EA;&#x4E9B;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#x4F18;&#x5316;&#x52A0;&#x901F;&#x65B9;&#x6CD5;&#xFF1F;</h2>

<p><a href="https://blog.csdn.net/nature553863/article/details/81083955">https://blog.csdn.net/nature553863/article/details/81083955</a><br>
&#x6A21;&#x578B;&#x4F18;&#x5316;&#x52A0;&#x901F;&#x80FD;&#x591F;&#x63D0;&#x5347;&#x7F51;&#x7EDC;&#x7684;&#x8BA1;&#x7B97;&#x6548;&#x7387;&#xFF0C;&#x5177;&#x4F53;&#x5305;&#x62EC;&#xFF1A;<br>
&#xFF08;1&#xFF09;Op-level&#x7684;&#x5FEB;&#x901F;&#x7B97;&#x6CD5;&#xFF1A;FFT Conv2d (7x7, 9x9), Winograd Conv2d (3x3, 5x5) &#x7B49;&#xFF1B;<br>
&#xFF08;2&#xFF09;Layer-level&#x7684;&#x5FEB;&#x901F;&#x7B97;&#x6CD5;&#xFF1A;Sparse-block net [1] &#x7B49;&#xFF1B;<br>
&#xFF08;3&#xFF09;&#x4F18;&#x5316;&#x5DE5;&#x5177;&#x4E0E;&#x5E93;&#xFF1A;TensorRT (Nvidia), Tensor Comprehension (Facebook) &#x548C; Distiller (Intel) &#x7B49;&#xFF1B;</p>
<p>&#x539F;&#x6587;&#xFF1A;<a href="https://blog.csdn.net/nature553863/article/details/81083955">https://blog.csdn.net/nature553863/article/details/81083955</a></p>
<h2 class="mume-header" id="174-%E5%BD%B1%E5%93%8D%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E9%80%9F%E5%BA%A6%E7%9A%844%E4%B8%AA%E5%9B%A0%E7%B4%A0%E5%86%8D%E7%A8%8D%E5%BE%AE%E8%AF%A6%E7%BB%86%E4%B8%80%E7%82%B9">17.4 &#x5F71;&#x54CD;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x901F;&#x5EA6;&#x7684;4&#x4E2A;&#x56E0;&#x7D20;&#xFF08;&#x518D;&#x7A0D;&#x5FAE;&#x8BE6;&#x7EC6;&#x4E00;&#x70B9;&#xFF09;</h2>

<ol>
<li>FLOPs(FLOPs&#x5C31;&#x662F;&#x7F51;&#x7EDC;&#x6267;&#x884C;&#x4E86;&#x591A;&#x5C11;multiply-adds&#x64CD;&#x4F5C;)&#xFF1B;</li>
<li>MAC(&#x5185;&#x5B58;&#x8BBF;&#x95EE;&#x6210;&#x672C;)&#xFF1B;</li>
<li>&#x5E76;&#x884C;&#x5EA6;(&#x5982;&#x679C;&#x7F51;&#x7EDC;&#x5E76;&#x884C;&#x5EA6;&#x9AD8;&#xFF0C;&#x901F;&#x5EA6;&#x660E;&#x663E;&#x63D0;&#x5347;)&#xFF1B;</li>
<li>&#x8BA1;&#x7B97;&#x5E73;&#x53F0;(GPU&#xFF0C;ARM)</li>
</ol>
<h2 class="mume-header" id="175-%E6%94%B9%E5%8F%98%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E5%AE%9E%E7%8E%B0%E6%A8%A1%E5%9E%8B%E5%8E%8B%E7%BC%A9-%E5%8A%A0%E9%80%9F">17.5 &#x6539;&#x53D8;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x8BBE;&#x8BA1;&#x4E3A;&#x4EC0;&#x4E48;&#x4F1A;&#x5B9E;&#x73B0;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x3001;&#x52A0;&#x901F;&#xFF1F;</h2>

<h3 class="mume-header" id="1-group-convolution">1. Group convolution</h3>

<p>Group convolution&#x6700;&#x65E9;&#x51FA;&#x73B0;&#x5728;AlexNet&#x4E2D;&#xFF0C;&#x662F;&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x5355;&#x5361;&#x663E;&#x5B58;&#x4E0D;&#x591F;&#xFF0C;&#x5C06;&#x7F51;&#x7EDC;&#x90E8;&#x7F72;&#x5230;&#x591A;&#x5361;&#x4E0A;&#x8FDB;&#x884C;&#x8BAD;&#x7EC3;&#x3002;Group convolution&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x5355;&#x4E2A;&#x5377;&#x79EF;1/g&#x7684;&#x53C2;&#x6570;&#x91CF;&#x3002;<br>
&#x5047;&#x8BBE;&#x8F93;&#x5165;&#x7279;&#x5F81;&#x7684;&#x7684;&#x7EF4;&#x5EA6;&#x4E3A;H * W * c1&#xFF1B;&#x5377;&#x79EF;&#x6838;&#x7684;&#x7EF4;&#x5EA6;&#x4E3A;h1 * w1 * c1&#xFF0C;&#x5171;c2&#x4E2A;&#xFF1B;&#x8F93;&#x51FA;&#x7279;&#x5F81;&#x7684;&#x7EF4;&#x5EA6;&#x4E3A; H1 * W1 * c2&#x3002;<br>
&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x8BA1;&#x7B97;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;<br>
<img src="./img/ch17/1.png" alt="image"><br>
&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x91CF;&#x4E3A;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><mi>H</mi><mo>&#x2217;</mo><mi>W</mi><mo>&#x2217;</mo><mi>h</mi><mn>1</mn><mo>&#x2217;</mo><mi>w</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">A = H * W * h1 * w1 * c1 * c2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">h</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">2</span></span></span></span></span></p><p>Group convolution&#x662F;&#x5C06;&#x8F93;&#x5165;&#x7279;&#x5F81;&#x7684;&#x7EF4;&#x5EA6;c1&#x5206;&#x6210;g&#x4EFD;&#xFF0C;&#x6BCF;&#x4E2A;group&#x5BF9;&#x5E94;&#x7684;channel&#x6570;&#x4E3A;c1/g&#xFF0C;&#x7279;&#x5F81;&#x7EF4;&#x5EA6;H * W * c1/g&#xFF1B;&#xFF0C;&#x6BCF;&#x4E2A;group&#x5BF9;&#x5E94;&#x7684;&#x5377;&#x79EF;&#x6838;&#x7684;&#x7EF4;&#x5EA6;&#x4E5F;&#x76F8;&#x5E94;&#x53D1;&#x751F;&#x6539;&#x53D8;&#x4E3A;h1 * w1 * c1/9&#xFF0C;&#x5171;c2/g&#x4E2A;&#xFF1B;&#x6BCF;&#x4E2A;group&#x76F8;&#x4E92;&#x72EC;&#x7ACB;&#x8FD0;&#x7B97;&#xFF0C;&#x6700;&#x540E;&#x5C06;&#x7ED3;&#x679C;&#x53E0;&#x52A0;&#x5728;&#x4E00;&#x8D77;&#x3002;<br>
Group convolution&#x8BA1;&#x7B97;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;<br>
<img src="./img/ch17/2.png" alt="image"><br>
Group convolution&#x8FD0;&#x7B97;&#x91CF;&#x4E3A;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>=</mo><mi>H</mi><mo>&#x2217;</mo><mi>W</mi><mo>&#x2217;</mo><mi>h</mi><mn>1</mn><mo>&#x2217;</mo><mi>w</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mi mathvariant="normal">/</mi><mi>g</mi><mo>&#x2217;</mo><mi>c</mi><mn>2</mn><mi mathvariant="normal">/</mi><mi>g</mi><mo>&#x2217;</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">B = H * W * h1 * w1 * c1/g * c2/g * g
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">h</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathit">c</span><span class="mord">2</span><span class="mord">/</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span></span></p><p>Group&#x5377;&#x79EF;&#x76F8;&#x5BF9;&#x4E8E;&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x7684;&#x8FD0;&#x7B97;&#x91CF;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>B</mi><mi>A</mi></mfrac><mo>=</mo><mfrac><mrow><mi>H</mi><mo>&#x2217;</mo><mi>W</mi><mo>&#x2217;</mo><mi>h</mi><mn>1</mn><mo>&#x2217;</mo><mi>w</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mi mathvariant="normal">/</mi><mi>g</mi><mo>&#x2217;</mo><mi>c</mi><mn>2</mn><mi mathvariant="normal">/</mi><mi>g</mi><mo>&#x2217;</mo><mi>g</mi></mrow><mrow><mi>H</mi><mo>&#x2217;</mo><mi>W</mi><mo>&#x2217;</mo><mi>h</mi><mn>1</mn><mo>&#x2217;</mo><mi>w</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mi>g</mi></mfrac></mrow><annotation encoding="application/x-tex">\dfrac{B}{A} = \dfrac{ H * W * h1 * w1 * c1/g * c2/g * g}{H * W * h1 * w1 * c1 * c2} = \dfrac{1}{g}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">A</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">h</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">h</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mord">/</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">2</span><span class="mord">/</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>&#x7531;&#x6B64;&#x53EF;&#x77E5;&#xFF1A;group&#x5377;&#x79EF;&#x76F8;&#x5BF9;&#x4E8E;&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x51CF;&#x5C11;&#x4E86;1/g&#x7684;&#x53C2;&#x6570;&#x91CF;&#x3002;</p>
<h3 class="mume-header" id="2-depthwise-separable-convolution">2. Depthwise separable convolution</h3>

<p>Depthwise separable convolution&#x662F;&#x7531;depthwise conv&#x548C;pointwise conv&#x6784;&#x6210;&#x3002;<br>
depthwise conv(DW)&#x6709;&#x6548;&#x51CF;&#x5C11;&#x53C2;&#x6570;&#x6570;&#x91CF;&#x5E76;&#x63D0;&#x5347;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#x3002;&#x4F46;&#x662F;&#x7531;&#x4E8E;&#x6BCF;&#x4E2A;feature map&#x53EA;&#x88AB;&#x4E00;&#x4E2A;&#x5377;&#x79EF;&#x6838;&#x5377;&#x79EF;&#xFF0C;&#x56E0;&#x6B64;&#x7ECF;&#x8FC7;DW&#x8F93;&#x51FA;&#x7684;feature map&#x4E0D;&#x80FD;&#x53EA;&#x5305;&#x542B;&#x8F93;&#x5165;&#x7279;&#x5F81;&#x56FE;&#x7684;&#x5168;&#x90E8;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x4E14;&#x7279;&#x5F81;&#x4E4B;&#x95F4;&#x7684;&#x4FE1;&#x606F;&#x4E0D;&#x80FD;&#x8FDB;&#x884C;&#x4EA4;&#x6D41;&#xFF0C;&#x5BFC;&#x81F4;&#x201C;&#x4FE1;&#x606F;&#x6D41;&#x901A;&#x4E0D;&#x7545;&#x201D;&#x3002;<br>
pointwise conv(PW)&#x5B9E;&#x73B0;&#x901A;&#x9053;&#x7279;&#x5F81;&#x4FE1;&#x606F;&#x4EA4;&#x6D41;&#xFF0C;&#x89E3;&#x51B3;DW&#x5377;&#x79EF;&#x5BFC;&#x81F4;&#x201C;&#x4FE1;&#x606F;&#x6D41;&#x901A;&#x4E0D;&#x7545;&#x201D;&#x7684;&#x95EE;&#x9898;&#x3002;<br>
&#x5047;&#x8BBE;&#x8F93;&#x5165;&#x7279;&#x5F81;&#x7684;&#x7684;&#x7EF4;&#x5EA6;&#x4E3A;H * W * c1&#xFF1B;&#x5377;&#x79EF;&#x6838;&#x7684;&#x7EF4;&#x5EA6;&#x4E3A;h1 * w1 * c1&#xFF0C;&#x5171;c2&#x4E2A;&#xFF1B;&#x8F93;&#x51FA;&#x7279;&#x5F81;&#x7684;&#x7EF4;&#x5EA6;&#x4E3A; H1 * W1 * c2&#x3002;<br>
&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x8BA1;&#x7B97;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;<br>
<img src="./img/ch17/3.png" alt="image"><br>
&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x91CF;&#x4E3A;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><mi>H</mi><mo>&#x2217;</mo><mi>W</mi><mo>&#x2217;</mo><mi>h</mi><mn>1</mn><mo>&#x2217;</mo><mi>w</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">A = H * W * h1 * w1 * c1 * c2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">h</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">2</span></span></span></span></span></p><p>DW&#x5377;&#x79EF;&#x7684;&#x8BA1;&#x7B97;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;<br>
<img src="./img/ch17/4.png" alt="image"><br>
DW&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x91CF;&#x4E3A;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>D</mi></msub><mi>W</mi><mo>=</mo><mi>H</mi><mo>&#x2217;</mo><mi>W</mi><mo>&#x2217;</mo><mi>h</mi><mn>1</mn><mo>&#x2217;</mo><mi>w</mi><mn>1</mn><mo>&#x2217;</mo><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">B_DW = H * W * h1 * w1 * 1 * c1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">h</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">1</span></span></span></span></span></p><p>PW&#x5377;&#x79EF;&#x7684;&#x8BA1;&#x7B97;&#x65B9;&#x5F0F;&#x5982;&#x4E0B;&#xFF1A;<br>
<img src="./img/ch17/5.png" alt="image"></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>P</mi></msub><mi>W</mi><mo>=</mo><msub><mi>H</mi><mi>m</mi></msub><mo>&#x2217;</mo><msub><mi>W</mi><mi>m</mi></msub><mo>&#x2217;</mo><mn>1</mn><mo>&#x2217;</mo><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">B_PW = H_m * W_m * 1 * 1 * c1 * c2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">2</span></span></span></span></span></p><p>Depthwise separable convolution&#x8FD0;&#x7B97;&#x91CF;&#x4E3A;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>=</mo><msub><mi>B</mi><mi>D</mi></msub><mi>W</mi><mo>+</mo><msub><mi>B</mi><mi>P</mi></msub><mi>W</mi></mrow><annotation encoding="application/x-tex">B = B_DW + B_PW  
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathit" style="margin-right:0.13889em;">W</span></span></span></span></span></p><p>Depthwise separable convolution&#x76F8;&#x5BF9;&#x4E8E;&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x7684;&#x8FD0;&#x7B97;&#x91CF;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>B</mi><mi>A</mi></mfrac><mo>=</mo><mfrac><mrow><mi>H</mi><mo>&#x2217;</mo><mi>W</mi><mo>&#x2217;</mo><mi>h</mi><mn>1</mn><mo>&#x2217;</mo><mi>w</mi><mn>1</mn><mo>&#x2217;</mo><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>+</mo><msub><mi>H</mi><mi>m</mi></msub><mo>&#x2217;</mo><msub><mi>W</mi><mi>m</mi></msub><mo>&#x2217;</mo><mn>1</mn><mo>&#x2217;</mo><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn></mrow><mrow><mi>H</mi><mo>&#x2217;</mo><mi>W</mi><mo>&#x2217;</mo><mi>h</mi><mn>1</mn><mo>&#x2217;</mo><mi>w</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><mrow><mi>c</mi><mn>2</mn></mrow></mfrac><mo>+</mo><mfrac><mn>1</mn><mrow><mi>h</mi><mn>1</mn><mo>&#x2217;</mo><mi>w</mi><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\dfrac{B}{A} = \dfrac{ H * W * h1 * w1 * 1 * c1 + H_m * W_m * 1 * 1 * c1 * c2}{H * W * h1 * w1 * c1 * c2}  

= \dfrac{1}{c2} + \dfrac{1}{h1 * w1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">A</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">h</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">h</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">m</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">h</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>&#x7531;&#x6B64;&#x53EF;&#x77E5;&#xFF0C;&#x968F;&#x7740;&#x5377;&#x79EF;&#x901A;&#x9053;&#x6570;&#x7684;&#x589E;&#x52A0;&#xFF0C;Depthwise separable convolution&#x7684;&#x8FD0;&#x7B97;&#x91CF;&#x76F8;&#x5BF9;&#x4E8E;&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x66F4;&#x5C11;&#x3002;</p>
<h3 class="mume-header" id="3-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%9A%84channel%E7%9B%B8%E5%90%8C%E6%97%B6mac%E6%9C%80%E5%B0%8F">3. &#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7684;channel&#x76F8;&#x540C;&#x65F6;&#xFF0C;MAC&#x6700;&#x5C0F;</h3>

<p><strong>&#x5377;&#x79EF;&#x5C42;&#x7684;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;&#x7279;&#x5F81;&#x901A;&#x9053;&#x6570;&#x76F8;&#x7B49;&#x65F6;MAC&#x6700;&#x5C0F;&#xFF0C;&#x6B64;&#x65F6;&#x6A21;&#x578B;&#x901F;&#x5EA6;&#x6700;&#x5FEB;&#x3002;</strong><br>
&#x5047;&#x8BBE;feature map&#x7684;&#x5927;&#x5C0F;&#x4E3A;h*w&#xFF0C;&#x8F93;&#x5165;&#x901A;&#x9053;c1&#xFF0C;&#x8F93;&#x51FA;&#x901A;&#x9053;c2&#x3002;<br>
&#x5DF2;&#x77E5;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi>L</mi><mi>O</mi><mi>P</mi><mi>s</mi><mo>=</mo><mi>B</mi><mo>=</mo><mi>h</mi><mo>&#x2217;</mo><mi>w</mi><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn><mo>=</mo><mo>&gt;</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn><mo>=</mo><mfrac><mi>B</mi><mrow><mi>h</mi><mo>&#x2217;</mo><mi>w</mi></mrow></mfrac><mi>M</mi><mi>A</mi><mi>C</mi><mo>=</mo><mi>h</mi><mo>&#x2217;</mo><mi>w</mi><mo>&#x2217;</mo><mo>(</mo><mi>c</mi><mn>1</mn><mo>+</mo><mi>c</mi><mn>2</mn><mo>)</mo><mo>+</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn><mi>c</mi><mn>1</mn><mo>+</mo><mi>c</mi><mn>2</mn><mo>&#x2265;</mo><mn>2</mn><mo>&#x2217;</mo><msqrt><mrow><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn></mrow></msqrt><mo>=</mo><mo>&gt;</mo><mi>M</mi><mi>A</mi><mi>C</mi><mo>&#x2265;</mo><mn>2</mn><mo>&#x2217;</mo><mi>h</mi><mo>&#x2217;</mo><mi>w</mi><msqrt><mfrac><mi>B</mi><mrow><mi>h</mi><mo>&#x2217;</mo><mi>w</mi></mrow></mfrac></msqrt><mo>+</mo><mfrac><mi>B</mi><mrow><mi>h</mi><mo>&#x2217;</mo><mi>w</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">FLOPs = B = h * w * c1 * c2

=&gt; c1 * c2 = \dfrac{B}{h * w}

MAC = h * w * (c1 + c2) + c1 * c2

c1 + c2 \geq 2 * \sqrt{c1 * c2}

=&gt; MAC \geq 2 * h * w \sqrt{\dfrac{B}{h * w}} + \dfrac{B}{h * w} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mord mathit">L</span><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathit">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathit">c</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathit">c</span><span class="mord">2</span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord mathit">c</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2265;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.08390500000000001em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.956095em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">2</span></span></span><span style="top:-2.916095em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.08390500000000001em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2265;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.44em;vertical-align:-0.7689599999999999em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.67104em;"><span class="svg-align" style="top:-4.4em;"><span class="pstrut" style="height:4.4em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.6310400000000005em;"><span class="pstrut" style="height:4.4em;"></span><span class="hide-tail" style="min-width:1.02em;height:2.48em;"><svg width="400em" height="2.48em" viewBox="0 0 400000 2592" preserveAspectRatio="xMinYMin slice"><path d="M424,2478c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,
-342,-109.8,-513.3,-110.5,-514c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,
25c-5.7,9.3,-9.8,16,-12.5,20s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,
-13s76,-122,76,-122s77,-121,77,-121s209,968,209,968c0,-2,84.7,-361.7,254,-1079
c169.3,-717.3,254.7,-1077.7,256,-1081c4,-6.7,10,-10,18,-10H400000v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80H400000v40H1014z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.7689599999999999em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>&#x6839;&#x636E;&#x5747;&#x503C;&#x4E0D;&#x7B49;&#x5F0F;&#x5F97;&#x5230;(c1-c2)^2&gt;=0&#xFF0C;&#x7B49;&#x5F0F;&#x6210;&#x7ACB;&#x7684;&#x6761;&#x4EF6;&#x662F;c1=c2&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8F93;&#x5165;&#x7279;&#x5F81;&#x901A;&#x9053;&#x6570;&#x548C;&#x8F93;&#x51FA;&#x7279;&#x5F81;&#x901A;&#x9053;&#x6570;&#x76F8;&#x7B49;&#x65F6;&#xFF0C;&#x5728;&#x7ED9;&#x5B9A;FLOPs&#x524D;&#x63D0;&#x4E0B;&#xFF0C;MAC&#x8FBE;&#x5230;&#x53D6;&#x503C;&#x7684;&#x4E0B;&#x754C;&#x3002;</p>
<h3 class="mume-header" id="4-%E5%87%8F%E5%B0%91%E7%BB%84%E5%8D%B7%E7%A7%AF%E7%9A%84%E6%95%B0%E9%87%8F">4. &#x51CF;&#x5C11;&#x7EC4;&#x5377;&#x79EF;&#x7684;&#x6570;&#x91CF;</h3>

<p><strong>&#x8FC7;&#x591A;&#x7684;group&#x64CD;&#x4F5C;&#x4F1A;&#x589E;&#x5927;MAC&#xFF0C;&#x4ECE;&#x800C;&#x4F7F;&#x6A21;&#x578B;&#x901F;&#x5EA6;&#x53D8;&#x6162;</strong><br>
&#x7531;&#x4EE5;&#x4E0A;&#x516C;&#x5F0F;&#x53EF;&#x77E5;&#xFF0C;group&#x5377;&#x79EF;&#x60F3;&#x6BD4;&#x4E0E;&#x4F20;&#x7EDF;&#x7684;&#x5377;&#x79EF;&#x53EF;&#x4EE5;&#x964D;&#x4F4E;&#x8BA1;&#x7B97;&#x91CF;&#xFF0C;&#x63D0;&#x9AD8;&#x6A21;&#x578B;&#x7684;&#x6548;&#x7387;&#xFF1B;&#x5982;&#x679C;&#x5728;&#x76F8;&#x540C;&#x7684;FLOPs&#x65F6;&#xFF0C;group&#x5377;&#x79EF;&#x4E3A;&#x4E86;&#x6EE1;&#x8DB3;FLOPs&#x4F1A;&#x662F;&#x4F7F;&#x7528;&#x66F4;&#x591A;channels&#xFF0C;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x6A21;&#x578B;&#x7684;&#x7CBE;&#x5EA6;&#x3002;&#x4F46;&#x662F;&#x968F;&#x7740;channel&#x6570;&#x91CF;&#x7684;&#x589E;&#x52A0;&#xFF0C;&#x4E5F;&#x4F1A;&#x589E;&#x52A0;MAC&#x3002;<br>
FLOPs&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>=</mo><mfrac><mrow><mi>h</mi><mo>&#x2217;</mo><mi>w</mi><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn></mrow><mi>g</mi></mfrac></mrow><annotation encoding="application/x-tex">B = \dfrac{h * w * c1 * c2}{g}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>MAC&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>A</mi><mi>C</mi><mo>=</mo><mi>h</mi><mo>&#x2217;</mo><mi>w</mi><mo>&#x2217;</mo><mo>(</mo><mi>c</mi><mn>1</mn><mo>+</mo><mi>c</mi><mn>2</mn><mo>)</mo><mo>+</mo><mfrac><mrow><mi>c</mi><mn>1</mn><mo>&#x2217;</mo><mi>c</mi><mn>2</mn></mrow><mi>g</mi></mfrac></mrow><annotation encoding="application/x-tex">MAC = h * w * (c1 + c2) + \dfrac{c1 * c2}{g}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathit">c</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit">c</span><span class="mord">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>&#x7531;MAC&#xFF0C;FLOPs&#x53EF;&#x77E5;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>A</mi><mi>C</mi><mo>=</mo><mi>h</mi><mo>&#x2217;</mo><mi>w</mi><mo>&#x2217;</mo><mi>c</mi><mn>1</mn><mo>+</mo><mfrac><mrow><mi>B</mi><mo>&#x2217;</mo><mi>g</mi></mrow><mrow><mi>c</mi><mn>1</mn></mrow></mfrac><mo>+</mo><mfrac><mi>B</mi><mrow><mi>h</mi><mo>&#x2217;</mo><mi>w</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">MAC = h * w * c1 + \dfrac{B*g}{c1} + \dfrac{B}{h * w}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">A</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathit">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.0463299999999998em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603299999999998em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">c</span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>&#x5F53;FLOPs&#x56FA;&#x5B9A;(B&#x4E0D;&#x53D8;)&#x65F6;&#xFF0C;g&#x8D8A;&#x5927;&#xFF0C;MAC&#x8D8A;&#x5927;&#x3002;</p>
<h3 class="mume-header" id="5-%E5%87%8F%E5%B0%91%E7%BD%91%E7%BB%9C%E7%A2%8E%E7%89%87%E5%8C%96%E7%A8%8B%E5%BA%A6%E5%88%86%E6%94%AF%E6%95%B0%E9%87%8F">5. &#x51CF;&#x5C11;&#x7F51;&#x7EDC;&#x788E;&#x7247;&#x5316;&#x7A0B;&#x5EA6;(&#x5206;&#x652F;&#x6570;&#x91CF;)</h3>

<p><strong>&#x6A21;&#x578B;&#x4E2D;&#x5206;&#x652F;&#x6570;&#x91CF;&#x8D8A;&#x5C11;&#xFF0C;&#x6A21;&#x578B;&#x901F;&#x5EA6;&#x8D8A;&#x5FEB;</strong><br>
&#x6B64;&#x7ED3;&#x8BBA;&#x4E3B;&#x8981;&#x662F;&#x7531;&#x5B9E;&#x9A8C;&#x7ED3;&#x679C;&#x6240;&#x5F97;&#x3002;<br>
&#x4EE5;&#x4E0B;&#x4E3A;&#x7F51;&#x7EDC;&#x5206;&#x652F;&#x6570;&#x548C;&#x5404;&#x5206;&#x652F;&#x5305;&#x542B;&#x7684;&#x5377;&#x79EF;&#x6570;&#x76EE;&#x5BF9;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x901F;&#x5EA6;&#x7684;&#x5F71;&#x54CD;&#x3002;<br>
<img src="./img/ch17/6.png" alt="image"><br>
&#x5B9E;&#x9A8C;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x57FA;&#x672C;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#xFF0C;&#x5206;&#x522B;&#x5C06;&#x5B83;&#x4EEC;&#x91CD;&#x590D;10&#x6B21;&#xFF0C;&#x7136;&#x540E;&#x8FDB;&#x884C;&#x5B9E;&#x9A8C;&#x3002;&#x5B9E;&#x9A8C;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;<br>
<img src="./img/ch17/7.png" alt="image"><br>
&#x7531;&#x5B9E;&#x9A8C;&#x7ED3;&#x679C;&#x53EF;&#x77E5;&#xFF0C;&#x968F;&#x7740;&#x7F51;&#x7EDC;&#x5206;&#x652F;&#x6570;&#x91CF;&#x7684;&#x589E;&#x52A0;&#xFF0C;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x901F;&#x5EA6;&#x5728;&#x964D;&#x4F4E;&#x3002;&#x7F51;&#x7EDC;&#x788E;&#x7247;&#x5316;&#x7A0B;&#x5EA6;&#x5BF9;GPU&#x7684;&#x5F71;&#x54CD;&#x6548;&#x679C;&#x660E;&#x663E;&#xFF0C;&#x5BF9;CPU&#x4E0D;&#x660E;&#x663E;&#xFF0C;&#x4F46;&#x662F;&#x7F51;&#x7EDC;&#x901F;&#x5EA6;&#x540C;&#x6837;&#x5728;&#x964D;&#x4F4E;&#x3002;</p>
<h3 class="mume-header" id="6-%E5%87%8F%E5%B0%91%E5%85%83%E7%B4%A0%E7%BA%A7%E6%93%8D%E4%BD%9C">6. &#x51CF;&#x5C11;&#x5143;&#x7D20;&#x7EA7;&#x64CD;&#x4F5C;</h3>

<p><strong>&#x5143;&#x7D20;&#x7EA7;&#x64CD;&#x4F5C;&#x6240;&#x5E26;&#x6765;&#x7684;&#x65F6;&#x95F4;&#x6D88;&#x8017;&#x4E5F;&#x4E0D;&#x80FD;&#x5FFD;&#x89C6;</strong><br>
ReLU &#xFF0C;Tensor &#x76F8;&#x52A0;&#xFF0C;Bias&#x76F8;&#x52A0;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x5206;&#x79BB;&#x5377;&#x79EF;&#xFF08;depthwise convolution&#xFF09;&#x90FD;&#x5B9A;&#x4E49;&#x4E3A;&#x5143;&#x7D20;&#x7EA7;&#x64CD;&#x4F5C;&#x3002;<br>
FLOPs&#x5927;&#x591A;&#x6570;&#x662F;&#x5BF9;&#x4E8E;&#x5377;&#x79EF;&#x8BA1;&#x7B97;&#x800C;&#x8A00;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5143;&#x7D20;&#x7EA7;&#x64CD;&#x4F5C;&#x7684;FLOPs&#x76F8;&#x5BF9;&#x8981;&#x4F4E;&#x5F88;&#x591A;&#x3002;&#x4F46;&#x662F;&#x8FC7;&#x7684;&#x5143;&#x7D20;&#x7EA7;&#x64CD;&#x4F5C;&#x4E5F;&#x4F1A;&#x5E26;&#x6765;&#x65F6;&#x95F4;&#x6210;&#x672C;&#x3002;ShuffleNet&#x4F5C;&#x8005;&#x5BF9;ShuffleNet v1&#x548C;MobileNet v2&#x7684;&#x51E0;&#x79CD;&#x5C42;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x95F4;&#x6D88;&#x8017;&#x505A;&#x4E86;&#x5206;&#x6790;&#xFF0C;&#x53D1;&#x73B0;&#x5143;&#x7D20;&#x7EA7;&#x64CD;&#x4F5C;&#x5BF9;&#x4E8E;&#x7F51;&#x7EDC;&#x901F;&#x5EA6;&#x7684;&#x5F71;&#x54CD;&#x4E5F;&#x5F88;&#x5927;&#x3002;<br>
<img src="./img/ch17/8.png" alt="image"></p>
<h2 class="mume-header" id="176-%E5%B8%B8%E7%94%A8%E7%9A%84%E8%BD%BB%E9%87%8F%E7%BA%A7%E7%BD%91%E7%BB%9C%E6%9C%89%E5%93%AA%E4%BA%9B%E5%86%8D%E7%90%A2%E7%A3%A8%E4%B8%8B%E8%AF%AD%E8%A8%80%E5%92%8C%E6%8E%92%E7%89%88">17.6 &#x5E38;&#x7528;&#x7684;&#x8F7B;&#x91CF;&#x7EA7;&#x7F51;&#x7EDC;&#x6709;&#x54EA;&#x4E9B;&#xFF1F;&#xFF08;&#x518D;&#x7422;&#x78E8;&#x4E0B;&#x8BED;&#x8A00;&#x548C;&#x6392;&#x7248;&#xFF09;</h2>

<ul>
<li><strong>SqueezeNet</strong></li>
<li><strong>MobileNet</strong></li>
<li><strong>ShuffleNet</strong></li>
<li><strong>Xception</strong></li>
</ul>
<h3 class="mume-header" id="1-sequeezenet">1. SequeezeNet</h3>

<p>SqueenzeNet&#x51FA;&#x81EA;F. N. Iandola, S.Han&#x7B49;&#x4EBA;&#x53D1;&#x8868;&#x7684;&#x8BBA;&#x6587;&#x300A;SqueezeNet: AlexNet-level accuracy with 50x fewer parameters and &lt; 0.5MB model size&#x300B;&#xFF0C;&#x4F5C;&#x8005;&#x5728;&#x4FDD;&#x8BC1;&#x7CBE;&#x5EA6;&#x4E0D;&#x635F;&#x5931;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x5C06;&#x539F;&#x59CB;AlexNet&#x538B;&#x7F29;&#x81F3;&#x539F;&#x6765;&#x7684;510&#x500D;&#x3002;</p>
<h4 class="mume-header" id="11-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">1.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</h4>

<p>&#x5728;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x8BBE;&#x8BA1;&#x65B9;&#x9762;&#x4E3B;&#x8981;&#x91C7;&#x53D6;&#x4EE5;&#x4E0B;&#x4E09;&#x79CD;&#x65B9;&#x5F0F;&#xFF1A;</p>
<ul>
<li>&#x7528;1*1&#x5377;&#x79EF;&#x6838;&#x66FF;&#x6362;3*3&#x5377;&#x79EF;
<ul>
<li>&#x7406;&#x8BBA;&#x4E0A;&#x4E00;&#x4E2A;1*1&#x5377;&#x79EF;&#x6838;&#x7684;&#x53C2;&#x6570;&#x662F;&#x4E00;&#x4E2A;3*3&#x5377;&#x79EF;&#x6838;&#x7684;1/9&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x6A21;&#x578B;&#x5C3A;&#x5BF8;&#x538B;&#x7F29;9&#x500D;&#x3002;</li>
</ul>
</li>
<li>&#x51CF;&#x5C0F;3*3&#x5377;&#x79EF;&#x7684;&#x8F93;&#x5165;&#x901A;&#x9053;&#x6570;
<ul>
<li>&#x6839;&#x636E;&#x4E0A;&#x8FF0;&#x516C;&#x5F0F;&#xFF0C;&#x51CF;&#x5C11;&#x8F93;&#x5165;&#x901A;&#x9053;&#x6570;&#x4E0D;&#x4EC5;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x5377;&#x79EF;&#x7684;&#x8FD0;&#x7B97;&#x91CF;&#xFF0C;&#x800C;&#x4E14;&#x8F93;&#x5165;&#x901A;&#x9053;&#x6570;&#x4E0E;&#x8F93;&#x51FA;&#x901A;&#x9053;&#x6570;&#x76F8;&#x540C;&#x65F6;&#x8FD8;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;MAC&#x3002;</li>
</ul>
</li>
<li>&#x5EF6;&#x8FDF;&#x964D;&#x91C7;&#x6837;
<ul>
<li>&#x5206;&#x8FA8;&#x7387;&#x8D8A;&#x5927;&#x7684;&#x8F93;&#x5165;&#x80FD;&#x591F;&#x63D0;&#x4F9B;&#x66F4;&#x591A;&#x7279;&#x5F81;&#x7684;&#x4FE1;&#x606F;&#xFF0C;&#x6709;&#x5229;&#x4E8E;&#x7F51;&#x7EDC;&#x7684;&#x8BAD;&#x7EC3;&#x5224;&#x65AD;&#xFF0C;&#x5EF6;&#x8FDF;&#x964D;&#x91C7;&#x6837;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x7F51;&#x7EDC;&#x7CBE;&#x5EA6;&#x3002;</li>
</ul>
</li>
</ul>
<h4 class="mume-header" id="12-%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">1.2 &#x7F51;&#x7EDC;&#x67B6;&#x6784;</h4>

<p>SqueezeNet&#x63D0;&#x51FA;&#x4E00;&#x79CD;&#x591A;&#x5206;&#x652F;&#x7ED3;&#x6784;&#x2014;&#x2014;fire model&#xFF0C;&#x5176;&#x4E2D;&#x662F;&#x7531;Squeeze&#x5C42;&#x548C;expand&#x5C42;&#x6784;&#x6210;&#x3002;Squeeze&#x5C42;&#x662F;&#x7531;s1&#x4E2A;1*1&#x5377;&#x79EF;&#x7EC4;&#x6210;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x901A;&#x8FC7;1*1&#x7684;&#x5377;&#x79EF;&#x964D;&#x4F4E;expand&#x5C42;&#x7684;&#x8F93;&#x5165;&#x7EF4;&#x5EA6;&#xFF1B;expand&#x5C42;&#x5229;&#x7528;e1&#x4E2A;1*1&#x548C;e3&#x4E2A;3*3&#x5377;&#x79EF;&#x6784;&#x6210;&#x591A;&#x5206;&#x652F;&#x7ED3;&#x6784;&#x63D0;&#x53D6;&#x8F93;&#x5165;&#x7279;&#x5F81;&#xFF0C;&#x4EE5;&#x6B64;&#x63D0;&#x9AD8;&#x7F51;&#x7EDC;&#x7684;&#x7CBE;&#x5EA6;(&#x5176;&#x4E2D;e1=e3=4*s1)&#x3002;<br>
<img src="./img/ch17/9.png" alt="image"><br>
SqueezeNet&#x6574;&#x4F53;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#xFF1A;<br>
<img src="./img/ch17/10.png" alt="image"></p>
<h4 class="mume-header" id="13%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C">1.3&#x5B9E;&#x9A8C;&#x7ED3;&#x679C;</h4>

<p>&#x4E0D;&#x540C;&#x538B;&#x7F29;&#x65B9;&#x6CD5;&#x5728;ImageNet&#x4E0A;&#x7684;&#x5BF9;&#x6BD4;&#x5B9E;&#x9A8C;&#x7ED3;&#x679C;<br>
<img src="./img/ch17/11.png" alt="image"><br>
&#x7531;&#x5B9E;&#x9A8C;&#x7ED3;&#x679C;&#x53EF;&#x77E5;&#xFF0C;SqueezeNet&#x4E0D;&#x4EC5;&#x4FDD;&#x8BC1;&#x4E86;&#x7CBE;&#x5EA6;&#xFF0C;&#x800C;&#x4E14;&#x5C06;&#x539F;&#x59CB;AlexNet&#x4ECE;240M&#x538B;&#x7F29;&#x81F3;4.8M&#xFF0C;&#x538B;&#x7F29;50&#x500D;&#xFF0C;&#x8BF4;&#x660E;&#x6B64;&#x8F7B;&#x91CF;&#x7EA7;&#x7F51;&#x7EDC;&#x8BBE;&#x8BA1;&#x662F;&#x53EF;&#x884C;&#x3002;</p>
<h3 class="mume-header" id="2-mobilenet">2. MobileNet</h3>

<p>MobileNet &#x662F;Google&#x56E2;&#x961F;&#x4E8E;CVPR-2017&#x7684;&#x8BBA;&#x6587;&#x300A;MobileNets: Efficient Convolutional Neural Networks for Mobile Vision Applications&#x300B;&#x4E2D;&#x9488;&#x5BF9;&#x624B;&#x673A;&#x7B49;&#x5D4C;&#x5165;&#x5F0F;&#x8BBE;&#x5907;&#x63D0;&#x51FA;&#x7684;&#x4E00;&#x79CD;&#x8F7B;&#x91CF;&#x7EA7;&#x7684;&#x6DF1;&#x5C42;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x8BE5;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x5728;VGG&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x4F7F;&#x7528;DW+PW&#x7684;&#x7EC4;&#x5408;&#xFF0C;&#x5728;&#x4FDD;&#x8BC1;&#x4E0D;&#x635F;&#x5931;&#x592A;&#x5927;&#x7CBE;&#x5EA6;&#x7684;&#x540C;&#x65F6;&#xFF0C;&#x964D;&#x4F4E;&#x6A21;&#x578B;&#x53C2;&#x6570;&#x91CF;&#x3002;</p>
<h4 class="mume-header" id="21-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">2.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</h4>

<ul>
<li>&#x91C7;&#x7528;&#x6DF1;&#x5EA6;&#x53EF;&#x5206;&#x79BB;&#x5377;&#x79EF;&#x4EE3;&#x66FF;&#x4F20;&#x7EDF;&#x5377;&#x79EF;
<ul>
<li>&#x91C7;&#x7528;DW&#x5377;&#x79EF;&#x5728;&#x51CF;&#x5C11;&#x53C2;&#x6570;&#x6570;&#x91CF;&#x7684;&#x540C;&#x65F6;&#x63D0;&#x5347;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#x3002;&#x4F46;&#x662F;&#x7531;&#x4E8E;&#x6BCF;&#x4E2A;feature map&#x53EA;&#x88AB;&#x4E00;&#x4E2A;&#x5377;&#x79EF;&#x6838;&#x5377;&#x79EF;&#xFF0C;&#x56E0;&#x6B64;&#x7ECF;&#x8FC7;DW&#x8F93;&#x51FA;&#x7684;feature map&#x4E0D;&#x80FD;&#x53EA;&#x5305;&#x542B;&#x8F93;&#x5165;&#x7279;&#x5F81;&#x56FE;&#x7684;&#x5168;&#x90E8;&#x4FE1;&#x606F;&#xFF0C;&#x800C;&#x4E14;&#x7279;&#x5F81;&#x4E4B;&#x95F4;&#x7684;&#x4FE1;&#x606F;&#x4E0D;&#x80FD;&#x8FDB;&#x884C;&#x4EA4;&#x6D41;&#xFF0C;&#x5BFC;&#x81F4;&#x201C;&#x4FE1;&#x606F;&#x6D41;&#x901A;&#x4E0D;&#x7545;&#x201D;&#x3002;</li>
<li>&#x91C7;&#x7528;PW&#x5377;&#x79EF;&#x5B9E;&#x73B0;&#x901A;&#x9053;&#x7279;&#x5F81;&#x4FE1;&#x606F;&#x4EA4;&#x6D41;&#xFF0C;&#x89E3;&#x51B3;DW&#x5377;&#x79EF;&#x5BFC;&#x81F4;&#x201C;&#x4FE1;&#x606F;&#x6D41;&#x901A;&#x4E0D;&#x7545;&#x201D;&#x7684;&#x95EE;&#x9898;&#x3002;</li>
</ul>
</li>
<li>&#x4F7F;&#x7528;stride=2&#x7684;&#x5377;&#x79EF;&#x66FF;&#x6362;pooling
<ul>
<li>&#x76F4;&#x63A5;&#x5728;&#x5377;&#x79EF;&#x65F6;&#x5229;&#x7528;stride=2&#x5B8C;&#x6210;&#x4E86;&#x4E0B;&#x91C7;&#x6837;&#xFF0C;&#x4ECE;&#x800C;&#x8282;&#x7701;&#x4E86;&#x9700;&#x8981;&#x518D;&#x53BB;&#x7528;pooling&#x518D;&#x53BB;&#x8FDB;&#x884C;&#x4E00;&#x6B21;&#x4E0B;&#x91C7;&#x6837;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x53EF;&#x4EE5;&#x63D0;&#x5347;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x56E0;&#x4E3A;pooling&#x4E4B;&#x524D;&#x9700;&#x8981;&#x4E00;&#x4E2A;stride=1&#x7684; conv&#xFF0C;&#x800C;&#x4E0E;stride=2 conv&#x7684;&#x8BA1;&#x7B97;&#x91CF;&#x60F3;&#x6BD4;&#x8981;&#x9AD8;&#x8FD1;4&#x500D;(<strong>&#x4E2A;&#x4EBA;&#x7406;&#x89E3;</strong>)&#x3002;</li>
</ul>
</li>
</ul>
<h4 class="mume-header" id="22-%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">2.2 &#x7F51;&#x7EDC;&#x67B6;&#x6784;</h4>

<ul>
<li>
<p>DW conv&#x548C;PW conv<br>
MobileNet&#x7684;&#x7F51;&#x7EDC;&#x67B6;&#x6784;&#x4E3B;&#x8981;&#x662F;&#x7531;DW conv&#x548C;PW conv&#x7EC4;&#x6210;&#xFF0C;&#x76F8;&#x6BD4;&#x4E8E;&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x53EF;&#x4EE5;&#x964D;&#x4F4E;<code>$\dfrac{1}{N} + \dfrac{1}{Dk}$</code>&#x500D;&#x7684;&#x8BA1;&#x7B97;&#x91CF;&#x3002;<br>
&#x6807;&#x51C6;&#x5377;&#x79EF;&#x4E0E;DW conv&#x548C;PW conv&#x5982;&#x56FE;&#x6240;&#x793A;:<br>
<img src="./img/ch17/12.png" alt="image"><br>
&#x6DF1;&#x5EA6;&#x53EF;&#x5206;&#x79BB;&#x5377;&#x79EF;&#x4E0E;&#x4F20;&#x7EDF;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x91CF;&#x5BF9;&#x6BD4;&#xFF1A;<br>
<img src="./img/ch17/13.png" alt="image"><br>
&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#xFF1A;<br>
<img src="./img/ch17/14.png" alt="image"></p>
</li>
<li>
<p>MobileNets&#x7684;&#x67B6;&#x6784;<br>
<img src="./img/ch17/15.png" alt="image"></p>
</li>
</ul>
<h4 class="mume-header" id="23-%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C">2.3 &#x5B9E;&#x9A8C;&#x7ED3;&#x679C;</h4>

<p><img src="./img/ch17/16.png" alt="image"><br>
&#x7531;&#x4E0A;&#x8868;&#x53EF;&#x77E5;&#xFF0C;&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x7ED3;&#x6784;&#xFF0C;&#x6DF1;&#x5EA6;&#x53EF;&#x5206;&#x79BB;&#x5377;&#x79EF;&#x867D;&#x7136;&#x51C6;&#x786E;&#x7387;&#x964D;&#x4F4E;1%&#xFF0C;&#x4F46;&#x662F;&#x53C2;&#x6570;&#x91CF;&#x51CF;&#x5C11;&#x4E86;6/7&#x3002;</p>
<h3 class="mume-header" id="3-mobilenet-v2">3. MobileNet-v2</h3>

<p>MobileNet-V2&#x662F;2018&#x5E74;1&#x6708;&#x516C;&#x5F00;&#x5728;arXiv&#x4E0A;&#x8BBA;&#x6587;&#x300A;Inverted Residuals and Linear Bottlenecks: Mobile Networks for Classification, Detection and Segmentation&#x300B;&#xFF0C;&#x662F;&#x5BF9;MobileNet-V1&#x7684;&#x6539;&#x8FDB;&#xFF0C;&#x540C;&#x6837;&#x662F;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x5316;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x3002;</p>
<h4 class="mume-header" id="31-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">3.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</h4>

<ul>
<li>&#x91C7;&#x7528;Inverted residuals
<ul>
<li>&#x4E3A;&#x4E86;&#x4FDD;&#x8BC1;&#x7F51;&#x7EDC;&#x53EF;&#x4EE5;&#x63D0;&#x53D6;&#x66F4;&#x591A;&#x7684;&#x7279;&#x5F81;&#xFF0C;&#x5728;residual block&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;1*1 Conv&#x548C;3*3 DW Conv&#x4E4B;&#x524D;&#x8FDB;&#x884C;&#x901A;&#x9053;&#x6269;&#x5145;</li>
</ul>
</li>
<li>Linear bottlenecks
<ul>
<li>&#x4E3A;&#x4E86;&#x907F;&#x514D;Relu&#x5BF9;&#x7279;&#x5F81;&#x7684;&#x7834;&#x574F;&#xFF0C;&#x5728;residual block&#x7684;Eltwise sum&#x4E4B;&#x524D;&#x7684;&#x90A3;&#x4E2A; 1*1 Conv &#x4E0D;&#x518D;&#x91C7;&#x7528;Relu</li>
</ul>
</li>
<li>stride=2&#x7684;conv&#x4E0D;&#x4F7F;&#x7528;shot-cot&#xFF0C;stride=1&#x7684;conv&#x4F7F;&#x7528;shot-cut</li>
</ul>
<h4 class="mume-header" id="32-%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">3.2 &#x7F51;&#x7EDC;&#x67B6;&#x6784;</h4>

<ul>
<li>Inverted residuals<br>
ResNet&#x4E2D;Residuals block&#x5148;&#x7ECF;&#x8FC7;1*1&#x7684;Conv layer&#xFF0C;&#x628A;feature map&#x7684;&#x901A;&#x9053;&#x6570;&#x964D;&#x4E0B;&#x6765;&#xFF0C;&#x518D;&#x7ECF;&#x8FC7;3*3 Conv layer&#xFF0C;&#x6700;&#x540E;&#x7ECF;&#x8FC7;&#x4E00;&#x4E2A;1*1 &#x7684;Conv layer&#xFF0C;&#x5C06;feature map &#x901A;&#x9053;&#x6570;&#x518D;&#x201C;&#x6269;&#x5F20;&#x201D;&#x56DE;&#x53BB;&#x3002;&#x5373;&#x91C7;&#x7528;&#x5148;&#x538B;&#x7F29;&#xFF0C;&#x540E;&#x6269;&#x5F20;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x800C; inverted residuals&#x91C7;&#x7528;&#x5148;&#x6269;&#x5F20;&#xFF0C;&#x540E;&#x538B;&#x7F29;&#x7684;&#x65B9;&#x5F0F;&#x3002;<br>
MobileNet&#x91C7;&#x7528;DW conv&#x63D0;&#x53D6;&#x7279;&#x5F81;&#xFF0C;&#x7531;&#x4E8E;DW conv&#x672C;&#x8EAB;&#x63D0;&#x53D6;&#x7684;&#x7279;&#x5F81;&#x6570;&#x5C31;&#x5C11;&#xFF0C;&#x518D;&#x7ECF;&#x8FC7;&#x4F20;&#x7EDF;residuals block&#x8FDB;&#x884C;&#x201C;&#x538B;&#x7F29;&#x201D;&#xFF0C;&#x6B64;&#x65F6;&#x63D0;&#x53D6;&#x7684;&#x7279;&#x5F81;&#x6570;&#x4F1A;&#x66F4;&#x5C11;&#xFF0C;&#x56E0;&#x6B64;inverted residuals&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x201C;&#x6269;&#x5F20;&#x201D;&#xFF0C;&#x4FDD;&#x8BC1;&#x7F51;&#x7EDC;&#x53EF;&#x4EE5;&#x63D0;&#x53D6;&#x66F4;&#x591A;&#x7684;&#x7279;&#x5F81;&#x3002;<br>
<img src="./img/ch17/17.png" alt="image"></li>
<li>Linear bottlenecks<br>
ReLu&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x4F1A;&#x7834;&#x574F;&#x7279;&#x5F81;&#x3002;ReLu&#x5BF9;&#x4E8E;&#x8D1F;&#x7684;&#x8F93;&#x5165;&#xFF0C;&#x8F93;&#x51FA;&#x5168;&#x4E3A;0&#xFF0C;&#x800C;&#x672C;&#x6765;DW conv&#x7279;&#x5F81;&#x901A;&#x9053;&#x5DF2;&#x7ECF;&#x88AB;&#x201C;&#x538B;&#x7F29;&#x201D;&#xFF0C;&#x518D;&#x7ECF;&#x8FC7;ReLu&#x7684;&#x8BDD;&#xFF0C;&#x53C8;&#x4F1A;&#x635F;&#x5931;&#x4E00;&#x90E8;&#x5206;&#x7279;&#x5F81;&#x3002;&#x91C7;&#x7528;Linear&#xFF0C;&#x76EE;&#x7684;&#x662F;&#x9632;&#x6B62;Relu&#x7834;&#x574F;&#x7279;&#x5F81;&#x3002;<br>
<img src="./img/ch17/18.png" alt="image"></li>
<li>shortcut<br>
stride=2&#x7684;conv&#x4E0D;&#x4F7F;&#x7528;shot-cot&#xFF0C;stride=1&#x7684;conv&#x4F7F;&#x7528;shot-cut<br>
<img src="./img/ch17/19.png" alt="image"></li>
<li>&#x7F51;&#x7EDC;&#x67B6;&#x6784;<br>
<img src="./img/ch17/20.png" alt="image"></li>
</ul>
<h3 class="mume-header" id="4-xception">4. Xception</h3>

<p>Xception&#x662F;Google&#x63D0;&#x51FA;&#x7684;&#xFF0C;arXiv &#x7684;V1 &#x4E8E;2016&#x5E74;10&#x6708;&#x516C;&#x5F00;&#x300A;Xception: Deep Learning with Depthwise Separable Convolutions &#x300B;&#xFF0C;Xception&#x662F;&#x5BF9;Inception v3&#x7684;&#x53E6;&#x4E00;&#x79CD;&#x6539;&#x8FDB;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x91C7;&#x7528;depthwise separable convolution&#x6765;&#x66FF;&#x6362;&#x539F;&#x6765;Inception v3&#x4E2D;&#x7684;&#x5377;&#x79EF;&#x64CD;&#x4F5C;&#x3002;</p>
<h4 class="mume-header" id="41%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">4.1&#x8BBE;&#x8BA1;&#x601D;&#x60F3;</h4>

<ul>
<li>&#x91C7;&#x7528;depthwise separable convolution&#x6765;&#x66FF;&#x6362;&#x539F;&#x6765;Inception v3&#x4E2D;&#x7684;&#x5377;&#x79EF;&#x64CD;&#x4F5C;<br>
&#x4E0E;&#x539F;&#x7248;&#x7684;Depth-wise convolution&#x6709;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#xFF1A;
<ul>
<li>&#x7B2C;&#x4E00;&#x4E2A;&#xFF1A;&#x539F;&#x7248;Depth-wise convolution&#xFF0C;&#x5148;&#x9010;&#x901A;&#x9053;&#x5377;&#x79EF;&#xFF0C;&#x518D;1*1&#x5377;&#x79EF;; &#x800C;Xception&#x662F;&#x53CD;&#x8FC7;&#x6765;&#xFF0C;&#x5148;1*1&#x5377;&#x79EF;&#xFF0C;&#x518D;&#x9010;&#x901A;&#x9053;&#x5377;&#x79EF;&#xFF1B;</li>
<li>&#x7B2C;&#x4E8C;&#x4E2A;&#xFF1A;&#x539F;&#x7248;Depth-wise convolution&#x7684;&#x4E24;&#x4E2A;&#x5377;&#x79EF;&#x4E4B;&#x95F4;&#x662F;&#x4E0D;&#x5E26;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x7684;&#xFF0C;&#x800C;Xception&#x5728;&#x7ECF;&#x8FC7;1*1&#x5377;&#x79EF;&#x4E4B;&#x540E;&#x4F1A;&#x5E26;&#x4E0A;&#x4E00;&#x4E2A;Relu&#x7684;&#x975E;&#x7EBF;&#x6027;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#xFF1B;</li>
</ul>
</li>
</ul>
<h4 class="mume-header" id="42%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">4.2&#x7F51;&#x7EDC;&#x67B6;&#x6784;</h4>

<p>feature map&#x5728;&#x7A7A;&#x95F4;&#x548C;&#x901A;&#x9053;&#x4E0A;&#x5177;&#x6709;&#x4E00;&#x5B9A;&#x7684;&#x76F8;&#x5173;&#x6027;&#xFF0C;&#x901A;&#x8FC7;Inception&#x6A21;&#x5757;&#x548C;&#x975E;&#x7EBF;&#x6027;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x5B9E;&#x73B0;&#x901A;&#x9053;&#x4E4B;&#x95F4;&#x7684;&#x89E3;&#x8026;&#x3002;&#x589E;&#x591A;3*3&#x7684;&#x5377;&#x79EF;&#x7684;&#x5206;&#x652F;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x4F7F;&#x5B83;&#x4E0E;1*1&#x7684;&#x5377;&#x79EF;&#x7684;&#x8F93;&#x51FA;&#x901A;&#x9053;&#x6570;&#x76F8;&#x7B49;&#xFF0C;&#x6B64;&#x65F6;&#x6BCF;&#x4E2A;3*3&#x7684;&#x5377;&#x79EF;&#x53EA;&#x4F5C;&#x7528;&#x4E0E;&#x4E00;&#x4E2A;&#x901A;&#x9053;&#x7684;&#x7279;&#x5F81;&#x56FE;&#x4E0A;&#xFF0C;&#x4F5C;&#x8005;&#x79F0;&#x4E4B;&#x4E3A;&#x201C;&#x6781;&#x81F4;&#x7684;Inception&#xFF08;Extream Inception&#xFF09;&#x201D;&#x6A21;&#x5757;&#xFF0C;&#x8FD9;&#x5C31;&#x662F;Xception&#x7684;&#x57FA;&#x672C;&#x6A21;&#x5757;&#x3002;<br>
<img src="./img/ch17/21.png" alt="image"></p>
<h3 class="mume-header" id="5-shufflenet-v1">5. ShuffleNet-v1</h3>

<p>ShuffleNet &#x662F;Face++&#x56E2;&#x961F;&#x63D0;&#x51FA;&#x7684;&#xFF0C;&#x665A;&#x4E8E;MobileNet&#x4E24;&#x4E2A;&#x6708;&#x5728;arXiv&#x4E0A;&#x516C;&#x5F00;&#x300A;ShuffleNet&#xFF1A; An Extremely Efficient Convolutional Neural Network for Mobile Devices &#x300B;&#x7528;&#x4E8E;&#x79FB;&#x52A8;&#x7AEF;&#x524D;&#x5411;&#x90E8;&#x7F72;&#x7684;&#x7F51;&#x7EDC;&#x67B6;&#x6784;&#x3002;ShuffleNet&#x57FA;&#x4E8E;MobileNet&#x7684;group&#x601D;&#x60F3;&#xFF0C;&#x5C06;&#x5377;&#x79EF;&#x64CD;&#x4F5C;&#x9650;&#x5236;&#x5230;&#x7279;&#x5B9A;&#x7684;&#x8F93;&#x5165;&#x901A;&#x9053;&#x3002;&#x800C;&#x4E0E;&#x4E4B;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;ShuffleNet&#x5C06;&#x8F93;&#x5165;&#x7684;group&#x8FDB;&#x884C;&#x6253;&#x6563;&#xFF0C;&#x4ECE;&#x800C;&#x4FDD;&#x8BC1;&#x6BCF;&#x4E2A;&#x5377;&#x79EF;&#x6838;&#x7684;&#x611F;&#x53D7;&#x91CE;&#x80FD;&#x591F;&#x5206;&#x6563;&#x5230;&#x4E0D;&#x540C;group&#x7684;&#x8F93;&#x5165;&#x4E2D;&#xFF0C;&#x589E;&#x52A0;&#x4E86;&#x6A21;&#x578B;&#x7684;&#x5B66;&#x4E60;&#x80FD;&#x529B;&#x3002;</p>
<h4 class="mume-header" id="51-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">5.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</h4>

<ul>
<li>&#x91C7;&#x7528;group conv&#x51CF;&#x5C11;&#x5927;&#x91CF;&#x53C2;&#x6570;
<ul>
<li>roup conv&#x4E0E;DW conv&#x5B58;&#x5728;&#x76F8;&#x540C;&#x7684;&#x201C;&#x4FE1;&#x606F;&#x6D41;&#x901A;&#x4E0D;&#x7545;&#x201D;&#x95EE;&#x9898;</li>
</ul>
</li>
<li>&#x91C7;&#x7528;channel shuffle&#x89E3;&#x51B3;&#x4E0A;&#x8FF0;&#x95EE;&#x9898;
<ul>
<li>MobileNet&#x4E2D;&#x91C7;&#x7528;PW conv&#x89E3;&#x51B3;&#x4E0A;&#x8FF0;&#x95EE;&#x9898;&#xFF0C;SheffleNet&#x4E2D;&#x91C7;&#x7528;channel shuffle</li>
</ul>
</li>
<li>&#x91C7;&#x7528;concat&#x66FF;&#x6362;add&#x64CD;&#x4F5C;
<ul>
<li>avg pooling&#x548C;DW conv(s=2)&#x4F1A;&#x51CF;&#x5C0F;feature map&#x7684;&#x5206;&#x8FA8;&#x7387;&#xFF0C;&#x91C7;&#x7528;concat&#x589E;&#x52A0;&#x901A;&#x9053;&#x6570;&#x4ECE;&#x800C;&#x5F25;&#x8865;&#x5206;&#x8FA8;&#x7387;&#x51CF;&#x5C0F;&#x800C;&#x5E26;&#x6765;&#x4FE1;&#x606F;&#x7684;&#x635F;&#x5931;</li>
</ul>
</li>
</ul>
<h4 class="mume-header" id="52-%E7%BD%91%E7%BB%9C%E6%9E%B6%E6%9E%84">5.2 &#x7F51;&#x7EDC;&#x67B6;&#x6784;</h4>

<p>MobileNet&#x4E2D;1*1&#x5377;&#x79EF;&#x7684;&#x64CD;&#x4F5C;&#x5360;&#x636E;&#x4E86;&#x7EA6;95%&#x7684;&#x8BA1;&#x7B97;&#x91CF;&#xFF0C;&#x6240;&#x4EE5;&#x4F5C;&#x8005;&#x5C06;1*1&#x4E5F;&#x66F4;&#x6539;&#x4E3A;group&#x5377;&#x79EF;&#xFF0C;&#x4F7F;&#x5F97;&#x76F8;&#x6BD4;MobileNet&#x7684;&#x8BA1;&#x7B97;&#x91CF;&#x5927;&#x5927;&#x51CF;&#x5C11;&#x3002;<br>
<img src="./img/ch17/22.png" alt="image"><br>
group&#x5377;&#x79EF;&#x4E0E;DW&#x5B58;&#x5728;&#x540C;&#x6837;&#x4F7F;&#x201C;&#x901A;&#x9053;&#x4FE1;&#x606F;&#x4EA4;&#x6D41;&#x4E0D;&#x7545;&#x201D;&#x7684;&#x95EE;&#x9898;&#xFF0C;MobileNet&#x4E2D;&#x91C7;&#x7528;PW conv&#x89E3;&#x51B3;&#x4E0A;&#x8FF0;&#x95EE;&#x9898;&#xFF0C;SheffleNet&#x4E2D;&#x91C7;&#x7528;channel shuffle&#x3002;<br>
ShuffleNet&#x7684;shuffle&#x64CD;&#x4F5C;&#x5982;&#x56FE;&#x6240;&#x793A;<br>
<img src="./img/ch17/24.png" alt="image"><br>
avg pooling&#x548C;DW conv(s=2)&#x4F1A;&#x51CF;&#x5C0F;feature map&#x7684;&#x5206;&#x8FA8;&#x7387;&#xFF0C;&#x91C7;&#x7528;concat&#x589E;&#x52A0;&#x901A;&#x9053;&#x6570;&#x4ECE;&#x800C;&#x5F25;&#x8865;&#x5206;&#x8FA8;&#x7387;&#x51CF;&#x5C0F;&#x800C;&#x5E26;&#x6765;&#x4FE1;&#x606F;&#x7684;&#x635F;&#x5931;&#xFF1B;&#x5B9E;&#x9A8C;&#x8868;&#x660E;&#xFF1A;&#x591A;&#x591A;&#x4F7F;&#x7528;&#x901A;&#x9053;(&#x63D0;&#x5347;&#x901A;&#x9053;&#x7684;&#x4F7F;&#x7528;&#x7387;)&#xFF0C;&#x6709;&#x52A9;&#x4E8E;&#x63D0;&#x9AD8;&#x5C0F;&#x6A21;&#x578B;&#x7684;&#x51C6;&#x786E;&#x7387;&#x3002;<br>
<img src="./img/ch17/23.png" alt="image"><br>
&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#xFF1A;<br>
<img src="./img/ch17/25.png" alt="image"></p>
<h3 class="mume-header" id="6-shufflenet-v2">6. ShuffleNet-v2</h3>

<p>huffleNet-v2 &#x662F;Face++&#x56E2;&#x961F;&#x63D0;&#x51FA;&#x7684;&#x300A;ShuffleNet V2: Practical Guidelines for Ecient CNN Architecture Design&#x300B;&#xFF0C;&#x65E8;&#x5728;&#x8BBE;&#x8BA1;&#x4E00;&#x4E2A;&#x8F7B;&#x91CF;&#x7EA7;&#x4F46;&#x662F;&#x4FDD;&#x8BC1;&#x7CBE;&#x5EA6;&#x3001;&#x901F;&#x5EA6;&#x7684;&#x6DF1;&#x5EA6;&#x7F51;&#x7EDC;&#x3002;</p>
<h4 class="mume-header" id="61-%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3">6.1 &#x8BBE;&#x8BA1;&#x601D;&#x60F3;</h4>

<ul>
<li>&#x6587;&#x4E2D;&#x63D0;&#x51FA;&#x5F71;&#x54CD;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x901F;&#x5EA6;&#x7684;4&#x4E2A;&#x56E0;&#x7D20;&#xFF1A;
<ul>
<li>a. FLOPs(FLOPs&#x5C31;&#x662F;&#x7F51;&#x7EDC;&#x6267;&#x884C;&#x4E86;&#x591A;&#x5C11;multiply-adds&#x64CD;&#x4F5C;)</li>
<li>b. MAC(&#x5185;&#x5B58;&#x8BBF;&#x95EE;&#x6210;&#x672C;)</li>
<li>c. &#x5E76;&#x884C;&#x5EA6;(&#x5982;&#x679C;&#x7F51;&#x7EDC;&#x5E76;&#x884C;&#x5EA6;&#x9AD8;&#xFF0C;&#x901F;&#x5EA6;&#x660E;&#x663E;&#x63D0;&#x5347;)</li>
<li>d. &#x8BA1;&#x7B97;&#x5E73;&#x53F0;(GPU&#xFF0C;ARM)</li>
</ul>
</li>
<li>ShuffleNet-v2 &#x63D0;&#x51FA;&#x4E86;4&#x70B9;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x8BBE;&#x8BA1;&#x7B56;&#x7565;&#xFF1A;
<ul>
<li>G1.&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7684;channel&#x76F8;&#x540C;&#x65F6;&#xFF0C;MAC&#x6700;&#x5C0F;</li>
<li>G2.&#x8FC7;&#x5EA6;&#x7684;&#x7EC4;&#x5377;&#x79EF;&#x4F1A;&#x589E;&#x52A0;MAC</li>
<li>G3.&#x7F51;&#x7EDC;&#x788E;&#x7247;&#x5316;&#x4F1A;&#x964D;&#x4F4E;&#x5E76;&#x884C;&#x5EA6;</li>
<li>G4.&#x5143;&#x7D20;&#x7EA7;&#x8FD0;&#x7B97;&#x4E0D;&#x53EF;&#x5FFD;&#x89C6;</li>
</ul>
</li>
</ul>
<h4 class="mume-header" id="62-%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84">6.2 &#x7F51;&#x7EDC;&#x7ED3;&#x6784;</h4>

<p>depthwise convolution &#x548C; &#x74F6;&#x9888;&#x7ED3;&#x6784;&#x589E;&#x52A0;&#x4E86; MAC&#xFF0C;&#x7528;&#x4E86;&#x592A;&#x591A;&#x7684; group&#xFF0C;&#x8DE8;&#x5C42;&#x8FDE;&#x63A5;&#x4E2D;&#x7684; element-wise Add &#x64CD;&#x4F5C;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x4F18;&#x5316;&#x7684;&#x70B9;&#x3002;&#x6240;&#x4EE5;&#x5728; shuffleNet V2 &#x4E2D;&#x589E;&#x52A0;&#x4E86;&#x51E0;&#x79CD;&#x65B0;&#x7279;&#x6027;&#x3002;<br>
&#x6240;&#x8C13;&#x7684; channel split &#x5176;&#x5B9E;&#x5C31;&#x662F;&#x5C06;&#x901A;&#x9053;&#x6570;&#x4E00;&#x5206;&#x4E3A;2&#xFF0C;&#x5316;&#x6210;&#x4E24;&#x5206;&#x652F;&#x6765;&#x4EE3;&#x66FF;&#x539F;&#x5148;&#x7684;&#x5206;&#x7EC4;&#x5377;&#x79EF;&#x7ED3;&#x6784;&#xFF08;G2&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x4E2A;&#x5206;&#x652F;&#x4E2D;&#x7684;&#x5377;&#x79EF;&#x5C42;&#x90FD;&#x662F;&#x4FDD;&#x6301;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x901A;&#x9053;&#x6570;&#x76F8;&#x540C;&#xFF08;G1&#xFF09;&#xFF0C;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5206;&#x652F;&#x4E0D;&#x91C7;&#x53D6;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x51CF;&#x5C11;&#x57FA;&#x672C;&#x5355;&#x5143;&#x6570;&#xFF08;G3&#xFF09;&#xFF0C;&#x6700;&#x540E;&#x4F7F;&#x7528;&#x4E86; concat &#x4EE3;&#x66FF;&#x539F;&#x6765;&#x7684; elementy-wise add&#xFF0C;&#x5E76;&#x4E14;&#x540E;&#x9762;&#x4E0D;&#x52A0; ReLU &#x76F4;&#x63A5;&#xFF08;G4&#xFF09;&#xFF0C;&#x518D;&#x52A0;&#x5165;channle shuffle &#x6765;&#x589E;&#x52A0;&#x901A;&#x9053;&#x4E4B;&#x95F4;&#x7684;&#x4FE1;&#x606F;&#x4EA4;&#x6D41;&#x3002; &#x5BF9;&#x4E8E;&#x4E0B;&#x91C7;&#x6837;&#x5C42;&#xFF0C;&#x5728;&#x8FD9;&#x4E00;&#x5C42;&#x4E2D;&#x5BF9;&#x901A;&#x9053;&#x6570;&#x8FDB;&#x884C;&#x7FFB;&#x500D;&#x3002; &#x5728;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x7684;&#x6700;&#x540E;&#xFF0C;&#x5373;&#x5E73;&#x5747;&#x503C;&#x6C60;&#x5316;&#x5C42;&#x524D;&#x52A0;&#x5165;&#x4E00;&#x5C42; 1x1 &#x7684;&#x5377;&#x79EF;&#x5C42;&#x6765;&#x8FDB;&#x4E00;&#x6B65;&#x7684;&#x6DF7;&#x5408;&#x7279;&#x5F81;&#x3002;<br>
<img src="./img/ch17/26.png" alt="image"><br>
&#x7F51;&#x7EDC;&#x7ED3;&#x6784;<br>
<img src="./img/ch17/27.png" alt="image"></p>
<h4 class="mume-header" id="64-shufflenet-v2%E5%85%B7%E6%9C%89%E9%AB%98%E7%B2%BE%E5%BA%A6%E7%9A%84%E5%8E%9F%E5%9B%A0">6.4  ShuffleNet-v2&#x5177;&#x6709;&#x9AD8;&#x7CBE;&#x5EA6;&#x7684;&#x539F;&#x56E0;</h4>

<ul>
<li>&#x7531;&#x4E8E;&#x9AD8;&#x6548;&#xFF0C;&#x53EF;&#x4EE5;&#x589E;&#x52A0;&#x66F4;&#x591A;&#x7684;channel&#xFF0C;&#x589E;&#x52A0;&#x7F51;&#x7EDC;&#x5BB9;&#x91CF;</li>
<li>&#x91C7;&#x7528;split&#x4F7F;&#x5F97;&#x4E00;&#x90E8;&#x5206;&#x7279;&#x5F81;&#x76F4;&#x63A5;&#x4E0E;&#x4E0B;&#x9762;&#x7684;block&#x76F8;&#x8FDE;&#xFF0C;&#x7279;&#x5F81;&#x590D;&#x7528;(DenseNet)</li>
</ul>
<h2 class="mume-header" id="177-%E7%8E%B0%E6%9C%89%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6%E5%8F%8A%E5%85%B6%E7%89%B9%E7%82%B9">17.7 &#x73B0;&#x6709;&#x79FB;&#x52A8;&#x7AEF;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#x53CA;&#x5176;&#x7279;&#x70B9;</h2>

<h3 class="mume-header" id="1771-ncnn">17.7.1 NCNN</h3>

<p>&#xFF11;&#x3001;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#xFF1A;2017&#x5E74;7&#x6708;</p>
<p>&#xFF12;&#x3001;&#x5F00;&#x6E90;&#x7528;&#x6237;&#xFF1A;&#x817E;&#x8BAF;&#x4F18;&#x56FE;</p>
<p>&#xFF13;&#x3001;GitHub&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/Tencent/ncnn">https://github.com/Tencent/ncnn</a></p>
<p>4&#x3001;&#x7279;&#x70B9;&#xFF1A;</p>
<ul>
<li>1&#xFF09;NCNN&#x8003;&#x8651;&#x4E86;&#x624B;&#x673A;&#x7AEF;&#x7684;&#x786C;&#x4EF6;&#x548C;&#x7CFB;&#x7EDF;&#x5DEE;&#x5F02;&#x4EE5;&#x53CA;&#x8C03;&#x7528;&#x65B9;&#x5F0F;&#xFF0C;&#x67B6;&#x6784;&#x8BBE;&#x8BA1;&#x4EE5;&#x624B;&#x673A;&#x7AEF;&#x8FD0;&#x884C;&#x4E3A;&#x4E3B;&#x8981;&#x539F;&#x5219;&#x3002;</li>
<li>2&#xFF09;&#x65E0;&#x7B2C;&#x4E09;&#x65B9;&#x4F9D;&#x8D56;&#xFF0C;&#x8DE8;&#x5E73;&#x53F0;&#xFF0C;&#x624B;&#x673A;&#x7AEF; CPU &#x7684;&#x901F;&#x5EA6;&#x5FEB;&#x4E8E;&#x76EE;&#x524D;&#x6240;&#x6709;&#x5DF2;&#x77E5;&#x7684;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#xFF08;&#x4EE5;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#x4E3A;&#x53C2;&#x7167;&#x5BF9;&#x8C61;&#xFF09;&#x3002;</li>
<li>3&#xFF09;&#x57FA;&#x4E8E; ncnn&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x80FD;&#x591F;&#x5C06;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x7B97;&#x6CD5;&#x8F7B;&#x677E;&#x79FB;&#x690D;&#x5230;&#x624B;&#x673A;&#x7AEF;&#x9AD8;&#x6548;&#x6267;&#x884C;&#xFF0C;&#x5F00;&#x53D1;&#x51FA;&#x4EBA;&#x5DE5;&#x667A;&#x80FD; APP&#x3002;</li>
</ul>
<p>5&#x3001;&#x529F;&#x80FD;&#xFF1A;</p>
<ul>
<li>1&#x3001;NCNN&#x652F;&#x6301;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x3001;&#x591A;&#x5206;&#x652F;&#x591A;&#x8F93;&#x5165;&#x7684;&#x590D;&#x6742;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#xFF0C;&#x5982;vgg&#x3001;googlenet&#x3001;resnet&#x3001;squeezenet &#x7B49;&#x3002;</li>
<li>2&#x3001;NCNN&#x65E0;&#x9700;&#x4F9D;&#x8D56;&#x4EFB;&#x4F55;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#x3002;</li>
<li>3&#x3001;NCNN&#x5168;&#x90E8;&#x4F7F;&#x7528;C/C++&#x5B9E;&#x73B0;&#xFF0C;&#x4EE5;&#x53CA;&#x8DE8;&#x5E73;&#x53F0;&#x7684;cmake&#x7F16;&#x8BD1;&#x7CFB;&#x7EDF;&#xFF0C;&#x53EF;&#x8F7B;&#x677E;&#x79FB;&#x690D;&#x5230;&#x5176;&#x4ED6;&#x7CFB;&#x7EDF;&#x548C;&#x8BBE;&#x5907;&#x4E0A;&#x3002;</li>
<li>4&#x3001;&#x6C47;&#x7F16;&#x7EA7;&#x4F18;&#x5316;&#xFF0C;&#x8BA1;&#x7B97;&#x901F;&#x5EA6;&#x6781;&#x5FEB;&#x3002;&#x4F7F;&#x7528;ARM NEON&#x6307;&#x4EE4;&#x96C6;&#x5B9E;&#x73B0;&#x5377;&#x79EF;&#x5C42;&#xFF0C;&#x5168;&#x8FDE;&#x63A5;&#x5C42;&#xFF0C;&#x6C60;&#x5316;&#x5C42;&#x7B49;&#x5927;&#x90E8;&#x5206; CNN &#x5173;&#x952E;&#x5C42;&#x3002;</li>
<li>5&#x3001;&#x7CBE;&#x7EC6;&#x7684;&#x6570;&#x636E;&#x7ED3;&#x6784;&#x8BBE;&#x8BA1;&#xFF0C;&#x6CA1;&#x6709;&#x91C7;&#x7528;&#x9700;&#x6D88;&#x8017;&#x5927;&#x91CF;&#x5185;&#x5B58;&#x7684;&#x901A;&#x5E38;&#x6846;&#x67B6;&#x2014;&#x2014;im2col + &#x77E9;&#x9635;&#x4E58;&#x6CD5;&#xFF0C;&#x4F7F;&#x5F97;&#x5185;&#x5B58;&#x5360;&#x7528;&#x6781;&#x4F4E;&#x3002;</li>
<li>6&#x3001;&#x652F;&#x6301;&#x591A;&#x6838;&#x5E76;&#x884C;&#x8BA1;&#x7B97;&#xFF0C;&#x4F18;&#x5316;CPU&#x8C03;&#x5EA6;&#x3002;</li>
<li>7&#x3001;&#x6574;&#x4F53;&#x5E93;&#x4F53;&#x79EF;&#x5C0F;&#x4E8E;500K&#xFF0C;&#x53EF;&#x7CBE;&#x7B80;&#x5230;&#x5C0F;&#x4E8E;300K&#x3002;</li>
<li>8&#x3001;&#x53EF;&#x6269;&#x5C55;&#x7684;&#x6A21;&#x578B;&#x8BBE;&#x8BA1;&#xFF0C;&#x652F;&#x6301;8bit &#x91CF;&#x5316;&#x548C;&#x534A;&#x7CBE;&#x5EA6;&#x6D6E;&#x70B9;&#x5B58;&#x50A8;&#x3002;</li>
<li>9&#x3001;&#x652F;&#x6301;&#x76F4;&#x63A5;&#x5185;&#x5B58;&#x5F15;&#x7528;&#x52A0;&#x8F7D;&#x7F51;&#x7EDC;&#x6A21;&#x578B;&#x3002;</li>
<li>10&#x3001;&#x53EF;&#x6CE8;&#x518C;&#x81EA;&#x5B9A;&#x4E49;&#x5C42;&#x5B9E;&#x73B0;&#x5E76;&#x6269;&#x5C55;&#x3002;</li>
</ul>
<p>6&#x3001;NCNN&#x5728;Android&#x7AEF;&#x90E8;&#x7F72;&#x793A;&#x4F8B;</p>
<ul>
<li>1&#xFF09;&#x9009;&#x62E9;&#x5408;&#x9002;&#x7684;Android Studio&#x7248;&#x672C;&#x5E76;&#x5B89;&#x88C5;&#x3002;</li>
<li>2&#xFF09;&#x6839;&#x636E;&#x9700;&#x6C42;&#x9009;&#x62E9;NDK&#x7248;&#x672C;&#x5E76;&#x5B89;&#x88C5;&#x3002;</li>
<li>3&#xFF09;&#x5728;Android Studio&#x4E0A;&#x914D;&#x7F6E;NDK&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x3002;</li>
<li>4&#xFF09;&#x6839;&#x636E;&#x81EA;&#x5DF1;&#x9700;&#x8981;&#x7F16;&#x8BD1;NCNN sdk</li>
</ul>
<pre data-role="codeBlock" data-info="" class="language-"><code>mkdir build-android cd build-android cmake -DCMAKE_TOOLCHAIN_FILE=$ANDROID_NDK/build/cmake/android.toolchain.cmake \ -DANDROID_ABI=&quot;armeabi-v7a&quot; -DANDROID_ARM_NEON=ON \ -DANDROID_PLATFORM=android-14 .. make make install
</code></pre><p>&#x200B;	&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;install&#x4E0B;&#x6709;include&#x548C;lib&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x3002;</p>
<p>&#x200B;	&#x5907;&#x6CE8;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>ANDROID_ABI &#x662F;&#x67B6;&#x6784;&#x540D;&#x5B57;&#xFF0C;&quot;armeabi-v7a&quot; &#x652F;&#x6301;&#x7EDD;&#x5927;&#x90E8;&#x5206;&#x624B;&#x673A;&#x786C;&#x4EF6; 
ANDROID_ARM_NEON &#x662F;&#x5426;&#x4F7F;&#x7528; NEON &#x6307;&#x4EE4;&#x96C6;&#xFF0C;&#x8BBE;&#x4E3A; ON &#x652F;&#x6301;&#x7EDD;&#x5927;&#x90E8;&#x5206;&#x624B;&#x673A;&#x786C;&#x4EF6; 
ANDROID_PLATFORM &#x6307;&#x5B9A;&#x6700;&#x4F4E;&#x7CFB;&#x7EDF;&#x7248;&#x672C;&#xFF0C;&quot;android-14&quot; &#x5C31;&#x662F; android-4.0
</code></pre><ul>
<li>5&#xFF09;&#x8FDB;&#x884C;NDK&#x5F00;&#x53D1;&#x3002;</li>
</ul>
<pre data-role="codeBlock" data-info="" class="language-"><code>1&#xFF09;assets&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x653E;&#x7F6E;&#x4F60;&#x7684;bin&#x548C;param&#x6587;&#x4EF6;&#x3002;
2&#xFF09;jni&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x653E;&#x7F6E;&#x4F60;&#x7684;cpp&#x548C;mk&#x6587;&#x4EF6;&#x3002;
3&#xFF09;&#x4FEE;&#x6539;&#x4F60;&#x7684;app gradle&#x6587;&#x4EF6;&#x3002;
4&#xFF09;&#x914D;&#x7F6E;Android.mk&#x548C;Application.mk&#x6587;&#x4EF6;&#x3002;
5&#xFF09;&#x8FDB;&#x884C;java&#x63A5;&#x53E3;&#x7684;&#x7F16;&#x5199;&#x3002;
6&#xFF09;&#x8BFB;&#x53D6;&#x62F7;&#x8D1D;bin&#x548C;param&#x6587;&#x4EF6;&#xFF08;&#x6709;&#x4E9B;&#x5219;&#x662F;pb&#x6587;&#x4EF6;&#xFF0C;&#x6839;&#x636E;&#x5B9E;&#x9645;&#x60C5;&#x51B5;&#xFF09;&#x3002;
7&#xFF09;&#x8FDB;&#x884C;&#x6A21;&#x578B;&#x7684;&#x521D;&#x59CB;&#x5316;&#x548C;&#x6267;&#x884C;&#x9884;&#x6D4B;&#x7B49;&#x64CD;&#x4F5C;&#x3002;
8&#xFF09;build&#x3002;
9&#xFF09;cd&#x5230;src/main/jni&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x6267;&#x884C;ndk-build&#xFF0C;&#x751F;&#x6210;.so&#x6587;&#x4EF6;&#x3002;
10&#xFF09;&#x63A5;&#x7740;&#x5C31;&#x53EF;&#x5199;&#x81EA;&#x5DF1;&#x7684;&#x64CD;&#x4F5C;&#x5904;&#x7406;&#x9700;&#x6C42;&#x3002;
</code></pre><h3 class="mume-header" id="1772-qnnpack">17.7.2 QNNPACK</h3>

<p>&#x5168;&#x79F0;&#xFF1A;Quantized Neural Network PACKage&#xFF08;&#x91CF;&#x5316;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5305;&#xFF09;</p>
<p>&#xFF11;&#x3001;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#xFF1A;2018&#x5E74;10&#x6708;</p>
<p>&#xFF12;&#x3001;&#x5F00;&#x6E90;&#x7528;&#x6237;&#xFF1A;Facebook</p>
<p>&#xFF13;&#x3001;GitHub&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/pytorch/QNNPACK">https://github.com/pytorch/QNNPACK</a></p>
<p>&#xFF14;&#x3001;&#x7279;&#x70B9;&#xFF1A;</p>
<p>&#x200B;	&#xFF11;&#xFF09;&#x4F4E;&#x5BC6;&#x5EA6;&#x5377;&#x79EF;&#x4F18;&#x5316;&#x51FD;&#x6570;&#x5E93;&#xFF1B;</p>
<p>&#xFF12;&#xFF09;&#x53EF;&#x5728;&#x624B;&#x673A;&#x4E0A;&#x5B9E;&#x65F6;&#x8FD0;&#x884C;Mask R-CNN &#x548C; DensePose;</p>
<p>&#x200B;	&#xFF13;&#xFF09; &#x80FD;&#x5728;&#x6027;&#x80FD;&#x53D7;&#x9650;&#x7684;&#x79FB;&#x52A8;&#x8BBE;&#x5907;&#x4E2D;&#x7528; 100ms &#x4EE5;&#x5185;&#x7684;&#x65F6;&#x95F4;&#x5B9E;&#x65BD;&#x56FE;&#x50CF;&#x5206;&#x7C7B;&#xFF1B;</p>
<p>5&#x3001;QNNPACK &#x5982;&#x4F55;&#x63D0;&#x9AD8;&#x6548;&#x7387;&#xFF1F;</p>
<p>1)<strong>QNNPACK &#x4F7F;&#x7528;&#x4E0E;&#x5B89;&#x5353;&#x795E;&#x7ECF;&#x7F51;&#x7EDC; API &#x517C;&#x5BB9;&#x7684;&#x7EBF;&#x6027;&#x91CF;&#x5316;&#x65B9;&#x6848;</strong></p>
<p>QNNPACK &#x7684;&#x8F93;&#x5165;&#x77E9;&#x9635;&#x6765;&#x81EA;&#x4F4E;&#x7CBE;&#x5EA6;&#x3001;&#x79FB;&#x52A8;&#x4E13;&#x7528;&#x7684;&#x8BA1;&#x7B97;&#x673A;&#x89C6;&#x89C9;&#x6A21;&#x578B;&#x3002;&#x5176;&#x5B83;&#x5E93;&#x5728;&#x8BA1;&#x7B97;A&#x548C;B&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x65F6;&#xFF0C;&#x91CD;&#x65B0;&#x6253;&#x5305; A &#x548C; B &#x77E9;&#x9635;&#x4EE5;&#x66F4;&#x597D;&#x5730;&#x5229;&#x7528;&#x7F13;&#x5B58;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#xFF0C;&#x5E0C;&#x671B;&#x5728;&#x5927;&#x91CF;&#x8BA1;&#x7B97;&#x4E2D;&#x5206;&#x644A;&#x6253;&#x5305;&#x5F00;&#x9500;&#xFF0C;QNNPACK &#x5220;&#x9664;&#x6240;&#x6709;&#x8BA1;&#x7B97;&#x975E;&#x5FC5;&#x9700;&#x7684;&#x5185;&#x5B58;&#x8F6C;&#x6362;&#xFF0C;&#x9488;&#x5BF9; A&#x548C;B&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x9002;&#x7528;&#x4E8E;&#x4E00;&#x7EA7;&#x7F13;&#x5B58;&#x7684;&#x60C5;&#x51B5;&#x8FDB;&#x884C;&#x4E86;&#x4F18;&#x5316;&#x3002;</p>
<p><img src="./img/ch17/QNNPACK1.jpeg" alt=""></p>
<p>&#x200B;	&#x5728;&#x91CF;&#x5316;&#x77E9;&#x9635;-&#x77E9;&#x9635;&#x4E58;&#x6CD5;&#x4E2D;&#xFF0C;8  &#x4F4D;&#x6574;&#x6570;&#x7684;&#x4E58;&#x79EF;&#x901A;&#x5E38;&#x4F1A;&#x88AB;&#x7D2F;&#x52A0;&#x81F3; 32 &#x4F4D;&#x7684;&#x4E2D;&#x95F4;&#x7ED3;&#x679C;&#x4E2D;&#xFF0C;&#x968F;&#x540E;&#x91CD;&#x65B0;&#x91CF;&#x5316;&#x4EE5;&#x4EA7;&#x751F; 8 &#x4F4D;&#x7684;&#x8F93;&#x51FA;&#x3002;&#x5E38;&#x89C4;&#x7684;&#x5B9E;&#x73B0;&#x4F1A;&#x5BF9;&#x5927;&#x77E9;&#x9635;&#x5C3A;&#x5BF8;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x2014;&#x2014;&#x6709;&#x65F6; K &#x592A;&#x5927;&#x65E0;&#x6CD5;&#x5C06; A  &#x548C; B &#x7684;&#x9762;&#x677F;&#x8F6C;&#x5165;&#x7F13;&#x5B58;&#x4E2D;&#x3002;&#x4E3A;&#x4E86;&#x6709;&#x6548;&#x5229;&#x7528;&#x7F13;&#x5B58;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#xFF0C;&#x4F20;&#x7EDF;&#x7684; GEMM &#x5B9E;&#x73B0;&#x5C06; A &#x548C; B &#x7684;&#x9762;&#x677F;&#x6CBF; K  &#x7EF4;&#x5206;&#x5272;&#x6210;&#x56FA;&#x5B9A;&#x5927;&#x5C0F;&#x7684;&#x5B50;&#x9762;&#x677F;&#xFF0C;&#x4ECE;&#x800C;&#x6BCF;&#x4E2A;&#x9762;&#x677F;&#x90FD;&#x9002;&#x5E94; L1 &#x7F13;&#x5B58;&#xFF0C;&#x968F;&#x540E;&#x4E3A;&#x6BCF;&#x4E2A;&#x5B50;&#x9762;&#x677F;&#x8C03;&#x7528;&#x5FAE;&#x5185;&#x6838;&#x3002;&#x8FD9;&#x4E00;&#x7F13;&#x5B58;&#x4F18;&#x5316;&#x9700;&#x8981; PDOT &#x4E3A;&#x5185;&#x6838;&#x8F93;&#x51FA; 32  &#x4F4D;&#x4E2D;&#x95F4;&#x7ED3;&#x679C;&#xFF0C;&#x6700;&#x7EC8;&#x5C06;&#x5B83;&#x4EEC;&#x76F8;&#x52A0;&#x5E76;&#x91CD;&#x65B0;&#x91CF;&#x5316;&#x4E3A; 8 &#x4F4D;&#x6574;&#x6570;&#x3002;</p>
<p>&#x200B;	&#x7531;&#x4E8E;  ONNPACK &#x5BF9;&#x4E8E;&#x9762;&#x677F; A &#x548C; B &#x603B;&#x662F;&#x9002;&#x5E94; L1 &#x7F13;&#x5B58;&#x7684;&#x79FB;&#x52A8;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x8FDB;&#x884C;&#x4E86;&#x4F18;&#x5316;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x5728;&#x8C03;&#x7528;&#x5FAE;&#x5185;&#x6838;&#x65F6;&#x5904;&#x7406;&#x6574;&#x4E2A; A &#x548C; B  &#x7684;&#x9762;&#x677F;&#x3002;&#x800C;&#x7531;&#x4E8E;&#x65E0;&#x9700;&#x5728;&#x5FAE;&#x5185;&#x6838;&#x4E4B;&#x5916;&#x79EF;&#x7D2F; 32 &#x4F4D;&#x7684;&#x4E2D;&#x95F4;&#x7ED3;&#x679C;&#xFF0C;QNNPACK &#x4F1A;&#x5C06; 32 &#x4F4D;&#x7684;&#x4E2D;&#x95F4;&#x7ED3;&#x679C;&#x6574;&#x5408;&#x8FDB;&#x5FAE;&#x5185;&#x6838;&#x4E2D;&#x5E76;&#x5199;&#x51FA; 8  &#x4F4D;&#x503C;&#xFF0C;&#x8FD9;&#x8282;&#x7701;&#x4E86;&#x5185;&#x5B58;&#x5E26;&#x5BBD;&#x548C;&#x7F13;&#x5B58;&#x5360;&#x7528;&#x3002;</p>
<p><img src="./img/ch17/QNNPACK2.jpeg" alt=""></p>
<p>&#x4F7F;&#x6574;&#x4E2A; A&#x3001;B  &#x9762;&#x677F;&#x9002;&#x914D;&#x7F13;&#x5B58;&#x5E2E;&#x52A9;&#x5B9E;&#x73B0;&#x4E86; QNNPACK &#x4E2D;&#x7684;&#x53E6;&#x4E00;&#x4E2A;&#x4F18;&#x5316;&#xFF1A;&#x53D6;&#x6D88;&#x4E86;&#x77E9;&#x9635; A &#x7684;&#x91CD;&#x65B0;&#x6253;&#x5305;&#x3002;&#x77E9;&#x9635; B &#x5305;&#x542B;&#x9759;&#x6001;&#x6743;&#x91CD;&#xFF0C;&#x53EF;&#x4EE5;&#x4E00;&#x6B21;&#x6027;&#x8F6C;&#x6362;&#x6210;&#x4EFB;&#x4F55;&#x5185;&#x5B58;&#x5E03;&#x5C40;&#xFF0C;&#x4F46;&#x77E9;&#x9635;  A &#x5305;&#x542B;&#x5377;&#x79EF;&#x8F93;&#x5165;&#xFF0C;&#x6BCF;&#x6B21;&#x63A8;&#x7406;&#x8FD0;&#x884C;&#x90FD;&#x4F1A;&#x6539;&#x53D8;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x91CD;&#x65B0;&#x6253;&#x5305;&#x77E9;&#x9635; A &#x5728;&#x6BCF;&#x6B21;&#x8FD0;&#x884C;&#x65F6;&#x90FD;&#x4F1A;&#x4EA7;&#x751F;&#x5F00;&#x9500;&#x3002;&#x5C3D;&#x7BA1;&#x5B58;&#x5728;&#x5F00;&#x9500;&#xFF0C;&#x4F20;&#x7EDF;&#x7684; GEMM  &#x5B9E;&#x73B0;&#x8FD8;&#x662F;&#x51FA;&#x4E8E;&#x4EE5;&#x4E0B;&#x4E24;&#x4E2A;&#x539F;&#x56E0;&#x5BF9;&#x77E9;&#x9635; A &#x8FDB;&#x884C;&#x91CD;&#x65B0;&#x6253;&#x5305;&#xFF1A;&#x7F13;&#x5B58;&#x5173;&#x8054;&#x6027;&#x53CA;&#x5FAE;&#x5185;&#x6838;&#x6548;&#x7387;&#x53D7;&#x9650;&#x3002;&#x5982;&#x679C;&#x4E0D;&#x91CD;&#x65B0;&#x6253;&#x5305;&#xFF0C;&#x5FAE;&#x5185;&#x6838;&#x5C06;&#x4E0D;&#x5F97;&#x4E0D;&#x8BFB;&#x53D6;&#x88AB;&#x6F5C;&#x5728;&#x7684;&#x5927;&#x8DE8;&#x8DDD;&#x9694;&#x5F00;&#x7684;&#x51E0;&#x884C;  A&#x3002;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x8DE8;&#x8DDD;&#x6070;&#x597D;&#x662F; 2 &#x7684;&#x8BB8;&#x591A;&#x6B21;&#x5E42;&#x7684;&#x500D;&#x6570;&#xFF0C;&#x9762;&#x677F;&#x4E2D;&#x4E0D;&#x540C;&#x884C; A  &#x7684;&#x5143;&#x7D20;&#x53EF;&#x80FD;&#x4F1A;&#x843D;&#x5165;&#x540C;&#x4E00;&#x7F13;&#x5B58;&#x96C6;&#x4E2D;&#x3002;&#x5982;&#x679C;&#x51B2;&#x7A81;&#x7684;&#x884C;&#x6570;&#x8D85;&#x8FC7;&#x4E86;&#x7F13;&#x5B58;&#x5173;&#x8054;&#x6027;&#xFF0C;&#x5B83;&#x4EEC;&#x5C31;&#x4F1A;&#x76F8;&#x4E92;&#x9A71;&#x9010;&#xFF0C;&#x6027;&#x80FD;&#x4E5F;&#x4F1A;&#x5927;&#x5E45;&#x4E0B;&#x964D;&#x3002;&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x5F53;&#x9762;&#x677F;&#x9002;&#x914D;&#x4E00;&#x7EA7;&#x7F13;&#x5B58;&#x65F6;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#xFF0C;&#x5C31;&#x50CF;  QNNPACK &#x4F18;&#x5316;&#x7684;&#x6A21;&#x578B;&#x4E00;&#x6837;&#x3002;</p>
<p>&#x6253;&#x5305;&#x5BF9;&#x5FAE;&#x5185;&#x6838;&#x6548;&#x7387;&#x7684;&#x5F71;&#x54CD;&#x4E0E;&#x5F53;&#x524D;&#x6240;&#x6709;&#x79FB;&#x52A8;&#x5904;&#x7406;&#x5668;&#x652F;&#x6301;&#x7684;  SIMD  &#x5411;&#x91CF;&#x6307;&#x4EE4;&#x7684;&#x4F7F;&#x7528;&#x5BC6;&#x5207;&#x76F8;&#x5173;&#x3002;&#x8FD9;&#x4E9B;&#x6307;&#x4EE4;&#x52A0;&#x8F7D;&#x3001;&#x5B58;&#x50A8;&#x6216;&#x8005;&#x8BA1;&#x7B97;&#x5C0F;&#x578B;&#x7684;&#x56FA;&#x5B9A;&#x5927;&#x5C0F;&#x5143;&#x7D20;&#x5411;&#x91CF;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x5355;&#x4E2A;&#x6807;&#x91CF;&#xFF08;scalar&#xFF09;&#x3002;&#x5728;&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x4E2D;&#xFF0C;&#x5145;&#x5206;&#x5229;&#x7528;&#x5411;&#x91CF;&#x6307;&#x4EE4;&#x8FBE;&#x5230;&#x9AD8;&#x6027;&#x80FD;&#x5F88;&#x91CD;&#x8981;&#x3002;&#x5728;&#x4F20;&#x7EDF;&#x7684;  GEMM &#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;&#x5FAE;&#x5185;&#x6838;&#x628A; MR &#x5143;&#x7D20;&#x91CD;&#x65B0;&#x6253;&#x5305;&#x5230;&#x5411;&#x91CF;&#x6682;&#x5B58;&#x5668;&#x91CC;&#x7684; MR &#x7EBF;&#x8DEF;&#x4E2D;&#x3002;&#x5728; QNNPACK &#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;MR  &#x5143;&#x7D20;&#x5728;&#x5B58;&#x50A8;&#x4E2D;&#x4E0D;&#x662F;&#x8FDE;&#x7EED;&#x7684;&#xFF0C;&#x5FAE;&#x5185;&#x6838;&#x9700;&#x8981;&#x628A;&#x5B83;&#x4EEC;&#x52A0;&#x8F7D;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x5411;&#x91CF;&#x6682;&#x5B58;&#x5668;&#x4E2D;&#x3002;&#x8D8A;&#x6765;&#x8D8A;&#x5927;&#x7684;&#x6682;&#x5B58;&#x5668;&#x538B;&#x529B;&#x8FEB;&#x4F7F; QNNPACK &#x4F7F;&#x7528;&#x8F83;&#x5C0F;&#x7684; MRxNR  &#x62FC;&#x8D34;&#xFF0C;&#x4F46;&#x5B9E;&#x9645;&#x4E0A;&#x8FD9;&#x79CD;&#x5DEE;&#x5F02;&#x5F88;&#x5C0F;&#xFF0C;&#x800C;&#x4E14;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x6D88;&#x9664;&#x6253;&#x5305;&#x5F00;&#x9500;&#x6765;&#x8865;&#x507F;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5728; 32 &#x4F4D; ARM &#x67B6;&#x6784;&#x4E0A;&#xFF0C;QNNPACK &#x4F7F;&#x7528; 4&#xD7;8 &#x5FAE;&#x5185;&#x6838;&#xFF0C;&#x5176;&#x4E2D;  57% &#x7684;&#x5411;&#x91CF;&#x6307;&#x4EE4;&#x662F;&#x4E58;-&#x52A0;&#xFF1B;&#x53E6;&#x4E00;&#x65B9;&#x9762;&#xFF0C;gemmlowp &#x5E93;&#x4F7F;&#x7528;&#x6548;&#x7387;&#x7A0D;&#x9AD8;&#x7684; 4&#xD7;12 &#x5FAE;&#x5185;&#x6838;&#xFF0C;&#x5176;&#x4E2D; 60% &#x7684;&#x5411;&#x91CF;&#x6307;&#x4EE4;&#x662F;&#x4E58;-&#x52A0;&#x3002;</p>
<p>&#x5FAE;&#x5185;&#x6838;&#x52A0;&#x8F7D; A  &#x7684;&#x591A;&#x4E2A;&#x884C;&#xFF0C;&#x4E58;&#x4EE5; B &#x7684;&#x6EE1;&#x5217;&#xFF0C;&#x7ED3;&#x679C;&#x76F8;&#x52A0;&#xFF0C;&#x7136;&#x540E;&#x5B8C;&#x6210;&#x518D;&#x91CF;&#x5316;&#x5E76;&#x8BB0;&#x4E0B;&#x91CF;&#x5316;&#x548C;&#x3002;A &#x548C; B &#x7684;&#x5143;&#x7D20;&#x88AB;&#x91CF;&#x5316;&#x4E3A; 8 &#x4F4D;&#x6574;&#x6570;&#xFF0C;&#x4F46;&#x4E58;&#x79EF;&#x7ED3;&#x679C;&#x76F8;&#x52A0;&#x5230; 32 &#x4F4D;&#x3002;&#x5927;&#x90E8;&#x5206;  ARM &#x548C; ARM64 &#x5904;&#x7406;&#x5668;&#x6CA1;&#x6709;&#x76F4;&#x63A5;&#x5B8C;&#x6210;&#x8FD9;&#x4E00;&#x8FD0;&#x7B97;&#x7684;&#x6307;&#x4EE4;&#xFF0C;&#x6240;&#x4EE5;&#x5B83;&#x5FC5;&#x987B;&#x5206;&#x89E3;&#x4E3A;&#x591A;&#x4E2A;&#x652F;&#x6301;&#x8FD0;&#x7B97;&#x3002;QNNPACK  &#x63D0;&#x4F9B;&#x5FAE;&#x5185;&#x6838;&#x7684;&#x4E24;&#x4E2A;&#x7248;&#x672C;&#xFF0C;&#x5176;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#x7528;&#x4E8E;&#x4E58;&#x4EE5; 8 &#x4F4D;&#x503C;&#x5E76;&#x5C06;&#x5B83;&#x4EEC;&#x7D2F;&#x52A0;&#x5230; 32 &#x4F4D;&#x7684;&#x6307;&#x4EE4;&#x5E8F;&#x5217;&#x3002;</p>
<p>2)<strong>&#x4ECE;&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x5230;&#x5377;&#x79EF;</strong></p>
<p><img src="./img/ch17/QNNPACK3.jpeg" alt=""></p>
<p>&#x7B80;&#x5355;&#x7684; 1&#xD7;1  &#x5377;&#x79EF;&#x53EF;&#x76F4;&#x63A5;&#x6620;&#x5C04;&#x5230;&#x77E9;&#x9635;&#x76F8;&#x4E58;&#xFF0C;&#x4F46;&#x5BF9;&#x4E8E;&#x5177;&#x5907;&#x8F83;&#x5927;&#x5377;&#x79EF;&#x6838;&#x3001;padding &#x6216;&#x5B50;&#x91C7;&#x6837;&#xFF08;&#x6B65;&#x5E45;&#xFF09;&#x7684;&#x5377;&#x79EF;&#x800C;&#x8A00;&#x5219;&#x5E76;&#x975E;&#x5982;&#x6B64;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x8FD9;&#x4E9B;&#x8F83;&#x590D;&#x6742;&#x7684;&#x5377;&#x79EF;&#x80FD;&#x591F;&#x901A;&#x8FC7;&#x8BB0;&#x5FC6;&#x53D8;&#x6362;  im2col &#x6620;&#x5C04;&#x5230;&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x3002;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x8F93;&#x51FA;&#x50CF;&#x7D20;&#xFF0C;im2col &#x590D;&#x5236;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x7684;&#x56FE;&#x50CF;&#x5757;&#x5E76;&#x5C06;&#x5176;&#x8BA1;&#x7B97;&#x4E3A; 2D &#x77E9;&#x9635;&#x3002;&#x7531;&#x4E8E;&#x6BCF;&#x4E2A;&#x8F93;&#x51FA;&#x50CF;&#x7D20;&#x90FD;&#x53D7; KHxKWxC  &#x8F93;&#x5165;&#x50CF;&#x7D20;&#x503C;&#x7684;&#x5F71;&#x54CD;&#xFF08;KH &#x548C; KW &#x5206;&#x522B;&#x6307;&#x5377;&#x79EF;&#x6838;&#x7684;&#x9AD8;&#x5EA6;&#x548C;&#x5BBD;&#x5EA6;&#xFF0C;C &#x6307;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x4E2D;&#x7684;&#x901A;&#x9053;&#x6570;&#xFF09;&#xFF0C;&#x56E0;&#x6B64;&#x8BE5;&#x77E9;&#x9635;&#x7684;&#x5927;&#x5C0F;&#x662F;&#x8F93;&#x5165;&#x56FE;&#x50CF;&#x7684; KHxKW  &#x500D;&#xFF0C;im2col &#x7ED9;&#x5185;&#x5B58;&#x5360;&#x7528;&#x548C;&#x6027;&#x80FD;&#x90FD;&#x5E26;&#x6765;&#x4E86;&#x4E00;&#x5B9A;&#x7684;&#x5F00;&#x9500;&#x3002;&#x548C; Caffe &#x4E00;&#x6837;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6846;&#x67B6;&#x8F6C;&#x800C;&#x4F7F;&#x7528;&#x57FA;&#x4E8E; im2col  &#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x5229;&#x7528;&#x73B0;&#x6709;&#x7684;&#x9AD8;&#x5EA6;&#x4F18;&#x5316;&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x5E93;&#x6765;&#x6267;&#x884C;&#x5377;&#x79EF;&#x64CD;&#x4F5C;&#x3002;</p>
<p>Facebook  &#x7814;&#x7A76;&#x8005;&#x5728; QNNPACK &#x4E2D;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x79CD;&#x66F4;&#x9AD8;&#x6548;&#x7684;&#x7B97;&#x6CD5;&#x3002;&#x4ED6;&#x4EEC;&#x6CA1;&#x6709;&#x53D8;&#x6362;&#x5377;&#x79EF;&#x8F93;&#x5165;&#x4F7F;&#x5176;&#x9002;&#x5E94;&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x800C;&#x662F;&#x8C03;&#x6574; PDOT &#x5FAE;&#x5185;&#x6838;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x5728;&#x8FD0;&#x884C;&#x4E2D;&#x6267;&#x884C;  im2col &#x53D8;&#x6362;&#x3002;&#x8FD9;&#x6837;&#x5C31;&#x65E0;&#x9700;&#x5C06;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x7684;&#x5B9E;&#x9645;&#x8F93;&#x5165;&#x590D;&#x5236;&#x5230; im2col &#x7F13;&#x5B58;&#xFF0C;&#x800C;&#x662F;&#x4F7F;&#x7528;&#x8F93;&#x5165;&#x50CF;&#x7D20;&#x884C;&#x7684;&#x6307;&#x9488;&#x8BBE;&#x7F6E; indirection  buffer&#xFF0C;&#x8F93;&#x5165;&#x50CF;&#x7D20;&#x4E0E;&#x6BCF;&#x4E2A;&#x8F93;&#x51FA;&#x50CF;&#x7D20;&#x7684;&#x8BA1;&#x7B97;&#x6709;&#x5173;&#x3002;&#x7814;&#x7A76;&#x8005;&#x8FD8;&#x4FEE;&#x6539;&#x4E86;&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x5FAE;&#x5185;&#x6838;&#xFF0C;&#x4EE5;&#x4FBF;&#x4ECE; indirection buffer  &#x52A0;&#x8F7D;&#x865A;&#x6784;&#x77E9;&#x9635;&#xFF08;imaginary matrix&#xFF09;A &#x7684;&#x884C;&#x6307;&#x9488;&#xFF0C;indirection buffer &#x901A;&#x5E38;&#x6BD4; im2col buffer  &#x5C0F;&#x5F97;&#x591A;&#x3002;&#x6B64;&#x5916;&#xFF0C;&#x5982;&#x679C;&#x4E24;&#x6B21;&#x63A8;&#x65AD;&#x8FD0;&#x884C;&#x7684;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x5B58;&#x50A8;&#x4F4D;&#x7F6E;&#x4E0D;&#x53D8;&#xFF0C;&#x5219; indirection buffer  &#x8FD8;&#x53EF;&#x4F7F;&#x7528;&#x8F93;&#x5165;&#x5F20;&#x91CF;&#x884C;&#x7684;&#x6307;&#x9488;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x591A;&#x6B21;&#x63A8;&#x65AD;&#x8FD0;&#x884C;&#x4E2D;&#x91CD;&#x65B0;&#x4F7F;&#x7528;&#x3002;&#x7814;&#x7A76;&#x8005;&#x89C2;&#x5BDF;&#x5230;&#x5177;&#x5907; indirection buffer &#x7684;&#x5FAE;&#x5185;&#x6838;&#x4E0D;&#x4EC5;&#x6D88;&#x9664;&#x4E86;  im2col &#x53D8;&#x6362;&#x7684;&#x5F00;&#x9500;&#xFF0C;&#x5176;&#x6027;&#x80FD;&#x4E5F;&#x6BD4;&#x77E9;&#x9635;&#x76F8;&#x4E58;&#x5FAE;&#x5185;&#x6838;&#x7565;&#x597D;&#xFF08;&#x53EF;&#x80FD;&#x7531;&#x4E8E;&#x8F93;&#x5165;&#x884C;&#x5728;&#x8BA1;&#x7B97;&#x4E0D;&#x540C;&#x8F93;&#x51FA;&#x50CF;&#x7D20;&#x65F6;&#x88AB;&#x91CD;&#x7528;&#xFF09;&#x3002;</p>
<p>3)<strong>&#x6DF1;&#x5EA6;&#x5377;&#x79EF;</strong></p>
<p><img src="./img/ch17/QNNPACK4.jpeg" alt=""></p>
<p>&#x5206;&#x7EC4;&#x5377;&#x79EF;&#xFF08;grouped   convolution&#xFF09;&#x5C06;&#x8F93;&#x5165;&#x548C;&#x8F93;&#x51FA;&#x901A;&#x9053;&#x5206;&#x5272;&#x6210;&#x591A;&#x7EC4;&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x6BCF;&#x4E2A;&#x7EC4;&#x8FDB;&#x884C;&#x5206;&#x522B;&#x5904;&#x7406;&#x3002;&#x5728;&#x6709;&#x9650;&#x6761;&#x4EF6;&#x4E0B;&#xFF0C;&#x5F53;&#x7EC4;&#x6570;&#x7B49;&#x4E8E;&#x901A;&#x9053;&#x6570;&#x65F6;&#xFF0C;&#x8BE5;&#x5377;&#x79EF;&#x5C31;&#x662F;&#x6DF1;&#x5EA6;&#x5377;&#x79EF;&#xFF0C;&#x5E38;&#x7528;&#x4E8E;&#x5F53;&#x524D;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x67B6;&#x6784;&#x4E2D;&#x3002;&#x6DF1;&#x5EA6;&#x5377;&#x79EF;&#x5BF9;&#x6BCF;&#x4E2A;&#x901A;&#x9053;&#x5206;&#x522B;&#x6267;&#x884C;&#x7A7A;&#x95F4;&#x6EE4;&#x6CE2;&#xFF0C;&#x5C55;&#x793A;&#x4E86;&#x4E0E;&#x6B63;&#x5E38;&#x5377;&#x79EF;&#x975E;&#x5E38;&#x4E0D;&#x540C;&#x7684;&#x8BA1;&#x7B97;&#x6A21;&#x5F0F;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x901A;&#x5E38;&#x8981;&#x5411;&#x6DF1;&#x5EA6;&#x5377;&#x79EF;&#x63D0;&#x4F9B;&#x5355;&#x72EC;&#x5B9E;&#x73B0;&#xFF0C;QNNPACK  &#x5305;&#x62EC;&#x4E00;&#x4E2A;&#x9AD8;&#x5EA6;&#x4F18;&#x5316;&#x7248;&#x672C; 3&#xD7;3 &#x6DF1;&#x5EA6;&#x5377;&#x79EF;&#x3002;</p>
<p>&#x6DF1;&#x5EA6;&#x5377;&#x79EF;&#x7684;&#x4F20;&#x7EDF;&#x5B9E;&#x73B0;&#x662F;&#x6BCF;&#x6B21;&#x90FD;&#x5728;&#x5377;&#x79EF;&#x6838;&#x5143;&#x7D20;&#x4E0A;&#x8FED;&#x4EE3;&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x4E00;&#x4E2A;&#x5377;&#x79EF;&#x6838;&#x884C;&#x548C;&#x4E00;&#x4E2A;&#x8F93;&#x5165;&#x884C;&#x7684;&#x7ED3;&#x679C;&#x7D2F;&#x52A0;&#x5230;&#x8F93;&#x51FA;&#x884C;&#x3002;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;  3&#xD7;3 &#x7684;&#x6DF1;&#x5EA6;&#x5377;&#x79EF;&#xFF0C;&#x6B64;&#x7C7B;&#x5B9E;&#x73B0;&#x5C06;&#x628A;&#x6BCF;&#x4E2A;&#x8F93;&#x51FA;&#x884C;&#x66F4;&#x65B0; 9 &#x6B21;&#x3002;&#x5728; QNNPACK &#x4E2D;&#xFF0C;&#x7814;&#x7A76;&#x8005;&#x8BA1;&#x7B97;&#x6240;&#x6709; 3&#xD7;3 &#x5377;&#x79EF;&#x6838;&#x884C;&#x548C; 3&#xD7;3  &#x8F93;&#x5165;&#x884C;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x4E00;&#x6B21;&#x6027;&#x7D2F;&#x52A0;&#x5230;&#x8F93;&#x51FA;&#x884C;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5904;&#x7406;&#x4E0B;&#x4E2A;&#x8F93;&#x51FA;&#x884C;&#x3002;</p>
<p>QNNPACK  &#x5B9E;&#x73B0;&#x9AD8;&#x6027;&#x80FD;&#x7684;&#x5173;&#x952E;&#x56E0;&#x7D20;&#x5728;&#x4E8E;&#x5B8C;&#x7F8E;&#x5229;&#x7528;&#x901A;&#x7528;&#x6682;&#x5B58;&#x5668;&#xFF08;GPR&#xFF09;&#x6765;&#x5C55;&#x5F00;&#x5377;&#x79EF;&#x6838;&#x5143;&#x7D20;&#x4E0A;&#x7684;&#x5FAA;&#x73AF;&#xFF0C;&#x540C;&#x65F6;&#x907F;&#x514D;&#x5728; hot loop &#x4E2D;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x5730;&#x5740;&#x5BC4;&#x5B58;&#x5668;&#x3002;32-bit  ARM &#x67B6;&#x6784;&#x5C06;&#x5B9E;&#x73B0;&#x9650;&#x5236;&#x5728; 14 &#x4E2A; GPR&#x3002;&#x5728; 3&#xD7;3 &#x6DF1;&#x5EA6;&#x5377;&#x79EF;&#x4E2D;&#xFF0C;&#x9700;&#x8981;&#x8BFB;&#x53D6; 9 &#x4E2A;&#x8F93;&#x5165;&#x884C;&#x548C; 9 &#x4E2A;&#x5377;&#x79EF;&#x6838;&#x884C;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x5982;&#x679C;&#x60F3;&#x5B8C;&#x5168;&#x5C55;&#x5F00;&#x5FAA;&#x73AF;&#x5FC5;&#x987B;&#x5B58;&#x50A8;  18 &#x4E2A;&#x5730;&#x5740;&#x3002;&#x7136;&#x800C;&#xFF0C;&#x5B9E;&#x8DF5;&#x4E2D;&#x63A8;&#x65AD;&#x65F6;&#x5377;&#x79EF;&#x6838;&#x4E0D;&#x4F1A;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x3002;&#x56E0;&#x6B64; Facebook &#x7814;&#x7A76;&#x8005;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#x5728; CxKHxKW &#x4E2D;&#x7684;&#x6EE4;&#x6CE2;&#x5668;&#xFF0C;&#x5C06;&#x5B83;&#x4EEC;&#x5C01;&#x88C5;&#x8FDB;  [C/8]xKWxKHx8&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x4EC5;&#x4F7F;&#x7528;&#x5177;&#x5907;&#x5730;&#x5740;&#x589E;&#x91CF;&#xFF08;address increment&#xFF09;&#x7684;&#x4E00;&#x4E2A; GPR &#x8BBF;&#x95EE;&#x6240;&#x6709;&#x6EE4;&#x6CE2;&#x5668;&#x3002;&#xFF08;&#x7814;&#x7A76;&#x8005;&#x4F7F;&#x7528;&#x6570;&#x5B57; 8  &#x7684;&#x539F;&#x56E0;&#x5728;&#x4E8E;&#xFF0C;&#x5728;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&#x4E2D;&#x52A0;&#x8F7D; 8 &#x4E2A;&#x5143;&#x7D20;&#x7136;&#x540E;&#x51CF;&#x53BB;&#x96F6;&#xFF0C;&#x5728; 128-bit NEON &#x6682;&#x5B58;&#x5668;&#x4E2D;&#x751F;&#x6210; 8 &#x4E2A; 16-bit &#x503C;&#x3002;&#xFF09;&#x7136;&#x540E;&#x4F7F;&#x7528; 9  &#x4E2A;&#x8F93;&#x5165;&#x884C;&#x6307;&#x9488;&#xFF0C;&#x6307;&#x9488;&#x5C06;&#x6EE4;&#x6CE2;&#x5668;&#x91CD;&#x65B0;&#x88C5;&#x8FDB; 10 &#x4E2A; GPR&#xFF0C;&#x5B8C;&#x5168;&#x5C55;&#x5F00;&#x6EE4;&#x6CE2;&#x5668;&#x5143;&#x7D20;&#x4E0A;&#x7684;&#x5FAA;&#x73AF;&#x3002;64-bit ARM &#x67B6;&#x6784;&#x76F8;&#x6BD4; 32-bit &#x67B6;&#x6784;&#xFF0C;GPR  &#x7684;&#x6570;&#x91CF;&#x7FFB;&#x4E86;&#x4E00;&#x500D;&#x3002;QNNPACK &#x5229;&#x7528;&#x989D;&#x5916;&#x7684; ARM64 GPR&#xFF0C;&#x4E00;&#x6B21;&#x6027;&#x5B58;&#x50A8; 3&#xD7;5 &#x8F93;&#x5165;&#x884C;&#x7684;&#x6307;&#x9488;&#xFF0C;&#x5E76;&#x8BA1;&#x7B97; 3 &#x4E2A;&#x8F93;&#x51FA;&#x884C;&#x3002;</p>
<p>7&#x3001;&#x6027;&#x80FD;&#x4F18;&#x52BF;&#xFF1A;</p>
<p>&#x200B;	&#x6D4B;&#x8BD5;&#x7ED3;&#x679C;&#x663E;&#x793A;&#x51FA; QNNPACK &#x5728;&#x7AEF;&#x5230;&#x7AEF;&#x57FA;&#x51C6;&#x4E0A;&#x7684;&#x6027;&#x80FD;&#x4F18;&#x52BF;&#x3002;&#x5728;&#x91CF;&#x5316;&#x5F53;&#x524D;&#x6700;&#x4F18; MobileNetV2 &#x67B6;&#x6784;&#x4E0A;&#xFF0C;&#x57FA;&#x4E8E;QNNPACK &#x7684; Caffe2 &#x7B97;&#x5B50;&#x7684;&#x901F;&#x5EA6;&#x5927;&#x7EA6;&#x662F; TensorFlow Lite &#x901F;&#x5EA6;&#x7684; 2 &#x500D;&#xFF0C;&#x5728;&#x591A;&#x79CD;&#x624B;&#x673A;&#x4E0A;&#x90FD;&#x662F;&#x5982;&#x6B64;&#x3002;&#x9664;&#x4E86; QNNPACK &#x4E4B;&#x5916;&#xFF0C;Facebook &#x8FD8;&#x5F00;&#x6E90;&#x4E86; Caffe2 quantized MobileNet v2 &#x6A21;&#x578B;&#xFF0C;&#x5176; top-1 &#x51C6;&#x786E;&#x7387;&#x6BD4;&#x76F8;&#x5E94;&#x7684; TensorFlow &#x6A21;&#x578B;&#x9AD8;&#x51FA; 1.3%&#x3002;</p>
<p><strong>MobileNetV1</strong></p>
<p>MobileNetV1  &#x67B6;&#x6784;&#x5728;&#x4F7F;&#x7528;&#x6DF1;&#x5EA6;&#x5377;&#x79EF;&#xFF08;depthwise convolution&#xFF09;&#x4F7F;&#x6A21;&#x578B;&#x66F4;&#x9002;&#x5408;&#x79FB;&#x52A8;&#x8BBE;&#x5907;&#x65B9;&#x9762;&#x5177;&#x5907;&#x5F00;&#x521B;&#x6027;&#x3002;MobileNetV1 &#x5305;&#x62EC;&#x51E0;&#x4E4E;&#x6574;&#x4E2A;  1&#xD7;1 &#x5377;&#x79EF;&#x548C; 3&#xD7;3 &#x5377;&#x79EF;&#x3002;Facebook &#x7814;&#x7A76;&#x8005;&#x5C06;&#x91CF;&#x5316; MobileNetV1 &#x6A21;&#x578B;&#x4ECE; TensorFlow Lite &#x8F6C;&#x6362;&#x800C;&#x6765;&#xFF0C;&#x5E76;&#x5728;  TensorFlow Lite &#x548C; QNNPACK &#x7684; 32-bit ARM &#x8BBE;&#x5907;&#x4E0A;&#x5BF9; MobileNetV1 &#x8FDB;&#x884C;&#x57FA;&#x51C6;&#x6D4B;&#x8BD5;&#x3002;&#x4E8C;&#x8005;&#x8FD0;&#x884C;&#x65F6;&#x5747;&#x4F7F;&#x7528; 4  &#x7EBF;&#x7A0B;&#xFF0C;&#x7814;&#x7A76;&#x8005;&#x89C2;&#x5BDF;&#x5230; QNNPACK &#x7684;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#x51E0;&#x4F55;&#x5E73;&#x5747;&#x503C;&#x662F; TensorFlow Lite &#x7684; 1.8 &#x500D;&#x3002;</p>
<p><img src="./img/ch17/mv1.jpg" alt=""></p>
<p><strong>MobileNetV2</strong></p>
<p>&#x4F5C;&#x4E3A;&#x79FB;&#x52A8;&#x89C6;&#x89C9;&#x4EFB;&#x52A1;&#x7684;&#x5F53;&#x524D;&#x6700;&#x4F18;&#x67B6;&#x6784;&#x4E4B;&#x4E00;&#xFF0C;MobileNetV2  &#x5F15;&#x5165;&#x4E86;&#x74F6;&#x9888;&#x6784;&#x9020;&#x5757;&#x548C;&#x74F6;&#x9888;&#x4E4B;&#x95F4;&#x7684;&#x6377;&#x5F84;&#x8FDE;&#x63A5;&#x3002;&#x7814;&#x7A76;&#x8005;&#x5728; MobileNetV2 &#x5206;&#x7C7B;&#x6A21;&#x578B;&#x7684;&#x91CF;&#x5316;&#x7248;&#x4E0A;&#x5BF9;&#x6BD4;&#x57FA;&#x4E8E; QNNPACK &#x7684; Caffe2 &#x7B97;&#x5B50;&#x548C;  TensorFlow Lite &#x5B9E;&#x73B0;&#x3002;&#x4F7F;&#x7528;&#x7684;&#x91CF;&#x5316; Caffe2 MobileNetV2 &#x6A21;&#x578B;&#x5DF2;&#x5F00;&#x6E90;&#xFF0C;&#x91CF;&#x5316; TensorFlow Lite  &#x6A21;&#x578B;&#x6765;&#x81EA;&#x5B98;&#x65B9;&#x5E93;&#xFF1A;<a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/g3doc/models.md%E3%80%82%E4%B8%8B%E8%A1%A8%E5%B1%95%E7%A4%BA%E4%BA%86%E4%BA%8C%E8%80%85%E5%9C%A8%E5%B8%B8%E7%94%A8%E6%B5%8B%E8%AF%95%E9%9B%86%E4%B8%8A%E7%9A%84">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/lite/g3doc/models.md&#x3002;&#x4E0B;&#x8868;&#x5C55;&#x793A;&#x4E86;&#x4E8C;&#x8005;&#x5728;&#x5E38;&#x7528;&#x6D4B;&#x8BD5;&#x96C6;&#x4E0A;&#x7684;</a>  top1 &#x51C6;&#x786E;&#x7387;&#xFF1A;</p>
<p><img src="./img/ch17/mv2.jpg" alt=""></p>
<p>&#x200B;	Facebook &#x7814;&#x7A76;&#x8005;&#x5229;&#x7528;&#x8FD9;&#x4E9B;&#x6A21;&#x578B;&#x5EFA;&#x7ACB;&#x4E86; Facebook AI &#x6027;&#x80FD;&#x8BC4;&#x4F30;&#x5E73;&#x53F0;&#xFF08;<a href="https://github.com/facebook/FAI-PEP%EF%BC%89%E7%9A%84%E5%9F%BA%E5%87%86%EF%BC%8C%E8%AF%A5%E5%9F%BA%E5%87%86%E5%9F%BA%E4%BA%8E">https://github.com/facebook/FAI-PEP&#xFF09;&#x7684;&#x57FA;&#x51C6;&#xFF0C;&#x8BE5;&#x57FA;&#x51C6;&#x57FA;&#x4E8E;</a> 32-bit ARM &#x73AF;&#x5883;&#x7684;&#x5927;&#x91CF;&#x624B;&#x673A;&#x8BBE;&#x5907;&#x3002;&#x5BF9;&#x4E8E; TensorFlow Lite &#x7EBF;&#x7A0B;&#x8BBE;&#x7F6E;&#xFF0C;&#x7814;&#x7A76;&#x8005;&#x5C1D;&#x8BD5;&#x4E86;&#x4E00;&#x5230;&#x56DB;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x62A5;&#x544A;&#x4E86;&#x6700;&#x5FEB;&#x901F;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x7ED3;&#x679C;&#x663E;&#x793A; TensorFlow Lite &#x4F7F;&#x7528;&#x56DB;&#x7EBF;&#x7A0B;&#x7684;&#x6027;&#x80FD;&#x6700;&#x4F18;&#xFF0C;&#x56E0;&#x6B64;&#x540E;&#x7EED;&#x7814;&#x7A76;&#x4E2D;&#x4F7F;&#x7528;&#x56DB;&#x7EBF;&#x7A0B;&#x6765;&#x5BF9;&#x6BD4; TensorFlow Lite &#x548C; QNNPACK&#x3002;&#x4E0B;&#x8868;&#x5C55;&#x793A;&#x4E86;&#x7ED3;&#x679C;&#xFF0C;&#x4EE5;&#x53CA;&#x5728;&#x5178;&#x578B;&#x667A;&#x80FD;&#x624B;&#x673A;&#x548C;&#x9AD8;&#x7AEF;&#x673A;&#x4E0A;&#xFF0C;&#x57FA;&#x4E8E; QNNPACK &#x7684;&#x7B97;&#x5B50;&#x901F;&#x5EA6;&#x6BD4; TensorFlow Lite &#x5FEB;&#x5F97;&#x591A;&#x3002;</p>
<p><img src="./img/ch17/mv3.jpg" alt=""></p>
<p>Facebook&#x5F00;&#x6E90;&#x9AD8;&#x6027;&#x80FD;&#x5185;&#x6838;&#x5E93;QNNPACK<br>
<a href="https://baijiahao.baidu.com/s?id=1615725346726413945&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1615725346726413945&amp;wfr=spider&amp;for=pc</a><br>
<a href="http://www.sohu.com/a/272158070_610300">http://www.sohu.com/a/272158070_610300</a></p>
<p>&#x652F;&#x6301;&#x79FB;&#x52A8;&#x7AEF;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x7684;&#x51E0;&#x79CD;&#x5F00;&#x6E90;&#x6846;&#x67B6;<br>
<a href="https://blog.csdn.net/zchang81/article/details/74280019">https://blog.csdn.net/zchang81/article/details/74280019</a></p>
<h3 class="mume-header" id="1773-prestissimo">17.7.3 Prestissimo</h3>

<p>&#xFF11;&#x3001;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#xFF1A;2017&#x5E74;11&#x6708;</p>
<p>&#xFF12;&#x3001;&#x5F00;&#x6E90;&#x7528;&#x6237;&#xFF1A;&#x4E5D;&#x8A00;&#x79D1;&#x6280;</p>
<p>&#xFF13;&#x3001;GitHub&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/in66-dev/In-Prestissimo">https://github.com/in66-dev/In-Prestissimo</a></p>
<p>&#xFF14;&#x3001;&#x529F;&#x80FD;&#x7279;&#x70B9;&#xFF1A;</p>
<p><strong>&#x57FA;&#x7840;&#x529F;&#x80FD;</strong></p>
<ul>
<li>&#x652F;&#x6301;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x652F;&#x6301;&#x591A;&#x8F93;&#x5165;&#x548C;&#x591A;&#x5206;&#x652F;&#x7ED3;&#x6784;</li>
<li>&#x7CBE;&#x70BC;&#x7B80;&#x6D01;&#x7684;API&#x8BBE;&#x8BA1;&#xFF0C;&#x4F7F;&#x7528;&#x65B9;&#x4FBF;</li>
<li>&#x63D0;&#x4F9B;&#x8C03;&#x8BD5;&#x63A5;&#x53E3;&#xFF0C;&#x652F;&#x6301;&#x6253;&#x5370;&#x5404;&#x4E2A;&#x5C42;&#x7684;&#x6570;&#x636E;&#x4EE5;&#x53CA;&#x8017;&#x65F6;</li>
<li>&#x4E0D;&#x4F9D;&#x8D56;&#x4EFB;&#x4F55;&#x7B2C;&#x4E09;&#x65B9;&#x8BA1;&#x7B97;&#x6846;&#x67B6;&#xFF0C;&#x6574;&#x4F53;&#x5E93;&#x4F53;&#x79EF; 500K &#x5DE6;&#x53F3;&#xFF08;32&#x4F4D; &#x7EA6;400k&#xFF0C;64&#x4F4D; &#x7EA6;600k&#xFF09;</li>
<li>&#x7EAF; C++ &#x5B9E;&#x73B0;&#xFF0C;&#x8DE8;&#x5E73;&#x53F0;&#xFF0C;&#x652F;&#x6301; android &#x548C; ios</li>
<li>&#x6A21;&#x578B;&#x4E3A;&#x7EAF;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#xFF0C;&#x4E0D;&#x66B4;&#x9732;&#x5F00;&#x53D1;&#x8005;&#x8BBE;&#x8BA1;&#x7684;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;</li>
</ul>
<p><strong>&#x6781;&#x5FEB;&#x7684;&#x901F;&#x5EA6;</strong></p>
<ul>
<li>&#x5927;&#x5230;&#x6846;&#x67B6;&#x8BBE;&#x8BA1;&#xFF0C;&#x5C0F;&#x5230;&#x6C47;&#x7F16;&#x4E66;&#x5199;&#x4E0A;&#x5168;&#x65B9;&#x4F4D;&#x7684;&#x4F18;&#x5316;&#xFF0C;iphone7 &#x4E0A;&#x8DD1; SqueezeNet &#x4EC5;&#x9700; 26ms&#xFF08;&#x5355;&#x7EBF;&#x7A0B;&#xFF09;</li>
<li>&#x652F;&#x6301;&#x6D6E;&#x70B9;(float)&#x548C;&#x6574;&#x578B;(int)&#x4E24;&#x79CD;&#x8FD0;&#x7B97;&#x6A21;&#x5F0F;&#xFF0C;float&#x6A21;&#x5F0F;&#x7CBE;&#x5EA6;&#x4E0E;caffe&#x76F8;&#x540C;&#xFF0C;int&#x6A21;&#x5F0F;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#x5FEB;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x7F51;&#x7EDC;&#x7528;int&#x7684;&#x7CBE;&#x5EA6;&#x4FBF;&#x5DF2;&#x7ECF;&#x8DB3;&#x591F;</li>
<li>&#x4EE5;&#x5DE7;&#x5999;&#x7684;&#x5185;&#x5B58;&#x5E03;&#x5C40;&#x63D0;&#x5347;cpu&#x7684;cache&#x547D;&#x4E2D;&#x7387;&#xFF0C;&#x5728;&#x4E2D;&#x4F4E;&#x7AEF;&#x673A;&#x578B;&#x4E0A;&#x6027;&#x80FD;&#x4F9D;&#x7136;&#x5F3A;&#x52B2;</li>
<li>&#x9488;&#x5BF9; float-arm32, float-arm64, int-arm32, int-arm64 &#x56DB;&#x4E2A;&#x5206;&#x652F;&#x5747;&#x505A;&#x4E86;&#x7EC6;&#x81F4;&#x7684;&#x4F18;&#x5316;&#xFF0C;&#x4FDD;&#x8BC1;arm32&#x4F4D;&#x548C;arm64&#x4F4D;&#x7248;&#x672C;&#x90FD;&#x6709;&#x975E;&#x5E38;&#x597D;&#x7684;&#x6027;&#x80FD;</li>
</ul>
<p><strong>SqueezeNet-v1.1 &#x6D4B;&#x8BD5;&#x7ED3;&#x679C;</strong></p>
<p><strong>Note</strong>: &#x624B;&#x673A;&#x6D4B;&#x8BD5;&#x6027;&#x80FD;&#x5B58;&#x5728;&#x4E00;&#x5B9A;&#x7684;&#x6296;&#x52A8;&#xFF0C;&#x8FDE;&#x7EED;&#x591A;&#x6B21;&#x8FD0;&#x7B97;&#x53D6;&#x5E73;&#x5747;&#x65F6;&#x95F4;</p>
<p><strong>Note</strong>: &#x50CF;&#x534E;&#x4E3A;mate8, mate9&#xFF0C;Google nexus 6 &#x867D;&#x7136;&#x662F;64&#x4F4D;&#x7684;CPU&#xFF0C;&#x4F46;&#x6D4B;&#x8BD5;&#x7528;&#x7684;&#x662F; 32&#x4F4D;&#x7684;&#x5E93;&#xFF0C;&#x56E0;&#x6B64;cpu&#x67B6;&#x6784;&#x4F9D;&#x7136;&#x5199; arm-v7a</p>
<table>
<thead>
<tr>
<th style="text-align:center">CPU&#x67B6;&#x6784;</th>
<th style="text-align:center">&#x673A;&#x578B;</th>
<th style="text-align:center">CPU</th>
<th style="text-align:center">ncnn&#xFF08;4&#x7EBF;&#x7A0B;&#xFF09;</th>
<th style="text-align:center">mdl</th>
<th style="text-align:center">Prestissimo_float(&#x5355;&#x7EBF;&#x7A0B;)</th>
<th style="text-align:center">Prestissimo_int(&#x5355;&#x7EBF;&#x7A0B;)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">arm-v7a</td>
<td style="text-align:center">&#x5C0F;&#x7C73;2</td>
<td style="text-align:center">&#x9AD8;&#x901A;APQ8064 1.5GHz</td>
<td style="text-align:center">185 ms</td>
<td style="text-align:center">370 ms</td>
<td style="text-align:center">184 ms</td>
<td style="text-align:center">115 ms</td>
</tr>
<tr>
<td style="text-align:center">arm-v7a</td>
<td style="text-align:center">&#x5C0F;&#x7C73;2s</td>
<td style="text-align:center">&#x56DB;&#x6838; &#x9A81;&#x9F99;APQ8064 Pro 1.7GHz</td>
<td style="text-align:center">166 ms</td>
<td style="text-align:center">-</td>
<td style="text-align:center">136 ms</td>
<td style="text-align:center">96 ms</td>
</tr>
<tr>
<td style="text-align:center">arm-v7a</td>
<td style="text-align:center">&#x7EA2;&#x7C73;Note 4x</td>
<td style="text-align:center">&#x9A81;&#x9F99;625 &#x56DB;&#x6838;2.0GHz</td>
<td style="text-align:center">124 ms</td>
<td style="text-align:center">306 ms</td>
<td style="text-align:center">202 ms</td>
<td style="text-align:center">110 ms</td>
</tr>
<tr>
<td style="text-align:center">arm-v7a</td>
<td style="text-align:center">Google Nexus 6</td>
<td style="text-align:center">&#x9A81;&#x9F99;805 &#x56DB;&#x6838; 2.7GHz</td>
<td style="text-align:center">84 ms</td>
<td style="text-align:center">245 ms</td>
<td style="text-align:center">103 ms</td>
<td style="text-align:center">63 ms</td>
</tr>
<tr>
<td style="text-align:center">arm-v7a</td>
<td style="text-align:center">Vivo x6d</td>
<td style="text-align:center">&#x8054;&#x53D1;&#x79D1; MT6752 1.7GHz</td>
<td style="text-align:center">245 ms</td>
<td style="text-align:center">502 ms</td>
<td style="text-align:center">370 ms</td>
<td style="text-align:center">186 ms</td>
</tr>
<tr>
<td style="text-align:center">arm-v7a</td>
<td style="text-align:center">&#x534E;&#x4E3A; Mate 8</td>
<td style="text-align:center">&#x6D77;&#x601D;&#x9E92;&#x9E9F;950 4&#x5927;4&#x5C0F; 2.3GHz 1.8GHz</td>
<td style="text-align:center">75 ms</td>
<td style="text-align:center">180 ms</td>
<td style="text-align:center">95 ms</td>
<td style="text-align:center">57 ms</td>
</tr>
<tr>
<td style="text-align:center">arm-v7a</td>
<td style="text-align:center">&#x534E;&#x4E3A; Mate 9</td>
<td style="text-align:center">&#x6D77;&#x601D;&#x9E92;&#x9E9F;960 4&#x5927;4&#x5C0F; 2.4GHz 1.8GHz</td>
<td style="text-align:center">61 ms</td>
<td style="text-align:center">170 ms</td>
<td style="text-align:center">94 ms</td>
<td style="text-align:center">48 ms</td>
</tr>
<tr>
<td style="text-align:center">arm-v8</td>
<td style="text-align:center">iphone7</td>
<td style="text-align:center">Apple A10 Fusion 2.34GHz</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">27 ms</td>
<td style="text-align:center">26 ms</td>
</tr>
</tbody>
</table>
<p><strong>&#x672A;&#x5F00;&#x653E;&#x7279;&#x6027;</strong></p>
<ul>
<li>&#x591A;&#x6838;&#x5E76;&#x884C;&#x52A0;&#x901F;&#xFF08;&#x591A;&#x6838;&#x673A;&#x5668;&#x53EF;&#x4EE5;&#x518D;&#x63D0;&#x5347;30%-100% &#x7684;&#x901F;&#x5EA6;&#xFF09;</li>
<li>depthwise&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#xFF08;&#x652F;&#x6301;mobilenet&#xFF09;</li>
<li>&#x6A21;&#x578B;&#x538B;&#x7F29;&#x529F;&#x80FD;&#xFF0C;&#x538B;&#x7F29;&#x540E;&#x7684;&#x6A21;&#x578B;&#x4F53;&#x79EF;&#x53EF;&#x7F29;&#x5C0F;&#x5230;20%&#x4EE5;&#x4E0B;</li>
<li>GPU &#x8FD0;&#x7B97;&#x6A21;&#x5F0F;&#xFF08;Android &#x57FA;&#x4E8E;opengl es 3.1&#xFF0C;ios &#x57FA;&#x4E8E;metal&#xFF09;</li>
</ul>
<p><strong>&#x540C;&#x7C7B;&#x6846;&#x67B6;&#x5BF9;&#x6BD4;</strong></p>
<table>
<thead>
<tr>
<th style="text-align:center">&#x6846;&#x67B6;</th>
<th style="text-align:center">caffe</th>
<th style="text-align:center">tensorflow</th>
<th style="text-align:center">mdl-android</th>
<th style="text-align:center">mdl-ios</th>
<th style="text-align:center">ncnn</th>
<th style="text-align:center">CoreML</th>
<th style="text-align:center">Prestissimo</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x8BA1;&#x7B97;&#x786C;&#x4EF6;</td>
<td style="text-align:center">cpu</td>
<td style="text-align:center">cpu</td>
<td style="text-align:center">cpu</td>
<td style="text-align:center">gpu</td>
<td style="text-align:center">cpu</td>
<td style="text-align:center">gpu</td>
<td style="text-align:center">cpu &#xFF08;gpu&#x7248;&#x672C;&#x672A;&#x5F00;&#x653E;&#xFF09;</td>
</tr>
<tr>
<td style="text-align:center">&#x8BA1;&#x7B97;&#x901F;&#x5EA6;</td>
<td style="text-align:center">&#x6162;</td>
<td style="text-align:center">&#x6162;</td>
<td style="text-align:center">&#x6162;</td>
<td style="text-align:center">&#x5F88;&#x5FEB;</td>
<td style="text-align:center">&#x5F88;&#x5FEB;</td>
<td style="text-align:center">&#x6781;&#x5FEB;</td>
<td style="text-align:center">&#x6781;&#x5FEB;</td>
</tr>
<tr>
<td style="text-align:center">&#x5E93;&#x5927;&#x5C0F;</td>
<td style="text-align:center">&#x5927;</td>
<td style="text-align:center">&#x8F83;&#x5927;</td>
<td style="text-align:center">&#x4E2D;&#x7B49;</td>
<td style="text-align:center">&#x5C0F;</td>
<td style="text-align:center">&#x5C0F;</td>
<td style="text-align:center">&#x5C0F;</td>
<td style="text-align:center">&#x5C0F;</td>
</tr>
<tr>
<td style="text-align:center">&#x517C;&#x5BB9;&#x6027;</td>
<td style="text-align:center">&#x597D;</td>
<td style="text-align:center">&#x597D;</td>
<td style="text-align:center">&#x597D;</td>
<td style="text-align:center">&#x9650;ios8&#x4EE5;&#x4E0A;</td>
<td style="text-align:center">&#x5F88;&#x597D;</td>
<td style="text-align:center">&#x4EC5;&#x652F;&#x6301; ios11</td>
<td style="text-align:center">&#x5F88;&#x597D;</td>
</tr>
<tr>
<td style="text-align:center">&#x6A21;&#x578B;&#x652F;&#x6301;&#x5EA6;</td>
<td style="text-align:center">&#x5F88;&#x597D;</td>
<td style="text-align:center">&#x597D;</td>
<td style="text-align:center">-</td>
<td style="text-align:center">&#x5DEE;&#xFF08;&#x4EC5;&#x9650;&#x6307;&#x5B9A;&#x6A21;&#x578B;&#xFF09;</td>
<td style="text-align:center">&#x8F83;&#x597D;</td>
<td style="text-align:center">-</td>
<td style="text-align:center">&#x4E2D;&#x7B49;&#xFF08;&#x5F53;&#x524D;&#x7248;&#x672C;&#x4E0D;&#x652F;&#x6301;mobilenet&#xFF09;</td>
</tr>
</tbody>
</table>
<p><strong>&#x4F7F;&#x7528;&#x65B9;&#x6CD5;-&#x6A21;&#x578B;&#x8F6C;&#x6362;</strong></p>
<p>&#x7EDD;&#x5F71;&#x652F;&#x6301;&#x7684;&#x662F;&#x79C1;&#x6709;&#x7684;&#x6A21;&#x578B;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#xFF0C;&#x9700;&#x8981;&#x628A; caffe &#x8BAD;&#x7EC3;&#x51FA;&#x6765;&#x7684;&#x6A21;&#x578B;&#x8F6C;&#x6362;&#x4E3A; .prestissimo &#x683C;&#x5F0F;&#xFF0C;&#x6A21;&#x578B;&#x8F6C;&#x6362;&#x5DE5;&#x5177;&#x4E3A; caffe2Prestissimo.out&#x3002;caffe2Prestissimo.out &#x4F9D;&#x8D56; protobuf 3.30&#x3002;&#x5C06; XXX.prototxt &#x548C; YYY.caffemodel &#x8F6C;&#x5316;&#x4E3A; Prestissimo &#x6A21;&#x578B; ZZZ.prestissimo&#xFF1A;&#xFF08;&#x5F97;&#x5230;&#xFF09;./caffe2Prestissimo.out XXX.prototxt YYY.caffemodel ZZZ.prestissimo</p>
<h3 class="mume-header" id="1774-mdlmobile-deep-learning">17.7.4 MDL&#xFF08;mobile-deep-learning&#xFF09;</h3>

<p>&#xFF11;&#x3001;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#xFF1A;2017&#x5E74;9&#x6708;&#xFF08;&#x5DF2;&#x6682;&#x505C;&#x66F4;&#x65B0;&#xFF09;</p>
<p>&#xFF12;&#x3001;&#x5F00;&#x6E90;&#x7528;&#x6237;&#xFF1A;&#x767E;&#x5EA6;</p>
<p>&#xFF13;&#x3001;GitHub&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/allonli/mobile-deep-learning">https://github.com/allonli/mobile-deep-learning</a></p>
<p>&#xFF14;&#x3001;&#x529F;&#x80FD;&#x7279;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x4E00;&#x952E;&#x90E8;&#x7F72;&#xFF0C;&#x811A;&#x672C;&#x53C2;&#x6570;&#x5C31;&#x53EF;&#x4EE5;&#x5207;&#x6362;ios&#x6216;&#x8005;android</li>
<li>&#x652F;&#x6301;iOS  gpu&#x8FD0;&#x884C;MobileNet&#x3001;squeezenet&#x6A21;&#x578B;</li>
<li>&#x5DF2;&#x7ECF;&#x6D4B;&#x8BD5;&#x8FC7;&#x53EF;&#x4EE5;&#x7A33;&#x5B9A;&#x8FD0;&#x884C;MobileNet&#x3001;GoogLeNet v1&#x3001;squeezenet&#x3001;ResNet-50&#x6A21;&#x578B;</li>
<li>&#x4F53;&#x79EF;&#x6781;&#x5C0F;&#xFF0C;&#x65E0;&#x4EFB;&#x4F55;&#x7B2C;&#x4E09;&#x65B9;&#x4F9D;&#x8D56;&#x3002;&#x7EAF;&#x624B;&#x5DE5;&#x6253;&#x9020;&#x3002;</li>
<li>&#x63D0;&#x4F9B;&#x91CF;&#x5316;&#x51FD;&#x6570;&#xFF0C;&#x5BF9;32&#x4F4D;float&#x8F6C;8&#x4F4D;uint&#x76F4;&#x63A5;&#x652F;&#x6301;&#xFF0C;&#x6A21;&#x578B;&#x4F53;&#x79EF;&#x91CF;&#x5316;&#x540E;4M&#x4E0A;&#x4E0B;</li>
<li>&#x4E0E;ARM&#x76F8;&#x5173;&#x7B97;&#x6CD5;&#x56E2;&#x961F;&#x7EBF;&#x4E0A;&#x7EBF;&#x4E0B;&#x591A;&#x6B21;&#x6C9F;&#x901A;&#xFF0C;&#x9488;&#x5BF9;ARM&#x5E73;&#x53F0;&#x4F1A;&#x6301;&#x7EED;&#x4F18;&#x5316;</li>
<li>NEON&#x4F7F;&#x7528;&#x6DB5;&#x76D6;&#x4E86;&#x5377;&#x79EF;&#x3001;&#x5F52;&#x4E00;&#x5316;&#x3001;&#x6C60;&#x5316;&#x6240;&#x6709;&#x65B9;&#x9762;&#x7684;&#x64CD;&#x4F5C;</li>
<li>&#x6C47;&#x7F16;&#x4F18;&#x5316;&#xFF0C;&#x9488;&#x5BF9;&#x5BC4;&#x5B58;&#x5668;&#x6C47;&#x7F16;&#x64CD;&#x4F5C;&#x5177;&#x4F53;&#x4F18;&#x5316;</li>
<li>loop unrolling &#x5FAA;&#x73AF;&#x5C55;&#x5F00;&#xFF0C;&#x4E3A;&#x63D0;&#x5347;&#x6027;&#x80FD;&#x51CF;&#x5C11;&#x4E0D;&#x5FC5;&#x8981;&#x7684;CPU&#x6D88;&#x8017;&#xFF0C;&#x5168;&#x90E8;&#x5C55;&#x5F00;&#x5224;&#x65AD;&#x64CD;&#x4F5C;</li>
<li>&#x5C06;&#x5927;&#x91CF;&#x7E41;&#x91CD;&#x7684;&#x8BA1;&#x7B97;&#x4EFB;&#x52A1;&#x524D;&#x7F6E;&#x5230;overhead&#x8FC7;&#x7A0B;</li>
</ul>
<p>5&#x3001;&#x6846;&#x67B6;&#x7ED3;&#x6784;</p>
<p><img src="./img/ch17/MDL1.png" alt=""></p>
<p>MDL &#x6846;&#x67B6;&#x4E3B;&#x8981;&#x5305;&#x62EC;&#xFF1A;<strong>&#x6A21;&#x578B;&#x8F6C;&#x6362;&#x6A21;&#x5757;&#xFF08;MDL Converter&#xFF09;&#x3001;&#x6A21;&#x578B;&#x52A0;&#x8F7D;&#x6A21;&#x5757;&#xFF08;Loader&#xFF09;&#x3001;&#x7F51;&#x7EDC;&#x7BA1;&#x7406;&#x6A21;&#x5757;&#xFF08;Net&#xFF09;&#x3001;&#x77E9;&#x9635;&#x8FD0;&#x7B97;&#x6A21;&#x5757;&#xFF08;Gemmers&#xFF09;&#x53CA;&#x4F9B; Android &#x7AEF;&#x8C03;&#x7528;&#x7684; JNI &#x63A5;&#x53E3;&#x5C42;&#xFF08;JNI Interfaces&#xFF09;&#x3002;</strong></p>
<p>&#x200B;	&#x5176;&#x4E2D;&#xFF0C;&#x6A21;&#x578B;&#x8F6C;&#x6362;&#x6A21;&#x5757;&#x4E3B;&#x8981;&#x8D1F;&#x8D23;&#x5C06;Caffe &#x6A21;&#x578B;&#x8F6C;&#x4E3A; MDL &#x6A21;&#x578B;&#xFF0C;&#x540C;&#x65F6;&#x652F;&#x6301;&#x5C06; 32bit &#x6D6E;&#x70B9;&#x578B;&#x53C2;&#x6570;&#x91CF;&#x5316;&#x4E3A; 8bit &#x53C2;&#x6570;&#xFF0C;&#x4ECE;&#x800C;&#x6781;&#x5927;&#x5730;&#x538B;&#x7F29;&#x6A21;&#x578B;&#x4F53;&#x79EF;&#xFF1B;&#x6A21;&#x578B;&#x52A0;&#x8F7D;&#x6A21;&#x5757;&#x4E3B;&#x8981;&#x5B8C;&#x6210;&#x6A21;&#x578B;&#x7684;&#x53CD;&#x91CF;&#x5316;&#x53CA;&#x52A0;&#x8F7D;&#x6821;&#x9A8C;&#x3001;&#x7F51;&#x7EDC;&#x6CE8;&#x518C;&#x7B49;&#x8FC7;&#x7A0B;&#xFF0C;&#x7F51;&#x7EDC;&#x7BA1;&#x7406;&#x6A21;&#x5757;&#x4E3B;&#x8981;&#x8D1F;&#x8D23;&#x7F51;&#x7EDC;&#x4E2D;&#x5404;&#x5C42; Layer &#x7684;&#x521D;&#x59CB;&#x5316;&#x53CA;&#x7BA1;&#x7406;&#x5DE5;&#x4F5C;&#xFF1B;MDL &#x63D0;&#x4F9B;&#x4E86;&#x4F9B; Android &#x7AEF;&#x8C03;&#x7528;&#x7684; JNI &#x63A5;&#x53E3;&#x5C42;&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528; JNI &#x63A5;&#x53E3;&#x8F7B;&#x677E;&#x5B8C;&#x6210;&#x52A0;&#x8F7D;&#x53CA;&#x9884;&#x6D4B;&#x8FC7;&#x7A0B;&#x3002;</p>
<p>6&#x3001;MDL &#x7684;&#x6027;&#x80FD;&#x53CA;&#x517C;&#x5BB9;&#x6027;</p>
<ul>
<li>&#x4F53;&#x79EF; armv7 300k+</li>
<li>&#x901F;&#x5EA6; iOS GPU mobilenet &#x53EF;&#x4EE5;&#x8FBE;&#x5230; 40ms&#x3001;squeezenet &#x53EF;&#x4EE5;&#x8FBE;&#x5230; 30ms</li>
</ul>
<p>&#x200B;        MDL  &#x4ECE;&#x7ACB;&#x9879;&#x5230;&#x5F00;&#x6E90;&#xFF0C;&#x5DF2;&#x7ECF;&#x8FED;&#x4EE3;&#x4E86;&#x4E00;&#x5E74;&#x591A;&#x3002;&#x79FB;&#x52A8;&#x7AEF;&#x6BD4;&#x8F83;&#x5173;&#x6CE8;&#x7684;&#x591A;&#x4E2A;&#x6307;&#x6807;&#x90FD;&#x8868;&#x73B0;&#x826F;&#x597D;&#xFF0C;&#x5982;&#x4F53;&#x79EF;&#x3001;&#x529F;&#x8017;&#x3001;&#x901F;&#x5EA6;&#x3002;&#x767E;&#x5EA6;&#x5185;&#x90E8;&#x4EA7;&#x54C1;&#x7EBF;&#x5728;&#x5E94;&#x7528;&#x524D;&#x4E5F;&#x8FDB;&#x884C;&#x8FC7;&#x591A;&#x6B21;&#x5BF9;&#x6BD4;&#xFF0C;&#x548C;&#x5DF2;&#x5F00;&#x6E90;&#x7684;&#x76F8;&#x5173;&#x9879;&#x76EE;&#x5BF9;&#x6BD4;&#xFF0C;MDL  &#x80FD;&#x591F;&#x5728;&#x4FDD;&#x8BC1;&#x901F;&#x5EA6;&#x548C;&#x80FD;&#x8017;&#x7684;&#x540C;&#x65F6;&#x652F;&#x6301;&#x591A;&#x79CD;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#xFF0C;&#x5982; mobilenet&#x3001;googlenet v1&#x3001;squeezenet &#x7B49;&#xFF0C;&#x4E14;&#x5177;&#x6709; iOS  GPU &#x7248;&#x672C;&#xFF0C;squeezenet &#x4E00;&#x6B21;&#x8FD0;&#x884C;&#x6700;&#x5FEB;&#x53EF;&#x4EE5;&#x8FBE;&#x5230; 3-40ms&#x3002;</p>
<p><strong>&#x540C;&#x7C7B;&#x6846;&#x67B6;&#x5BF9;&#x6BD4;</strong></p>
<p>&#x200B;	 &#x6846;&#x67B6;Caffe2TensorFlowncnnMDL(CPU)MDL(GPU)&#x786C;&#x4EF6;CPUCPUCPUCPUGPU&#x901F;&#x5EA6;&#x6162;&#x6162;&#x5FEB;&#x5FEB;&#x6781;&#x5FEB;&#x4F53;&#x79EF;&#x5927;&#x5927;&#x5C0F;&#x5C0F;&#x5C0F;&#x517C;&#x5BB9;Android&amp;iOSAndroid&amp;iOSAndroid&amp;iOSAndroid&amp;iOSiOS</p>
<p>&#x200B;	 &#x4E0E;&#x652F;&#x6301; CNN &#x7684;&#x79FB;&#x52A8;&#x7AEF;&#x6846;&#x67B6;&#x5BF9;&#x6BD4;&#xFF0C;MDL &#x901F;&#x5EA6;&#x5FEB;&#x3001;&#x6027;&#x80FD;&#x7A33;&#x5B9A;&#x3001;&#x517C;&#x5BB9;&#x6027;&#x597D;&#x3001;demo &#x5B8C;&#x5907;&#x3002;</p>
<p><strong>&#x517C;&#x5BB9;&#x6027;</strong></p>
<p>&#x200B;	 MDL &#x5728; iOS &#x548C; Android &#x5E73;&#x53F0;&#x5747;&#x53EF;&#x4EE5;&#x7A33;&#x5B9A;&#x8FD0;&#x884C;&#xFF0C;&#x5176;&#x4E2D; iOS10 &#x53CA;&#x4EE5;&#x4E0A;&#x5E73;&#x53F0;&#x6709;&#x57FA;&#x4E8E; GPU &#x8FD0;&#x7B97;&#x7684; API&#xFF0C;&#x6027;&#x80FD;&#x8868;&#x73B0;&#x975E;&#x5E38;&#x51FA;&#x8272;&#xFF0C;&#x5728; Android &#x5E73;&#x53F0;&#x5219;&#x662F;&#x7EAF; CPU &#x8FD0;&#x884C;&#x3002;&#x9AD8;&#x4E2D;&#x4F4E;&#x7AEF;&#x673A;&#x578B;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#x548C;&#x624B;&#x673A;&#x767E;&#x5EA6;&#x53CA;&#x5176;&#x4ED6; App &#x4E0A;&#x7684;&#x8986;&#x76D6;&#x90FD;&#x6709;&#x7EDD;&#x5BF9;&#x4F18;&#x52BF;&#x3002;</p>
<p>&#x200B;	 MDL &#x540C;&#x65F6;&#x4E5F;&#x652F;&#x6301; Caffe &#x6A21;&#x578B;&#x76F4;&#x63A5;&#x8F6C;&#x6362;&#x4E3A; MDL &#x6A21;&#x578B;&#x3002;</p>
<h3 class="mume-header" id="1775-paddle-mobile">17.7.5 Paddle-Mobile</h3>

<p>&#xFF11;&#x3001;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#xFF1A;&#x6301;&#x7EED;&#x66F4;&#x65B0;&#xFF0C;&#x5DF2;&#x5230;3.0&#x7248;&#x672C;</p>
<p>&#xFF12;&#x3001;&#x5F00;&#x6E90;&#x7528;&#x6237;&#xFF1A;&#x767E;&#x5EA6;</p>
<p>&#xFF13;&#x3001;GitHub&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/PaddlePaddle/paddle-mobile">https://github.com/PaddlePaddle/paddle-mobile</a></p>
<p>&#xFF14;&#x3001;&#x529F;&#x80FD;&#x7279;&#x70B9;&#xFF1A;</p>
<p><strong>&#x529F;&#x80FD;&#x7279;&#x70B9;</strong></p>
<ul>
<li>
<p>&#x9AD8;&#x6027;&#x80FD;&#x652F;&#x6301;ARM CPU</p>
</li>
<li>
<p>&#x652F;&#x6301;Mali GPU</p>
</li>
<li>
<p>&#x652F;&#x6301;Andreno GPU</p>
</li>
<li>
<p>&#x652F;&#x6301;&#x82F9;&#x679C;&#x8BBE;&#x5907;&#x7684;GPU Metal&#x5B9E;&#x73B0;</p>
</li>
<li>
<p>&#x652F;&#x6301;ZU5&#x3001;ZU9&#x7B49;FPGA&#x5F00;&#x53D1;&#x677F;</p>
</li>
<li>
<p>&#x652F;&#x6301;&#x6811;&#x8393;&#x6D3E;&#x7B49;arm-linux&#x5F00;&#x53D1;&#x677F;</p>
</li>
</ul>
<h3 class="mume-header" id="1776-mace-mobile-ai-compute-engine">17.7.6 MACE&#xFF08; Mobile AI Compute Engine&#xFF09;</h3>

<p>&#xFF11;&#x3001;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#xFF1A;2018&#x5E74;4&#x6708;(&#x6301;&#x7EED;&#x66F4;&#x65B0;&#xFF0C;v0.9.0 (2018-07-20))</p>
<p>&#xFF12;&#x3001;&#x5F00;&#x6E90;&#x7528;&#x6237;&#xFF1A;&#x5C0F;&#x7C73;</p>
<p>&#xFF13;&#x3001;GitHub&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/XiaoMi/mace">https://github.com/XiaoMi/mace</a></p>
<p>&#xFF14;&#x3001;&#x7B80;&#x4ECB;&#xFF1A;Mobile AI Compute Engine (MACE) &#x662F;&#x4E00;&#x4E2A;&#x4E13;&#x4E3A;&#x79FB;&#x52A8;&#x7AEF;&#x5F02;&#x6784;&#x8BA1;&#x7B97;&#x8BBE;&#x5907;&#x4F18;&#x5316;&#x7684;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x524D;&#x5411;&#x9884;&#x6D4B;&#x6846;&#x67B6;&#x3002;<br>
MACE&#x8986;&#x76D6;&#x4E86;&#x5E38;&#x89C1;&#x7684;&#x79FB;&#x52A8;&#x7AEF;&#x8BA1;&#x7B97;&#x8BBE;&#x5907;&#xFF08;CPU&#xFF0C;GPU&#x548C;DSP&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x63D0;&#x4F9B;&#x4E86;&#x5B8C;&#x6574;&#x7684;&#x5DE5;&#x5177;&#x94FE;&#x548C;&#x6587;&#x6863;&#xFF0C;&#x7528;&#x6237;&#x501F;&#x52A9;MACE&#x80FD;&#x591F;&#x5F88;&#x65B9;&#x4FBF;&#x5730;&#x5728;&#x79FB;&#x52A8;&#x7AEF;&#x90E8;&#x7F72;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#x3002;MACE&#x5DF2;&#x7ECF;&#x5728;&#x5C0F;&#x7C73;&#x5185;&#x90E8;&#x5E7F;&#x6CDB;&#x4F7F;&#x7528;&#x5E76;&#x4E14;&#x88AB;&#x5145;&#x5206;&#x9A8C;&#x8BC1;&#x5177;&#x6709;&#x4E1A;&#x754C;&#x9886;&#x5148;&#x7684;&#x6027;&#x80FD;&#x548C;&#x7A33;&#x5B9A;&#x6027;&#x3002;</p>
<p>5&#x3001;MACE&#x7684;&#x57FA;&#x672C;&#x6846;&#x67B6;&#xFF1A;</p>
<p><img src="./img/ch17/mace-arch.png" alt=""></p>
<p><strong>MACE Model</strong></p>
<p>MACE&#x5B9A;&#x4E49;&#x4E86;&#x81EA;&#x6709;&#x7684;&#x6A21;&#x578B;&#x683C;&#x5F0F;&#xFF08;&#x7C7B;&#x4F3C;&#x4E8E;Caffe2&#xFF09;&#xFF0C;&#x901A;&#x8FC7;MACE&#x63D0;&#x4F9B;&#x7684;&#x5DE5;&#x5177;&#x53EF;&#x4EE5;&#x5C06;Caffe&#x548C;TensorFlow&#x7684;&#x6A21;&#x578B; &#x8F6C;&#x4E3A;MACE&#x6A21;&#x578B;&#x3002;</p>
<p><strong>MACE Interpreter</strong></p>
<p>MACE Interpreter&#x4E3B;&#x8981;&#x8D1F;&#x8D23;&#x89E3;&#x6790;&#x8FD0;&#x884C;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x56FE;&#xFF08;DAG&#xFF09;&#x5E76;&#x7BA1;&#x7406;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;Tensors&#x3002;</p>
<p><strong>Runtime</strong></p>
<p>CPU/GPU/DSP Runtime&#x5BF9;&#x5E94;&#x4E8E;&#x5404;&#x4E2A;&#x8BA1;&#x7B97;&#x8BBE;&#x5907;&#x7684;&#x7B97;&#x5B50;&#x5B9E;&#x73B0;&#x3002;</p>
<p>6&#x3001;MACE&#x4F7F;&#x7528;&#x7684;&#x57FA;&#x672C;&#x6D41;&#x7A0B;</p>
<p><img src="./img/ch17/mace-work-flow-zh.png" alt=""></p>
<p><strong>1. &#x914D;&#x7F6E;&#x6A21;&#x578B;&#x90E8;&#x7F72;&#x6587;&#x4EF6;(.yml)</strong></p>
<p>&#x6A21;&#x578B;&#x90E8;&#x7F72;&#x6587;&#x4EF6;&#x8BE6;&#x7EC6;&#x63CF;&#x8FF0;&#x4E86;&#x9700;&#x8981;&#x90E8;&#x7F72;&#x7684;&#x6A21;&#x578B;&#x4EE5;&#x53CA;&#x751F;&#x6210;&#x5E93;&#x7684;&#x4FE1;&#x606F;&#xFF0C;MACE&#x6839;&#x636E;&#x8BE5;&#x6587;&#x4EF6;&#x6700;&#x7EC8;&#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684;&#x5E93;&#x6587;&#x4EF6;&#x3002;</p>
<p><strong>2.&#x7F16;&#x8BD1;MACE&#x5E93;</strong></p>
<p>&#x7F16;&#x8BD1;MACE&#x7684;&#x9759;&#x6001;&#x5E93;&#x6216;&#x8005;&#x52A8;&#x6001;&#x5E93;&#x3002;</p>
<p><strong>3.&#x8F6C;&#x6362;&#x6A21;&#x578B;</strong></p>
<p>&#x5C06;TensorFlow &#x6216;&#x8005; Caffe&#x7684;&#x6A21;&#x578B;&#x8F6C;&#x4E3A;MACE&#x7684;&#x6A21;&#x578B;&#x3002;</p>
<p><strong>4.1. &#x90E8;&#x7F72;</strong></p>
<p>&#x6839;&#x636E;&#x4E0D;&#x540C;&#x4F7F;&#x7528;&#x76EE;&#x7684;&#x96C6;&#x6210;Build&#x9636;&#x6BB5;&#x751F;&#x6210;&#x7684;&#x5E93;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x8C03;&#x7528;MACE&#x76F8;&#x5E94;&#x7684;&#x63A5;&#x53E3;&#x6267;&#x884C;&#x6A21;&#x578B;&#x3002;</p>
<p><strong>4.2. &#x547D;&#x4EE4;&#x884C;&#x8FD0;&#x884C;</strong></p>
<p>MACE&#x63D0;&#x4F9B;&#x4E86;&#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x547D;&#x4EE4;&#x884C;&#x8FD0;&#x884C;&#x6A21;&#x578B;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x6D4B;&#x8BD5;&#x6A21;&#x578B;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#xFF0C;&#x5185;&#x5B58;&#x5360;&#x7528;&#x548C;&#x6B63;&#x786E;&#x6027;&#x3002;</p>
<p><strong>4.3. Benchmark</strong></p>
<p>MACE&#x63D0;&#x4F9B;&#x4E86;&#x547D;&#x4EE4;&#x884C;benchmark&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x4EE5;&#x7EC6;&#x7C92;&#x5EA6;&#x7684;&#x67E5;&#x770B;&#x6A21;&#x578B;&#x4E2D;&#x6240;&#x6D89;&#x53CA;&#x7684;&#x6240;&#x6709;&#x7B97;&#x5B50;&#x7684;&#x8FD0;&#x884C;&#x65F6;&#x95F4;&#x3002;</p>
<p>7&#x3001;MACE&#x5728;&#x54EA;&#x4E9B;&#x89D2;&#x5EA6;&#x8FDB;&#x884C;&#x4E86;&#x4F18;&#x5316;?</p>
<p><strong>MACE</strong> &#x4E13;&#x4E3A;&#x79FB;&#x52A8;&#x7AEF;&#x5F02;&#x6784;&#x8BA1;&#x7B97;&#x5E73;&#x53F0;&#x4F18;&#x5316;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x8BA1;&#x7B97;&#x6846;&#x67B6;&#x3002;&#x4E3B;&#x8981;&#x4ECE;&#x4EE5;&#x4E0B;&#x7684;&#x89D2;&#x5EA6;&#x505A;&#x4E86;&#x4E13;&#x95E8;&#x7684;&#x4F18;&#x5316;&#xFF1A;</p>
<ul>
<li>
<p>&#x6027;&#x80FD;</p>
<ul>
<li>&#x4EE3;&#x7801;&#x7ECF;&#x8FC7;NEON&#x6307;&#x4EE4;&#xFF0C;OpenCL&#x4EE5;&#x53CA;Hexagon HVX&#x4E13;&#x95E8;&#x4F18;&#x5316;&#xFF0C;&#x5E76;&#x4E14;&#x91C7;&#x7528;<br>
<a href="https://arxiv.org/abs/1509.09308">Winograd&#x7B97;&#x6CD5;</a>&#x6765;&#x8FDB;&#x884C;&#x5377;&#x79EF;&#x64CD;&#x4F5C;&#x7684;&#x52A0;&#x901F;&#x3002;<br>
&#x6B64;&#x5916;&#xFF0C;&#x8FD8;&#x5BF9;&#x542F;&#x52A8;&#x901F;&#x5EA6;&#x8FDB;&#x884C;&#x4E86;&#x4E13;&#x95E8;&#x7684;&#x4F18;&#x5316;&#x3002;</li>
</ul>
</li>
<li>
<p>&#x529F;&#x8017;</p>
<ul>
<li>&#x652F;&#x6301;&#x82AF;&#x7247;&#x7684;&#x529F;&#x8017;&#x7BA1;&#x7406;&#xFF0C;&#x4F8B;&#x5982;ARM&#x7684;big.LITTLE&#x8C03;&#x5EA6;&#xFF0C;&#x4EE5;&#x53CA;&#x9AD8;&#x901A;Adreno GPU&#x529F;&#x8017;&#x9009;&#x9879;&#x3002;</li>
</ul>
</li>
<li>
<p>&#x7CFB;&#x7EDF;&#x54CD;&#x5E94;</p>
<ul>
<li>&#x652F;&#x6301;&#x81EA;&#x52A8;&#x62C6;&#x89E3;&#x957F;&#x65F6;&#x95F4;&#x7684;OpenCL&#x8BA1;&#x7B97;&#x4EFB;&#x52A1;&#xFF0C;&#x6765;&#x4FDD;&#x8BC1;UI&#x6E32;&#x67D3;&#x4EFB;&#x52A1;&#x80FD;&#x591F;&#x505A;&#x5230;&#x8F83;&#x597D;&#x7684;&#x62A2;&#x5360;&#x8C03;&#x5EA6;&#xFF0C;<br>
&#x4ECE;&#x800C;&#x4FDD;&#x8BC1;&#x7CFB;&#x7EDF;UI&#x7684;&#x76F8;&#x5E94;&#x548C;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#x3002;</li>
</ul>
</li>
<li>
<p>&#x5185;&#x5B58;&#x5360;&#x7528;</p>
<ul>
<li>&#x901A;&#x8FC7;&#x8FD0;&#x7528;&#x5185;&#x5B58;&#x4F9D;&#x8D56;&#x5206;&#x6790;&#x6280;&#x672F;&#xFF0C;&#x4EE5;&#x53CA;&#x5185;&#x5B58;&#x590D;&#x7528;&#xFF0C;&#x51CF;&#x5C11;&#x5185;&#x5B58;&#x7684;&#x5360;&#x7528;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x4FDD;&#x6301;&#x5C3D;&#x91CF;&#x5C11;&#x7684;&#x5916;&#x90E8;<br>
&#x4F9D;&#x8D56;&#xFF0C;&#x4FDD;&#x8BC1;&#x4EE3;&#x7801;&#x5C3A;&#x5BF8;&#x7CBE;&#x7B80;&#x3002;</li>
</ul>
</li>
<li>
<p>&#x6A21;&#x578B;&#x52A0;&#x5BC6;&#x4E0E;&#x4FDD;&#x62A4;</p>
<ul>
<li>&#x6A21;&#x578B;&#x4FDD;&#x62A4;&#x662F;&#x91CD;&#x8981;&#x8BBE;&#x8BA1;&#x76EE;&#x6807;&#x4E4B;&#x4E00;&#x3002;&#x652F;&#x6301;&#x5C06;&#x6A21;&#x578B;&#x8F6C;&#x6362;&#x6210;C++&#x4EE3;&#x7801;&#xFF0C;&#x4EE5;&#x53CA;&#x5173;&#x952E;&#x5E38;&#x91CF;&#x5B57;&#x7B26;&#x6DF7;&#x6DC6;&#xFF0C;&#x589E;&#x52A0;&#x9006;&#x5411;&#x7684;&#x96BE;&#x5EA6;&#x3002;</li>
</ul>
</li>
<li>
<p>&#x786C;&#x4EF6;&#x652F;&#x6301;&#x8303;&#x56F4;</p>
<ul>
<li>&#x652F;&#x6301;&#x9AD8;&#x901A;&#xFF0C;&#x8054;&#x53D1;&#x79D1;&#xFF0C;&#x4EE5;&#x53CA;&#x677E;&#x679C;&#x7B49;&#x7CFB;&#x5217;&#x82AF;&#x7247;&#x7684;CPU&#xFF0C;GPU&#x4E0E;DSP(&#x76EE;&#x524D;&#x4EC5;&#x652F;&#x6301;Hexagon)&#x8BA1;&#x7B97;&#x52A0;&#x901F;&#x3002;</li>
<li>&#x540C;&#x65F6;&#x652F;&#x6301;&#x5728;&#x5177;&#x6709;POSIX&#x63A5;&#x53E3;&#x7684;&#x7CFB;&#x7EDF;&#x7684;CPU&#x4E0A;&#x8FD0;&#x884C;&#x3002;</li>
</ul>
</li>
</ul>
<p>8&#x3001;&#x6027;&#x80FD;&#x5BF9;&#x6BD4;&#xFF1A;</p>
<p>MACE &#x652F;&#x6301; TensorFlow &#x548C; Caffe &#x6A21;&#x578B;&#xFF0C;&#x63D0;&#x4F9B;&#x8F6C;&#x6362;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x8BAD;&#x7EC3;&#x597D;&#x7684;&#x6A21;&#x578B;&#x8F6C;&#x6362;&#x6210;&#x4E13;&#x6709;&#x7684;&#x6A21;&#x578B;&#x6570;&#x636E;&#x6587;&#x4EF6;&#xFF0C;&#x540C;&#x65F6;&#x8FD8;&#x53EF;&#x4EE5;&#x9009;&#x62E9;&#x5C06;&#x6A21;&#x578B;&#x8F6C;&#x6362;&#x6210;C++&#x4EE3;&#x7801;&#xFF0C;&#x652F;&#x6301;&#x751F;&#x6210;&#x52A8;&#x6001;&#x5E93;&#x6216;&#x8005;&#x9759;&#x6001;&#x5E93;&#xFF0C;&#x63D0;&#x9AD8;&#x6A21;&#x578B;&#x4FDD;&#x5BC6;&#x6027;&#x3002;</p>
<p><img src="./img/ch17/maca_com.jpg" alt=""></p>
<h3 class="mume-header" id="1777-feathercnn">17.7.7 FeatherCNN</h3>

<p>&#xFF11;&#x3001;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#xFF1A;&#x6301;&#x7EED;&#x66F4;&#x65B0;&#xFF0C;&#x5DF2;&#x5230;3.0&#x7248;&#x672C;</p>
<p>&#xFF12;&#x3001;&#x5F00;&#x6E90;&#x7528;&#x6237;&#xFF1A;&#x817E;&#x8BAF;AI</p>
<p>&#xFF13;&#x3001;GitHub&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/Tencent/FeatherCNN">https://github.com/Tencent/FeatherCNN</a></p>
<p>&#xFF14;&#x3001;&#x529F;&#x80FD;&#x7279;&#x70B9;&#xFF1A;</p>
<p><strong>FeatherCNN &#x662F;&#x7531;&#x817E;&#x8BAF; AI &#x5E73;&#x53F0;&#x90E8;&#x7814;&#x53D1;&#x7684;&#x57FA;&#x4E8E; ARM &#x67B6;&#x6784;&#x7684;&#x9AD8;&#x6548; CNN &#x63A8;&#x7406;&#x5E93;&#xFF0C;&#x8BE5;&#x9879;&#x76EE;&#x652F;&#x6301; Caffe &#x6A21;&#x578B;&#xFF0C;&#x4E14;&#x5177;&#x6709;&#x9AD8;&#x6027;&#x80FD;&#x3001;&#x6613;&#x90E8;&#x7F72;&#x3001;&#x8F7B;&#x91CF;&#x7EA7;&#x4E09;&#x5927;&#x7279;&#x6027;&#x3002;</strong></p>
<p><strong>&#x8BE5;&#x9879;&#x76EE;&#x5177;&#x4F53;&#x7279;&#x6027;&#x5982;&#x4E0B;&#xFF1A;</strong></p>
<ul>
<li>
<p>&#x9AD8;&#x6027;&#x80FD;&#xFF1A;&#x65E0;&#x8BBA;&#x662F;&#x5728;&#x79FB;&#x52A8;&#x8BBE;&#x5907;&#xFF08;iOS / Android&#xFF09;&#xFF0C;&#x5D4C;&#x5165;&#x5F0F;&#x8BBE;&#x5907;&#xFF08;Linux&#xFF09;&#x8FD8;&#x662F;&#x57FA;&#x4E8E; ARM &#x7684;&#x670D;&#x52A1;&#x5668;&#xFF08;Linux&#xFF09;&#x4E0A;&#xFF0C;FeatherCNN &#x5747;&#x80FD;&#x53D1;&#x6325;&#x6700;&#x5148;&#x8FDB;&#x7684;&#x63A8;&#x7406;&#x8BA1;&#x7B97;&#x6027;&#x80FD;&#xFF1B;</p>
</li>
<li>
<p>&#x6613;&#x90E8;&#x7F72;&#xFF1A;FeatherCNN &#x7684;&#x6240;&#x6709;&#x5185;&#x5BB9;&#x90FD;&#x5305;&#x542B;&#x5728;&#x4E00;&#x4E2A;&#x4EE3;&#x7801;&#x5E93;&#x4E2D;&#xFF0C;&#x4EE5;&#x6D88;&#x9664;&#x7B2C;&#x4E09;&#x65B9;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5B83;&#x4FBF;&#x4E8E;&#x5728;&#x79FB;&#x52A8;&#x5E73;&#x53F0;&#x4E0A;&#x90E8;&#x7F72;&#x3002;FeatherCNN &#x81EA;&#x8EAB;&#x7684;&#x6A21;&#x578B;&#x683C;&#x5F0F;&#x4E0E; Caffe &#x6A21;&#x578B;&#x5B8C;&#x5168;&#x517C;&#x5BB9;&#x3002;</p>
</li>
<li>
<p>&#x8F7B;&#x91CF;&#x7EA7;&#xFF1A;&#x7F16;&#x8BD1;&#x540E;&#x7684; FeatherCNN &#x5E93;&#x7684;&#x4F53;&#x79EF;&#x4EC5;&#x4E3A;&#x6570;&#x767E; KB&#x3002;</p>
</li>
</ul>
<h3 class="mume-header" id="1778-tensorflow-lite">17.7.8 TensorFlow Lite</h3>

<p>&#xFF11;&#x3001;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#xFF1A;2017&#x5E74;11&#x6708;</p>
<p>&#xFF12;&#x3001;&#x5F00;&#x6E90;&#x7528;&#x6237;&#xFF1A;&#x8C37;&#x6B4C;</p>
<p>&#xFF13;&#x3001;GitHub&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/lite">https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/lite</a></p>
<p>&#xFF14;&#x3001;&#x7B80;&#x4ECB;&#xFF1A;</p>
<p>Google &#x8868;&#x793A; Lite &#x7248;&#x672C; TensorFlow &#x662F; TensorFlow Mobile &#x7684;&#x4E00;&#x4E2A;&#x5EF6;&#x4F38;&#x7248;&#x672C;&#x3002;&#x6B64;&#x524D;&#xFF0C;&#x901A;&#x8FC7;TensorFlow Mobile API&#xFF0C;TensorFlow&#x5DF2;&#x7ECF;&#x652F;&#x6301;&#x624B;&#x673A;&#x4E0A;&#x7684;&#x6A21;&#x578B;&#x5D4C;&#x5165;&#x5F0F;&#x90E8;&#x7F72;&#x3002;TensorFlow Lite&#x5E94;&#x8BE5;&#x88AB;&#x89C6;&#x4E3A;TensorFlow Mobile&#x7684;&#x5347;&#x7EA7;&#x7248;&#x3002;</p>
<p>TensorFlow Lite&#x53EF;&#x4EE5;&#x4E0E;Android 8.1&#x4E2D;&#x53D1;&#x5E03;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;API&#x5B8C;&#x7F8E;&#x914D;&#x5408;&#xFF0C;&#x5373;&#x4FBF;&#x5728;&#x6CA1;&#x6709;&#x786C;&#x4EF6;&#x52A0;&#x901F;&#x65F6;&#x4E5F;&#x80FD;&#x8C03;&#x7528;CPU&#x5904;&#x7406;&#xFF0C;&#x786E;&#x4FDD;&#x6A21;&#x578B;&#x5728;&#x4E0D;&#x540C;&#x8BBE;&#x5907;&#x4E0A;&#x7684;&#x8FD0;&#x884C;&#x3002; &#x800C;Android&#x7AEF;&#x7248;&#x672C;&#x6F14;&#x8FDB;&#x7684;&#x63A7;&#x5236;&#x6743;&#x662F;&#x638C;&#x63E1;&#x5728;&#x8C37;&#x6B4C;&#x624B;&#x4E2D;&#x7684;&#xFF0C;&#x4ECE;&#x957F;&#x671F;&#x770B;&#xFF0C;TensorFlow Lite&#x4F1A;&#x5F97;&#x5230;Android&#x7CFB;&#x7EDF;&#x5C42;&#x9762;&#x4E0A;&#x7684;&#x652F;&#x6301;&#x3002;</p>
<p>5&#x3001;&#x67B6;&#x6784;&#xFF1A;</p>
<p><img src="./img/ch17/tflite_artc.JPEG" alt=""></p>
<p>&#x5176;&#x7EC4;&#x4EF6;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>TensorFlow &#x6A21;&#x578B;&#xFF08;TensorFlow Model&#xFF09;&#xFF1A;&#x4FDD;&#x5B58;&#x5728;&#x78C1;&#x76D8;&#x4E2D;&#x7684;&#x8BAD;&#x7EC3;&#x6A21;&#x578B;&#x3002;</li>
<li>TensorFlow Lite &#x8F6C;&#x5316;&#x5668;&#xFF08;TensorFlow Lite Converter&#xFF09;&#xFF1A;&#x5C06;&#x6A21;&#x578B;&#x8F6C;&#x6362;&#x6210; TensorFlow Lite &#x6587;&#x4EF6;&#x683C;&#x5F0F;&#x7684;&#x9879;&#x76EE;&#x3002;</li>
<li>TensorFlow Lite &#x6A21;&#x578B;&#x6587;&#x4EF6;&#xFF08;TensorFlow Lite Model File&#xFF09;&#xFF1A;&#x57FA;&#x4E8E; FlatBuffers&#xFF0C;&#x9002;&#x914D;&#x6700;&#x5927;&#x901F;&#x5EA6;&#x548C;&#x6700;&#x5C0F;&#x89C4;&#x6A21;&#x7684;&#x6A21;&#x578B;&#x3002;</li>
</ul>
<p>6&#x3001;&#x79FB;&#x52A8;&#x7AEF;&#x5F00;&#x53D1;&#x6B65;&#x9AA4;&#xFF1A;</p>
<p>Android Studio 3.0, SDK Version API26, NDK Version 14</p>
<p>&#x6B65;&#x9AA4;&#xFF1A;</p>
<ol>
<li>
<p>&#x5C06;&#x6B64;&#x9879;&#x76EE;&#x5BFC;&#x5165;&#x5230;Android Studio&#xFF1A;<br>
<a href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/lite/java/demo">https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/lite/java/demo</a></p>
</li>
<li>
<p>&#x4E0B;&#x8F7D;&#x79FB;&#x52A8;&#x7AEF;&#x7684;&#x6A21;&#x578B;&#xFF08;model&#xFF09;&#x548C;&#x6807;&#x7B7E;&#x6570;&#x636E;&#xFF08;lables&#xFF09;&#xFF1A;<br>
<a href="https://storage.googleapis.com/download.tensorflow.org/models/tflite/mobilenet_v1_224_android_quant_2017_11_08.zip">https://storage.googleapis.com/download.tensorflow.org/models/tflite/mobilenet_v1_224_android_quant_2017_11_08.zip</a></p>
</li>
<li>
<p>&#x4E0B;&#x8F7D;&#x5B8C;&#x6210;&#x89E3;&#x538B;mobilenet_v1_224_android_quant_2017_11_08.zip&#x6587;&#x4EF6;&#x5F97;&#x5230;&#x4E00;&#x4E2A;xxx.tflite&#x548C;labes.txt&#x6587;&#x4EF6;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x6A21;&#x578B;&#x548C;&#x6807;&#x7B7E;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x4E14;&#x628A;&#x8FD9;&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x5230;assets&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x3002;</p>
</li>
<li>
<p>&#x6784;&#x5EFA;app&#xFF0C;run&#x2026;&#x2026;</p>
</li>
</ol>
<p>17.7.9 TensorFlow Lite&#x548C;TensorFlow Mobile&#x7684;&#x533A;&#x522B;&#xFF1F;</p>
<ul>
<li>TensorFlow Lite&#x662F;TensorFlow Mobile&#x7684;&#x8FDB;&#x5316;&#x7248;&#x3002;</li>
<li>&#x5728;&#x5927;&#x591A;&#x6570;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;TensorFlow Lite&#x62E5;&#x6709;&#x8DDF;&#x5C0F;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x5927;&#x5C0F;&#xFF0C;&#x66F4;&#x5C11;&#x7684;&#x4F9D;&#x8D56;&#x4EE5;&#x53CA;&#x66F4;&#x597D;&#x7684;&#x6027;&#x80FD;&#x3002;</li>
<li>&#x76F8;&#x6BD4;TensorFlow Mobile&#x662F;&#x5BF9;&#x5B8C;&#x6574;TensorFlow&#x7684;&#x88C1;&#x51CF;&#xFF0C;TensorFlow Lite&#x57FA;&#x672C;&#x5C31;&#x662F;&#x91CD;&#x65B0;&#x5B9E;&#x73B0;&#x4E86;&#x3002;&#x4ECE;&#x5185;&#x90E8;&#x5B9E;&#x73B0;&#x6765;&#x8BF4;&#xFF0C;&#x5728;TensorFlow&#x5185;&#x6838;&#x6700;&#x57FA;&#x672C;&#x7684;OP&#xFF0C;Context&#x7B49;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x90FD;&#x662F;&#x65B0;&#x7684;&#x3002;&#x4ECE;&#x5916;&#x5728;&#x8868;&#x73B0;&#x6765;&#x8BF4;&#xFF0C;&#x6A21;&#x578B;&#x6587;&#x4EF6;&#x4ECE;PB&#x683C;&#x5F0F;&#x6539;&#x6210;&#x4E86;FlatBuffers&#x683C;&#x5F0F;&#xFF0C;TensorFlow&#x7684;size&#x6709;&#x5927;&#x5E45;&#x5EA6;&#x4F18;&#x5316;&#xFF0C;&#x964D;&#x81F3;300K&#xFF0C;&#x7136;&#x540E;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;converter&#x5C06;&#x666E;&#x901A;TensorFlow&#x6A21;&#x578B;&#x8F6C;&#x5316;&#x6210;TensorFlow Lite&#x9700;&#x8981;&#x7684;&#x683C;&#x5F0F;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x65E0;&#x8BBA;&#x4ECE;&#x54EA;&#x65B9;&#x9762;&#x770B;&#xFF0C;TensorFlow Lite&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x6848;&#x3002;</li>
</ul>
<h3 class="mume-header" id="1779-pocketflow">17.7.9 PocketFlow</h3>

<p>&#xFF11;&#x3001;&#x5F00;&#x6E90;&#x65F6;&#x95F4;&#xFF1A;2018&#x5E74;9&#x6708;</p>
<p>&#xFF12;&#x3001;&#x5F00;&#x6E90;&#x7528;&#x6237;&#xFF1A;&#x817E;&#x8BAF;</p>
<p>&#xFF13;&#x3001;GitHub&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/Tencent/PocketFlow">https://github.com/Tencent/PocketFlow</a></p>
<p>&#xFF14;&#x3001;&#x7B80;&#x4ECB;&#xFF1A;</p>
<p>&#x5168;&#x7403;&#x9996;&#x4E2A;&#x81EA;&#x52A8;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x6846;&#x67B6;</p>
<p>&#x4E00;&#x6B3E;&#x9762;&#x5411;&#x79FB;&#x52A8;&#x7AEF;AI&#x5F00;&#x53D1;&#x8005;&#x7684;&#x81EA;&#x52A8;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x6846;&#x67B6;&#xFF0C;&#x96C6;&#x6210;&#x4E86;&#x5F53;&#x524D;&#x4E3B;&#x6D41;&#x7684;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x4E0E;&#x8BAD;&#x7EC3;&#x7B97;&#x6CD5;&#xFF0C;&#x7ED3;&#x5408;&#x81EA;&#x7814;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#x5B9E;&#x73B0;&#x4E86;&#x5168;&#x7A0B;&#x81EA;&#x52A8;&#x5316;&#x6258;&#x7BA1;&#x5F0F;&#x7684;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x4E0E;&#x52A0;&#x901F;&#x3002;&#x5F00;&#x53D1;&#x8005;&#x65E0;&#x9700;&#x4E86;&#x89E3;&#x5177;&#x4F53;&#x7B97;&#x6CD5;&#x7EC6;&#x8282;&#xFF0C;&#x5373;&#x53EF;&#x5FEB;&#x901F;&#x5730;&#x5C06;AI&#x6280;&#x672F;&#x90E8;&#x7F72;&#x5230;&#x79FB;&#x52A8;&#x7AEF;&#x4EA7;&#x54C1;&#x4E0A;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86;&#x81EA;&#x52A8;&#x6258;&#x7BA1;&#x5F0F;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x4E0E;&#x52A0;&#x901F;&#xFF0C;&#x5B9E;&#x73B0;&#x7528;&#x6237;&#x6570;&#x636E;&#x7684;&#x672C;&#x5730;&#x9AD8;&#x6548;&#x5904;&#x7406;&#x3002;</p>
<p>5&#x3001;&#x6846;&#x67B6;&#x4ECB;&#x7ECD;</p>
<p>PocketFlow &#x6846;&#x67B6;&#x4E3B;&#x8981;&#x7531;&#x4E24;&#x90E8;&#x5206;&#x7EC4;&#x4EF6;&#x6784;&#x6210;&#xFF0C;&#x5206;&#x522B;&#x662F;&#x6A21;&#x578B;&#x538B;&#x7F29;/&#x52A0;&#x901F;&#x7B97;&#x6CD5;&#x7EC4;&#x4EF6;&#x548C;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#xFF0C;&#x5177;&#x4F53;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#x56FE;&#x6240;&#x793A;&#x3002;</p>
<p><img src="./img/ch17/framework_design.png" alt=""></p>
<p>&#x200B;	&#x5F00;&#x53D1;&#x8005;&#x5C06;&#x672A;&#x538B;&#x7F29;&#x7684;&#x539F;&#x59CB;&#x6A21;&#x578B;&#x4F5C;&#x4E3A; PocketFlow &#x6846;&#x67B6;&#x7684;&#x8F93;&#x5165;&#xFF0C;&#x540C;&#x65F6;&#x6307;&#x5B9A;&#x671F;&#x671B;&#x7684;&#x6027;&#x80FD;&#x6307;&#x6807;&#xFF0C;&#x4F8B;&#x5982;&#x6A21;&#x578B;&#x7684;&#x538B;&#x7F29;&#x548C;/&#x6216;&#x52A0;&#x901F;&#x500D;&#x6570;&#xFF1B;&#x5728;&#x6BCF;&#x4E00;&#x8F6E;&#x8FED;&#x4EE3;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#x9009;&#x53D6;&#x4E00;&#x7EC4;&#x8D85;&#x53C2;&#x6570;&#x53D6;&#x503C;&#x7EC4;&#x5408;&#xFF0C;&#x4E4B;&#x540E;&#x6A21;&#x578B;&#x538B;&#x7F29;/&#x52A0;&#x901F;&#x7B97;&#x6CD5;&#x7EC4;&#x4EF6;&#x57FA;&#x4E8E;&#x8BE5;&#x8D85;&#x53C2;&#x6570;&#x53D6;&#x503C;&#x7EC4;&#x5408;&#xFF0C;&#x5BF9;&#x539F;&#x59CB;&#x6A21;&#x578B;&#x8FDB;&#x884C;&#x538B;&#x7F29;&#xFF0C;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x538B;&#x7F29;&#x540E;&#x7684;&#x5019;&#x9009;&#x6A21;&#x578B;&#xFF1B;&#x57FA;&#x4E8E;&#x5BF9;&#x5019;&#x9009;&#x6A21;&#x578B;&#x8FDB;&#x884C;&#x6027;&#x80FD;&#x8BC4;&#x4F30;&#x7684;&#x7ED3;&#x679C;&#xFF0C;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#x8C03;&#x6574;&#x81EA;&#x8EAB;&#x7684;&#x6A21;&#x578B;&#x53C2;&#x6570;&#xFF0C;&#x5E76;&#x9009;&#x53D6;&#x4E00;&#x7EC4;&#x65B0;&#x7684;&#x8D85;&#x53C2;&#x6570;&#x53D6;&#x503C;&#x7EC4;&#x5408;&#xFF0C;&#x4EE5;&#x5F00;&#x59CB;&#x4E0B;&#x4E00;&#x8F6E;&#x8FED;&#x4EE3;&#x8FC7;&#x7A0B;&#xFF1B;&#x5F53;&#x8FED;&#x4EE3;&#x7EC8;&#x6B62;&#x65F6;&#xFF0C;PocketFlow &#x9009;&#x53D6;&#x6700;&#x4F18;&#x7684;&#x8D85;&#x53C2;&#x6570;&#x53D6;&#x503C;&#x7EC4;&#x5408;&#x4EE5;&#x53CA;&#x5BF9;&#x5E94;&#x7684;&#x5019;&#x9009;&#x6A21;&#x578B;&#xFF0C;&#x4F5C;&#x4E3A;&#x6700;&#x7EC8;&#x8F93;&#x51FA;&#xFF0C;&#x8FD4;&#x56DE;&#x7ED9;&#x5F00;&#x53D1;&#x8005;&#x7528;&#x4F5C;&#x79FB;&#x52A8;&#x7AEF;&#x7684;&#x6A21;&#x578B;&#x90E8;&#x7F72;&#x3002;</p>
<p>6&#x3001;PocketFlow&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x4E0E;&#x52A0;&#x901F;&#xFF1F;</p>
<p>&#x200B;	&#x5177;&#x4F53;&#x5730;&#xFF0C;PocketFlow &#x901A;&#x8FC7;&#x4E0B;&#x5217;&#x5404;&#x4E2A;&#x7B97;&#x6CD5;&#x7EC4;&#x4EF6;&#x7684;&#x6709;&#x6548;&#x7ED3;&#x5408;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86;&#x7CBE;&#x5EA6;&#x635F;&#x5931;&#x66F4;&#x5C0F;&#x3001;&#x81EA;&#x52A8;&#x5316;&#x7A0B;&#x5EA6;&#x66F4;&#x9AD8;&#x7684;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#x7684;&#x538B;&#x7F29;&#x4E0E;&#x52A0;&#x901F;&#xFF1A;</p>
<ul>
<li>
<p>a) &#x901A;&#x9053;&#x526A;&#x679D;&#xFF08;channel pruning&#xFF09;&#x7EC4;&#x4EF6;&#xFF1A;&#x5728;CNN&#x7F51;&#x7EDC;&#x4E2D;&#xFF0C;&#x901A;&#x8FC7;&#x5BF9;&#x7279;&#x5F81;&#x56FE;&#x4E2D;&#x7684;&#x901A;&#x9053;&#x7EF4;&#x5EA6;&#x8FDB;&#x884C;&#x526A;&#x679D;&#xFF0C;&#x53EF;&#x4EE5;&#x540C;&#x65F6;&#x964D;&#x4F4E;&#x6A21;&#x578B;&#x5927;&#x5C0F;&#x548C;&#x8BA1;&#x7B97;&#x590D;&#x6742;&#x5EA6;&#xFF0C;&#x5E76;&#x4E14;&#x538B;&#x7F29;&#x540E;&#x7684;&#x6A21;&#x578B;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x57FA;&#x4E8E;&#x73B0;&#x6709;&#x7684;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6846;&#x67B6;&#x8FDB;&#x884C;&#x90E8;&#x7F72;&#x3002;&#x5728;CIFAR-10&#x56FE;&#x50CF;&#x5206;&#x7C7B;&#x4EFB;&#x52A1;&#x4E2D;&#xFF0C;&#x901A;&#x8FC7;&#x5BF9;  ResNet-56 &#x6A21;&#x578B;&#x8FDB;&#x884C;&#x901A;&#x9053;&#x526A;&#x679D;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;2.5&#x500D;&#x52A0;&#x901F;&#x4E0B;&#x5206;&#x7C7B;&#x7CBE;&#x5EA6;&#x635F;&#x5931;0.4%&#xFF0C;3.3&#x500D;&#x52A0;&#x901F;&#x4E0B;&#x7CBE;&#x5EA6;&#x635F;&#x5931;0.7%&#x3002;</p>
</li>
<li>
<p>b) &#x6743;&#x91CD;&#x7A00;&#x758F;&#x5316;&#xFF08;weight sparsification&#xFF09;&#x7EC4;&#x4EF6;&#xFF1A;&#x901A;&#x8FC7;&#x5BF9;&#x7F51;&#x7EDC;&#x6743;&#x91CD;&#x5F15;&#x5165;&#x7A00;&#x758F;&#x6027;&#x7EA6;&#x675F;&#xFF0C;&#x53EF;&#x4EE5;&#x5927;&#x5E45;&#x5EA6;&#x964D;&#x4F4E;&#x7F51;&#x7EDC;&#x6743;&#x91CD;&#x4E2D;&#x7684;&#x975E;&#x96F6;&#x5143;&#x7D20;&#x4E2A;&#x6570;&#xFF1B;&#x538B;&#x7F29;&#x540E;&#x6A21;&#x578B;&#x7684;&#x7F51;&#x7EDC;&#x6743;&#x91CD;&#x53EF;&#x4EE5;&#x4EE5;&#x7A00;&#x758F;&#x77E9;&#x9635;&#x7684;&#x5F62;&#x5F0F;&#x8FDB;&#x884C;&#x5B58;&#x50A8;&#x548C;&#x4F20;&#x8F93;&#xFF0C;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x3002;&#x5BF9;&#x4E8E;  MobileNet &#x56FE;&#x50CF;&#x5206;&#x7C7B;&#x6A21;&#x578B;&#xFF0C;&#x5728;&#x5220;&#x53BB;50%&#x7F51;&#x7EDC;&#x6743;&#x91CD;&#x540E;&#xFF0C;&#x5728; ImageNet &#x6570;&#x636E;&#x96C6;&#x4E0A;&#x7684; Top-1 &#x5206;&#x7C7B;&#x7CBE;&#x5EA6;&#x635F;&#x5931;&#x4EC5;&#x4E3A;0.6%&#x3002;</p>
</li>
<li>
<p>c) &#x6743;&#x91CD;&#x91CF;&#x5316;&#xFF08;weight quantization&#xFF09;&#x7EC4;&#x4EF6;&#xFF1A;&#x901A;&#x8FC7;&#x5BF9;&#x7F51;&#x7EDC;&#x6743;&#x91CD;&#x5F15;&#x5165;&#x91CF;&#x5316;&#x7EA6;&#x675F;&#xFF0C;&#x53EF;&#x4EE5;&#x964D;&#x4F4E;&#x7528;&#x4E8E;&#x8868;&#x793A;&#x6BCF;&#x4E2A;&#x7F51;&#x7EDC;&#x6743;&#x91CD;&#x6240;&#x9700;&#x7684;&#x6BD4;&#x7279;&#x6570;&#xFF1B;&#x56E2;&#x961F;&#x540C;&#x65F6;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;&#x4E8E;&#x5747;&#x5300;&#x548C;&#x975E;&#x5747;&#x5300;&#x4E24;&#x5927;&#x7C7B;&#x91CF;&#x5316;&#x7B97;&#x6CD5;&#x7684;&#x652F;&#x6301;&#xFF0C;&#x53EF;&#x4EE5;&#x5145;&#x5206;&#x5229;&#x7528;  ARM &#x548C; FPGA &#x7B49;&#x8BBE;&#x5907;&#x7684;&#x786C;&#x4EF6;&#x4F18;&#x5316;&#xFF0C;&#x4EE5;&#x63D0;&#x5347;&#x79FB;&#x52A8;&#x7AEF;&#x7684;&#x8BA1;&#x7B97;&#x6548;&#x7387;&#xFF0C;&#x5E76;&#x4E3A;&#x672A;&#x6765;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x82AF;&#x7247;&#x8BBE;&#x8BA1;&#x63D0;&#x4F9B;&#x8F6F;&#x4EF6;&#x652F;&#x6301;&#x3002;&#x4EE5;&#x7528;&#x4E8E; ImageNet  &#x56FE;&#x50CF;&#x5206;&#x7C7B;&#x4EFB;&#x52A1;&#x7684; ResNet-18 &#x6A21;&#x578B;&#x4E3A;&#x4F8B;&#xFF0C;&#x5728;8&#x6BD4;&#x7279;&#x5B9A;&#x70B9;&#x91CF;&#x5316;&#x4E0B;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x7CBE;&#x5EA6;&#x65E0;&#x635F;&#x7684;4&#x500D;&#x538B;&#x7F29;&#x3002;</p>
</li>
<li>
<p>d)&#x7F51;&#x7EDC;&#x84B8;&#x998F;&#xFF08;network distillation&#xFF09;&#x7EC4;&#x4EF6;&#xFF1A;&#x5BF9;&#x4E8E;&#x4E0A;&#x8FF0;&#x5404;&#x79CD;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x7EC4;&#x4EF6;&#xFF0C;&#x901A;&#x8FC7;&#x5C06;&#x672A;&#x538B;&#x7F29;&#x7684;&#x539F;&#x59CB;&#x6A21;&#x578B;&#x7684;&#x8F93;&#x51FA;&#x4F5C;&#x4E3A;&#x989D;&#x5916;&#x7684;&#x76D1;&#x7763;&#x4FE1;&#x606F;&#xFF0C;&#x6307;&#x5BFC;&#x538B;&#x7F29;&#x540E;&#x6A21;&#x578B;&#x7684;&#x8BAD;&#x7EC3;&#xFF0C;&#x5728;&#x538B;&#x7F29;/&#x52A0;&#x901F;&#x500D;&#x6570;&#x4E0D;&#x53D8;&#x7684;&#x524D;&#x63D0;&#x4E0B;&#x5747;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;0.5%-2.0%&#x4E0D;&#x7B49;&#x7684;&#x7CBE;&#x5EA6;&#x63D0;&#x5347;&#x3002;</p>
</li>
<li>
<p>e) &#x591A;GPU&#x8BAD;&#x7EC3;&#xFF08;multi-GPU training&#xFF09;&#x7EC4;&#x4EF6;&#xFF1A;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6A21;&#x578B;&#x8BAD;&#x7EC3;&#x8FC7;&#x7A0B;&#x5BF9;&#x8BA1;&#x7B97;&#x8D44;&#x6E90;&#x8981;&#x6C42;&#x8F83;&#x9AD8;&#xFF0C;&#x5355;&#x4E2A;GPU&#x96BE;&#x4EE5;&#x5728;&#x77ED;&#x65F6;&#x95F4;&#x5185;&#x5B8C;&#x6210;&#x6A21;&#x578B;&#x8BAD;&#x7EC3;&#xFF0C;&#x56E0;&#x6B64;&#x56E2;&#x961F;&#x63D0;&#x4F9B;&#x4E86;&#x5BF9;&#x4E8E;&#x591A;&#x673A;&#x591A;&#x5361;&#x5206;&#x5E03;&#x5F0F;&#x8BAD;&#x7EC3;&#x7684;&#x5168;&#x9762;&#x652F;&#x6301;&#xFF0C;&#x4EE5;&#x52A0;&#x5FEB;&#x4F7F;&#x7528;&#x8005;&#x7684;&#x5F00;&#x53D1;&#x6D41;&#x7A0B;&#x3002;&#x65E0;&#x8BBA;&#x662F;&#x57FA;&#x4E8E;  ImageNet &#x6570;&#x636E;&#x7684;Resnet-50&#x56FE;&#x50CF;&#x5206;&#x7C7B;&#x6A21;&#x578B;&#x8FD8;&#x662F;&#x57FA;&#x4E8E; WMT14 &#x6570;&#x636E;&#x7684; Transformer  &#x673A;&#x5668;&#x7FFB;&#x8BD1;&#x6A21;&#x578B;&#xFF0C;&#x5747;&#x53EF;&#x4EE5;&#x5728;&#x4E00;&#x4E2A;&#x5C0F;&#x65F6;&#x5185;&#x8BAD;&#x7EC3;&#x5B8C;&#x6BD5;&#x3002;[1]</p>
</li>
<li>
<p>f) &#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#xFF08;hyper-parameter optimization&#xFF09;&#x7EC4;&#x4EF6;&#xFF1A;&#x591A;&#x6570;&#x5F00;&#x53D1;&#x8005;&#x5BF9;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x7B97;&#x6CD5;&#x5F80;&#x5F80;&#x4E0D;&#x751A;&#x4E86;&#x89E3;&#xFF0C;&#x4F46;&#x8D85;&#x53C2;&#x6570;&#x53D6;&#x503C;&#x5BF9;&#x6700;&#x7EC8;&#x7ED3;&#x679C;&#x5F80;&#x5F80;&#x6709;&#x7740;&#x5DE8;&#x5927;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x56E0;&#x6B64;&#x56E2;&#x961F;&#x5F15;&#x5165;&#x4E86;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#xFF0C;&#x91C7;&#x7528;&#x4E86;&#x5305;&#x62EC;&#x5F3A;&#x5316;&#x5B66;&#x4E60;&#x7B49;&#x7B97;&#x6CD5;&#x4EE5;&#x53CA;  AI Lab &#x81EA;&#x7814;&#x7684; AutoML  &#x81EA;&#x52A8;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x6846;&#x67B6;&#x6765;&#x6839;&#x636E;&#x5177;&#x4F53;&#x6027;&#x80FD;&#x9700;&#x6C42;&#xFF0C;&#x786E;&#x5B9A;&#x6700;&#x4F18;&#x8D85;&#x53C2;&#x6570;&#x53D6;&#x503C;&#x7EC4;&#x5408;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5BF9;&#x4E8E;&#x901A;&#x9053;&#x526A;&#x679D;&#x7B97;&#x6CD5;&#xFF0C;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x5730;&#x6839;&#x636E;&#x539F;&#x59CB;&#x6A21;&#x578B;&#x4E2D;&#x5404;&#x5C42;&#x7684;&#x5197;&#x4F59;&#x7A0B;&#x5EA6;&#xFF0C;&#x5BF9;&#x5404;&#x5C42;&#x91C7;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x526A;&#x679D;&#x6BD4;&#x4F8B;&#xFF0C;&#x5728;&#x4FDD;&#x8BC1;&#x6EE1;&#x8DB3;&#x6A21;&#x578B;&#x6574;&#x4F53;&#x538B;&#x7F29;&#x500D;&#x6570;&#x7684;&#x524D;&#x63D0;&#x4E0B;&#xFF0C;&#x5B9E;&#x73B0;&#x538B;&#x7F29;&#x540E;&#x6A21;&#x578B;&#x8BC6;&#x522B;&#x7CBE;&#x5EA6;&#x7684;&#x6700;&#x5927;&#x5316;&#x3002;</p>
<p><img src="./img/ch17/packflow1.jpg" alt=""></p>
</li>
</ul>
<p>7&#x3001;PocketFlow &#x6027;&#x80FD;</p>
<p>&#x200B;	&#x901A;&#x8FC7;&#x5F15;&#x5165;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#xFF0C;&#x4E0D;&#x4EC5;&#x907F;&#x514D;&#x4E86;&#x9AD8;&#x95E8;&#x69DB;&#x3001;&#x7E41;&#x7410;&#x7684;&#x4EBA;&#x5DE5;&#x8C03;&#x53C2;&#x5DE5;&#x4F5C;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x4F7F;&#x5F97;  PocketFlow &#x5728;&#x5404;&#x4E2A;&#x538B;&#x7F29;&#x7B97;&#x6CD5;&#x4E0A;&#x5168;&#x9762;&#x8D85;&#x8FC7;&#x4E86;&#x4EBA;&#x5DE5;&#x8C03;&#x53C2;&#x7684;&#x6548;&#x679C;&#x3002;&#x4EE5;&#x56FE;&#x50CF;&#x5206;&#x7C7B;&#x4EFB;&#x52A1;&#x4E3A;&#x4F8B;&#xFF0C;&#x5728; CIFAR-10 &#x548C; ImageNet  &#x7B49;&#x6570;&#x636E;&#x96C6;&#x4E0A;&#xFF0C;PocketFlow &#x5BF9; ResNet &#x548C; MobileNet &#x7B49;&#x591A;&#x79CD; CNN &#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x8FDB;&#x884C;&#x6709;&#x6548;&#x7684;&#x6A21;&#x578B;&#x538B;&#x7F29;&#x4E0E;&#x52A0;&#x901F;&#x3002;</p>
<p>&#x200B;	&#x5728;  CIFAR-10 &#x6570;&#x636E;&#x96C6;&#x4E0A;&#xFF0C;PocketFlow &#x4EE5; ResNet-56  &#x4F5C;&#x4E3A;&#x57FA;&#x51C6;&#x6A21;&#x578B;&#x8FDB;&#x884C;&#x901A;&#x9053;&#x526A;&#x679D;&#xFF0C;&#x5E76;&#x52A0;&#x5165;&#x4E86;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x548C;&#x7F51;&#x7EDC;&#x84B8;&#x998F;&#x7B49;&#x8BAD;&#x7EC3;&#x7B56;&#x7565;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86; 2.5 &#x500D;&#x52A0;&#x901F;&#x4E0B;&#x5206;&#x7C7B;&#x7CBE;&#x5EA6;&#x635F;&#x5931; 0.4%&#xFF0C;3.3 &#x500D;&#x52A0;&#x901F;&#x4E0B;&#x7CBE;&#x5EA6;&#x635F;&#x5931;  0.7%&#xFF0C;&#x4E14;&#x663E;&#x8457;&#x4F18;&#x4E8E;&#x672A;&#x538B;&#x7F29;&#x7684; ResNet-44 &#x6A21;&#x578B;&#xFF1B; &#x5728; ImageNet &#x6570;&#x636E;&#x96C6;&#x4E0A;&#xFF0C;PocketFlow &#x53EF;&#x4EE5;&#x5BF9;&#x539F;&#x672C;&#x5DF2;&#x7ECF;&#x5341;&#x5206;&#x7CBE;&#x7B80;&#x7684;  MobileNet &#x6A21;&#x578B;&#x7EE7;&#x7EED;&#x8FDB;&#x884C;&#x6743;&#x91CD;&#x7A00;&#x758F;&#x5316;&#xFF0C;&#x4EE5;&#x66F4;&#x5C0F;&#x7684;&#x6A21;&#x578B;&#x5C3A;&#x5BF8;&#x53D6;&#x5F97;&#x76F8;&#x4F3C;&#x7684;&#x5206;&#x7C7B;&#x7CBE;&#x5EA6;&#xFF1B;&#x4E0E; Inception-V1&#x3001;ResNet-18  &#x7B49;&#x6A21;&#x578B;&#x76F8;&#x6BD4;&#xFF0C;&#x6A21;&#x578B;&#x5927;&#x5C0F;&#x4EC5;&#x4E3A;&#x540E;&#x8005;&#x7684;&#x7EA6; 20~40%&#xFF0C;&#x4F46;&#x5206;&#x7C7B;&#x7CBE;&#x5EA6;&#x57FA;&#x672C;&#x4E00;&#x81F4;&#xFF08;&#x751A;&#x81F3;&#x66F4;&#x9AD8;&#xFF09;&#x3002;</p>
<p><img src="./img/ch17/packflow2.jpg" alt=""></p>
<p><img src="./img/ch17/packflow3.jpg" alt=""></p>
<p>&#x76F8;&#x6BD4;&#x4E8E;&#x8D39;&#x65F6;&#x8D39;&#x529B;&#x7684;&#x4EBA;&#x5DE5;&#x8C03;&#x53C2;&#xFF0C;PocketFlow &#x6846;&#x67B6;&#x4E2D;&#x7684; AutoML &#x81EA;&#x52A8;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#x4EC5;&#x9700; 10<br>
&#x4F59;&#x6B21;&#x8FED;&#x4EE3;&#x5C31;&#x80FD;&#x8FBE;&#x5230;&#x4E0E;&#x4EBA;&#x5DE5;&#x8C03;&#x53C2;&#x7C7B;&#x4F3C;&#x7684;&#x6027;&#x80FD;&#xFF0C;&#x5728;&#x7ECF;&#x8FC7; 100 &#x6B21;&#x8FED;&#x4EE3;&#x540E;&#x641C;&#x7D22;&#x5F97;&#x5230;&#x7684;&#x8D85;&#x53C2;&#x6570;&#x7EC4;&#x5408;&#x53EF;&#x4EE5;&#x964D;&#x4F4E;&#x7EA6; 0.6%<br>
&#x7684;&#x7CBE;&#x5EA6;&#x635F;&#x5931;&#xFF1B;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#x81EA;&#x52A8;&#x5730;&#x786E;&#x5B9A;&#x7F51;&#x7EDC;&#x4E2D;&#x5404;&#x5C42;&#x6743;&#x91CD;&#x7684;&#x91CF;&#x5316;&#x6BD4;&#x7279;&#x6570;&#xFF0C;PocketFlow &#x5728;&#x5BF9;&#x7528;&#x4E8E; ImageNet &#x56FE;&#x50CF;&#x5206;&#x7C7B;&#x4EFB;&#x52A1;&#x7684;<br>
ResNet-18 &#x6A21;&#x578B;&#x8FDB;&#x884C;&#x538B;&#x7F29;&#x65F6;&#xFF0C;&#x53D6;&#x5F97;&#x4E86;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x6027;&#x80FD;&#x63D0;&#x5347;&#xFF1B;&#x5F53;&#x5E73;&#x5747;&#x91CF;&#x5316;&#x6BD4;&#x7279;&#x6570;&#x4E3A; 4 &#x6BD4;&#x7279;&#x65F6;&#xFF0C;&#x8D85;&#x53C2;&#x6570;&#x4F18;&#x5316;&#x7EC4;&#x4EF6;&#x7684;&#x5F15;&#x5165;&#x53EF;&#x4EE5;&#x5C06;&#x5206;&#x7C7B;&#x7CBE;&#x5EA6;&#x4ECE; 63.6%<br>
&#x63D0;&#x5347;&#x81F3; 68.1%&#xFF08;&#x539F;&#x59CB;&#x6A21;&#x578B;&#x7684;&#x5206;&#x7C7B;&#x7CBE;&#x5EA6;&#x4E3A; 70.3%&#xFF09;&#x3002;</p>
<p><img src="./img/ch17/packflow4.jpg" alt=""></p>
<p><img src="./img/ch17/packflow5.jpg" alt=""></p>
<p><strong>&#x53C2;&#x8003;&#x6587;&#x732E;</strong></p>
<p>[1]  Zhuangwei Zhuang, Mingkui Tan, Bohan Zhuang, Jing Liu, Jiezhang Cao,  Qingyao Wu, Junzhou Huang, Jinhui Zhu,&#x300C;Discrimination-aware Channel  Pruning for Deep Neural Networks&quot;, In Proc. of the 32nd Annual  Conference on Neural Information Processing Systems, NIPS &apos;18, Montreal,  Canada, December 2018.</p>
<p>[2] Jiaxiang  Wu, Weidong Huang, Junzhou Huang, Tong Zhang,&#x300C;Error Compensated  Quantized SGD and its Applications to Large-scale Distributed  Optimization&#x300D;, In Proc. of the 35th International Conference on Machine  Learning, ICML&#x2019;18, Stockholm, Sweden, July 2018.</p>
<h3 class="mume-header" id="17710-%E5%85%B6%E4%BB%96%E5%87%A0%E6%AC%BE%E6%94%AF%E6%8C%81%E7%A7%BB%E5%8A%A8%E7%AB%AF%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6">17.7.10 &#x5176;&#x4ED6;&#x51E0;&#x6B3E;&#x652F;&#x6301;&#x79FB;&#x52A8;&#x7AEF;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x7684;&#x5F00;&#x6E90;&#x6846;&#x67B6;</h3>

<p><a href="https://blog.csdn.net/zchang81/article/details/74280019">https://blog.csdn.net/zchang81/article/details/74280019</a></p>
<h3 class="mume-header" id="17711-mdl-ncnn%E5%92%8C-tflite%E6%AF%94%E8%BE%83">17.7.11 MDL&#x3001;NCNN&#x548C; TFLite&#x6BD4;&#x8F83;</h3>

<p>&#x767E;&#x5EA6;-MDL&#x6846;&#x67B6;&#x3001;&#x817E;&#x8BAF;-NCNN&#x6846;&#x67B6;&#x548C;&#x8C37;&#x6B4C;TFLite&#x6846;&#x67B6;&#x6BD4;&#x8F83;&#x3002;</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">MDL</th>
<th style="text-align:center">NCNN</th>
<th style="text-align:center">TFLite</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x4EE3;&#x7801;&#x8D28;&#x91CF;</td>
<td style="text-align:center">&#x4E2D;</td>
<td style="text-align:center">&#x9AD8;</td>
<td style="text-align:center">&#x5F88;&#x9AD8;</td>
</tr>
<tr>
<td style="text-align:center">&#x8DE8;&#x5E73;&#x53F0;</td>
<td style="text-align:center">&#x221A;</td>
<td style="text-align:center">&#x221A;</td>
<td style="text-align:center">&#x221A;</td>
</tr>
<tr>
<td style="text-align:center">&#x652F;&#x6301;caffe&#x6A21;&#x578B;</td>
<td style="text-align:center">&#x221A;</td>
<td style="text-align:center">&#x221A;</td>
<td style="text-align:center">&#xD7;</td>
</tr>
<tr>
<td style="text-align:center">&#x652F;&#x6301;TensorFlow&#x6A21;&#x578B;</td>
<td style="text-align:center">&#xD7;</td>
<td style="text-align:center">&#xD7;</td>
<td style="text-align:center">&#x221A;</td>
</tr>
<tr>
<td style="text-align:center">CPU NEON&#x6307;&#x4EE4;&#x4F18;&#x5316;</td>
<td style="text-align:center">&#x221A;</td>
<td style="text-align:center">&#x221A;</td>
<td style="text-align:center">&#x221A;</td>
</tr>
<tr>
<td style="text-align:center">GPU&#x52A0;&#x901F;</td>
<td style="text-align:center">&#x221A;</td>
<td style="text-align:center">&#xD7;</td>
<td style="text-align:center">&#xD7;</td>
</tr>
</tbody>
</table>
<p>&#x76F8;&#x540C;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x53EA;&#x542B;&#x63A8;&#x7406;&#xFF08;inference&#xFF09;&#x529F;&#x80FD;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x6A21;&#x578B;&#x6587;&#x4EF6;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x79BB;&#x7EBF;&#x7684;&#x65B9;&#x5F0F;&#x8BAD;&#x7EC3;&#x5F97;&#x5230;&#x3002;</li>
<li>&#x6700;&#x7EC8;&#x751F;&#x6210;&#x7684;&#x5E93;&#x5C3A;&#x5BF8;&#x8F83;&#x5C0F;&#xFF0C;&#x5747;&#x5C0F;&#x4E8E;500kB&#x3002;</li>
<li>&#x4E3A;&#x4E86;&#x63D0;&#x5347;&#x6267;&#x884C;&#x901F;&#x5EA6;&#xFF0C;&#x90FD;&#x4F7F;&#x7528;&#x4E86;ARM NEON&#x6307;&#x4EE4;&#x8FDB;&#x884C;&#x52A0;&#x901F;&#x3002;</li>
<li>&#x8DE8;&#x5E73;&#x53F0;&#xFF0C;iOS&#x548C;Android&#x7CFB;&#x7EDF;&#x90FD;&#x652F;&#x6301;&#x3002;</li>
</ul>
<p>&#x4E0D;&#x540C;&#x70B9;&#xFF1A;</p>
<ul>
<li>MDL&#x548C;NCNN&#x5747;&#x662F;&#x53EA;&#x652F;&#x6301;Caffe&#x6846;&#x67B6;&#x751F;&#x6210;&#x7684;&#x6A21;&#x578B;&#x6587;&#x4EF6;&#xFF0C;&#x800C;TfLite&#x5219;&#x6BEB;&#x65E0;&#x610F;&#x5916;&#x7684;&#x53EA;&#x652F;&#x6301;&#x81EA;&#x5BB6;&#x5927;&#x54E5;TensorFlow&#x6846;&#x67B6;&#x751F;&#x6210;&#x7684;&#x6A21;&#x578B;&#x6587;&#x4EF6;&#x3002;</li>
<li>MDL&#x652F;&#x6301;&#x5229;&#x7528;iOS&#x7CFB;&#x7EDF;&#x7684;Matal&#x6846;&#x67B6;&#x8FDB;&#x884C;GPU&#x52A0;&#x901F;&#xFF0C;&#x80FD;&#x591F;&#x663E;&#x8457;&#x63D0;&#x5347;&#x5728;iPhone&#x4E0A;&#x7684;&#x8FD0;&#x884C;&#x901F;&#x5EA6;&#xFF0C;&#x8FBE;&#x5230;&#x51C6;&#x5B9E;&#x65F6;&#x7684;&#x6548;&#x679C;&#x3002;&#x800C;NCNN&#x548C;TFLite&#x8FD8;&#x6CA1;&#x6709;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x3002;</li>
</ul>
<h2 class="mume-header" id="178-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2">17.8 &#x79FB;&#x52A8;&#x7AEF;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#x90E8;&#x7F72;</h2>

<h3 class="mume-header" id="1781-%E4%BB%A5ncnn%E4%B8%BA%E4%BE%8B">17.8.1 &#x4EE5;NCNN&#x4E3A;&#x4F8B;</h3>

<p>&#x90E8;&#x7F72;&#x6B65;&#x9AA4;</p>
<h3 class="mume-header" id="1782-%E4%BB%A5qnnpack%E4%B8%BA%E4%BE%8B">17.8.2 &#x4EE5;QNNPACK&#x4E3A;&#x4F8B;</h3>

<p>&#x90E8;&#x7F72;&#x6B65;&#x9AA4;</p>
<h3 class="mume-header" id="1784-%E5%9C%A8android%E6%89%8B%E6%9C%BA%E4%B8%8A%E4%BD%BF%E7%94%A8mace%E5%AE%9E%E7%8E%B0%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB">17.8.4 &#x5728;Android&#x624B;&#x673A;&#x4E0A;&#x4F7F;&#x7528;MACE&#x5B9E;&#x73B0;&#x56FE;&#x50CF;&#x5206;&#x7C7B;</h3>

<h3 class="mume-header" id="1783-%E5%9C%A8android%E6%89%8B%E6%9C%BA%E4%B8%8A%E4%BD%BF%E7%94%A8paddlemobile%E5%AE%9E%E7%8E%B0%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB">17.8.3 &#x5728;Android&#x624B;&#x673A;&#x4E0A;&#x4F7F;&#x7528;PaddleMobile&#x5B9E;&#x73B0;&#x56FE;&#x50CF;&#x5206;&#x7C7B;</h3>

<p><strong>&#x7F16;&#x8BD1;paddle-mobile&#x5E93;</strong></p>
<p>1&#xFF09;&#x7F16;&#x8BD1;Android&#x80FD;&#x591F;&#x4F7F;&#x7528;&#x7684;CPP&#x5E93;&#xFF1A;&#x7F16;&#x8BD1;Android&#x7684;paddle-mobile&#x5E93;&#xFF0C;&#x53EF;&#x9009;&#x62E9;&#x4F7F;&#x7528;Docker&#x7F16;&#x8BD1;&#x548C;Ubuntu&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;&#xFF0C;&#x8FD9;&#x91CC;&#x4ECB;&#x7ECD;&#x4F7F;&#x7528;Ubuntu&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;paddle-mobile&#x5E93;&#x3002;</p>
<p><em>&#x6CE8;</em>&#xFF1A;&#x5728;Android&#x9879;&#x76EE;&#xFF0C;Java&#x4EE3;&#x7801;&#x8C03;&#x7528;CPP&#x4EE3;&#x7801;&#xFF0C;CPP&#x7684;&#x51FD;&#x6570;&#x9700;&#x8981;&#x9075;&#x5FAA;&#x4E00;&#x5B9A;&#x7684;&#x547D;&#x540D;&#x89C4;&#x8303;&#xFF0C;&#x6BD4;&#x5982;Java_&#x5305;&#x540D;_&#x7C7B;&#x540D;_&#x5BF9;&#x5E94;&#x7684;Java&#x7684;&#x65B9;&#x6CD5;&#x540D;&#x3002;</p>
<p>&#x200B;	&#x76EE;&#x524D;&#x5B98;&#x65B9;&#x63D0;&#x4F9B;&#x4E86;5&#x4E2A;&#x53EF;&#x4EE5;&#x7ED9;Java&#x8C03;&#x7528;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x8BE5;&#x4EE3;&#x7801;&#x5728;&#xFF1A;paddle-mobile/src/jni/paddle_mobile_jni.cpp&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8981;&#x8BA9;&#x8FD9;&#x4E9B;&#x51FD;&#x6570;&#x80FD;&#x591F;&#x5728;&#x81EA;&#x5DF1;&#x7684;&#x5305;&#x540D;&#x4E0B;&#x7684;&#x7C7B;&#x8C03;&#x7528;&#xFF0C;&#x5C31;&#x8981;&#x4FEE;&#x6539;CPP&#x7684;&#x51FD;&#x6570;&#x540D;&#x79F0;&#x4FEE;&#x6539;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java">JNIEXPORT jboolean JNICALL <span class="token function">Java_com_baidu_paddle_PML_load</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> 
	jclass thiz<span class="token punctuation">,</span>
	jstring modelPath<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
		<span class="token function">ANDROIDLOGI</span><span class="token punctuation">(</span><span class="token string">&quot;load invoked&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		bool optimize <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 
		<span class="token keyword">return</span> <span class="token function">getPaddleMobileInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token function">jstring2cppstring</span><span class="token punctuation">(</span>env<span class="token punctuation">,</span> modelPath<span class="token punctuation">)</span><span class="token punctuation">,</span> optimize<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</pre><p>&#x200B;	&#x7B14;&#x8005;&#x9879;&#x76EE;&#x7684;&#x5305;&#x540D;&#x4E3A;<code>com.example.paddlemobile1</code>&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x5305;&#x4E0B;&#x6709;&#x4E00;&#x4E2A;<code>ImageRecognition.java</code>&#x7684;&#x7A0B;&#x5E8F;&#x6765;&#x5BF9;&#x5E94;&#x8FD9;&#x4E2A;CPP&#x7A0B;&#x5E8F;&#xFF0C;&#x90A3;&#x4E48;&#x4FEE;&#x6539;<code>load</code>&#x51FD;&#x6570;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java">JNIEXPORT jboolean JNICALL <span class="token function">Java_com_example_paddlemobile1_ImageRecognition_load</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span>
                                                          jclass thiz<span class="token punctuation">,</span>
                                                          jstring modelPath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">ANDROIDLOGI</span><span class="token punctuation">(</span><span class="token string">&quot;load invoked&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  bool optimize <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">getPaddleMobileInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token function">jstring2cppstring</span><span class="token punctuation">(</span>env<span class="token punctuation">,</span> modelPath<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                         optimize<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p><strong>&#x4F7F;&#x7528;Ubuntu&#x4EA4;&#x53C9;&#x7F16;&#x8BD1;paddle-mobile&#x5E93;</strong></p>
<p>1&#x3001;&#x4E0B;&#x8F7D;&#x548C;&#x89E3;&#x538B;NDK&#x3002;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>wget https://dl.google.com/android/repository/android-ndk-r17b-linux-x86_64.zip
unzip android-ndk-r17b-linux-x86_64.zip
</code></pre><p>2&#x3001;&#x8BBE;&#x7F6E;NDK&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF0C;&#x76EE;&#x5F55;&#x662F;NDK&#x7684;&#x89E3;&#x538B;&#x76EE;&#x5F55;&#x3002;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>export NDK_ROOT=&quot;/home/test/paddlepaddle/android-ndk-r17b&quot;
</code></pre><p>&#x8BBE;&#x7F6E;&#x597D;&#x4E4B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x7684;&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x914D;&#x7F6E;&#x60C5;&#x51B5;&#x3002;</p>
<pre class="language-text">root@test:/home/test/paddlepaddle# echo $NDK_ROOT
/home/test/paddlepaddle/android-ndk-r17b
</pre>
<p>3&#x3001;&#x5B89;&#x88C5;cmake&#xFF0C;&#x9700;&#x8981;&#x5B89;&#x88C5;&#x8F83;&#x9AD8;&#x7248;&#x672C;&#x7684;&#xFF0C;&#x7B14;&#x8005;&#x7684;cmake&#x7248;&#x672C;&#x662F;3.11.2&#x3002;</p>
<p>&#x4E0B;&#x8F7D;cmake&#x6E90;&#x7801;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>wget https://cmake.org/files/v3.11/cmake-3.11.2.tar.gz
</code></pre><p>&#x89E3;&#x538B;cmake&#x6E90;&#x7801;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>tar -zxvf cmake-3.11.2.tar.gz
</code></pre><p>&#x8FDB;&#x5165;&#x5230;cmake&#x6E90;&#x7801;&#x6839;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x6267;&#x884C;bootstrap&#x3002;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>cd cmake-3.11.2
./bootstrap
</code></pre><p>&#x6700;&#x540E;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x4E24;&#x6761;&#x547D;&#x4EE4;&#x5F00;&#x59CB;&#x5B89;&#x88C5;cmake&#x3002;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>make
make install
</code></pre><p>&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;cmake --version&#x662F;&#x5426;&#x5B89;&#x88C5;&#x6210;&#x529F;.</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>root@test:/home/test/paddlepaddle# cmake --version
cmake version 3.11.2

CMake suite maintained and supported by Kitware (kitware.com/cmake).
</code></pre><p>4&#x3001;&#x514B;&#x9686;paddle-mobile&#x6E90;&#x7801;&#x3002;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git clone https://github.com/PaddlePaddle/paddle-mobile.git
</code></pre><p>5&#x3001;&#x8FDB;&#x5165;&#x5230;paddle-mobile&#x7684;tools&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x6267;&#x884C;&#x7F16;&#x8BD1;&#x3002;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>cd paddle-mobile/tools/
sh build.sh android
</code></pre><p>&#xFF08;&#x53EF;&#x9009;&#xFF09;&#x5982;&#x679C;&#x60F3;&#x7F16;&#x8BD1;&#x9488;&#x5BF9;&#x67D0;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x7F16;&#x8BD1;&#x66F4;&#x5C0F;&#x7684;&#x5E93;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;&#x547D;&#x4EE4;&#x540E;&#x9762;&#x52A0;&#x4E0A;&#x76F8;&#x5E94;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>sh build.sh android googlenet
</code></pre><p>6&#x3001;&#x6700;&#x540E;&#x4F1A;&#x5728;paddle-mobile/build/release/arm-v7a/build&#x76EE;&#x5F55;&#x4E0B;&#x751F;&#x4EA7;paddle-mobile&#x5E93;&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java">root<span class="token annotation punctuation">@test</span><span class="token operator">:</span><span class="token operator">/</span>home<span class="token operator">/</span>test<span class="token operator">/</span>paddlepaddle<span class="token operator">/</span>paddle<span class="token operator">-</span>mobile<span class="token operator">/</span>build<span class="token operator">/</span>release<span class="token operator">/</span>arm<span class="token operator">-</span>v7a<span class="token operator">/</span>build# ls
libpaddle<span class="token operator">-</span>mobile<span class="token punctuation">.</span>so
</pre><p>libpaddle-mobile.so&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5728;&#x5F00;&#x53D1;Android&#x9879;&#x76EE;&#x7684;&#x65F6;&#x5019;&#x4F7F;&#x7528;&#x5230;&#x7684;paddle-mobile&#x5E93;&#x3002;</p>
<p><strong>&#x521B;&#x5EFA;Android&#x9879;&#x76EE;</strong></p>
<p>1&#x3001;&#x9996;&#x5148;&#x4F7F;&#x7528;Android Studio&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;Android&#x9879;&#x76EE;&#xFF0C;&#x5305;&#x540D;&#x4E3A;<code>com.example.paddlemobile1</code></p>
<p>2&#x3001;&#x5728;main&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA;l&#x4E24;&#x4E2A;assets/paddle_models&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x5B58;&#x653E;PaddleFluid&#x8BAD;&#x7EC3;&#x597D;&#x7684;&#x9884;&#x6D4B;&#x6A21;&#x578B;&#x3002;PaddleMobile&#x652F;&#x6301;&#x91CF;&#x5316;&#x6A21;&#x578B;&#xFF0C;&#x4F7F;&#x7528;&#x6A21;&#x578B;&#x91CF;&#x5316;&#x53EF;&#x4EE5;&#x628A;&#x6A21;&#x578B;&#x7F29;&#x5C0F;&#x81F3;&#x539F;&#x6765;&#x7684;&#x56DB;&#x5206;&#x4E4B;&#x4E00;&#xFF0C;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x91CF;&#x5316;&#x6A21;&#x578B;&#xFF0C;&#x90A3;&#x52A0;&#x8F7D;&#x6A21;&#x578B;&#x7684;&#x63A5;&#x53E3;&#x4E5F;&#x6709;&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x7684;&#x63A5;&#x53E3;&#x52A0;&#x8F7D;&#x6A21;&#x578B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">boolean</span> <span class="token function">loadQualified</span><span class="token punctuation">(</span>String modelDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><p>3&#x3001;&#x5728;<code>main</code>&#x76EE;&#x5F55;&#x4E0B;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<code>jniLibs</code>&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x662F;&#x5B58;&#x653E;CPP&#x7F16;&#x8BD1;&#x5E93;&#x7684;&#xFF0C;&#x5728;&#x672C;&#x9879;&#x76EE;&#x4E2D;&#x5C31;&#x5B58;&#x653E;&#x4E0A;&#x4E00;&#x90E8;&#x5206;&#x7F16;&#x8BD1;&#x7684;<code>libpaddle-mobile.so</code></p>
<p>4&#x3001;&#x5728;Android&#x9879;&#x76EE;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x5939;&#x4E2D;&#x52A0;&#x4E0A;&#x6743;&#x9650;&#x58F0;&#x660E;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x8981;&#x4F7F;&#x7528;&#x5230;&#x8BFB;&#x53D6;&#x76F8;&#x518C;&#x548C;&#x4F7F;&#x7528;&#x76F8;&#x673A;&#xFF0C;&#x6240;&#x4EE5;&#x52A0;&#x4E0A;&#x4EE5;&#x4E0B;&#x7684;&#x6743;&#x9650;&#x58F0;&#x660E;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;android.permission.CAMERA&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>uses<span class="token operator">-</span>permission android<span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</pre><p>5&#x3001;&#x4FEE;&#x6539;<code>activity_main.xml</code>&#x754C;&#x9762;&#xFF0C;&#x4FEE;&#x6539;&#x6210;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>RelativeLayout xmlns<span class="token operator">:</span>android<span class="token operator">=</span><span class="token string">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    xmlns<span class="token operator">:</span>app<span class="token operator">=</span><span class="token string">&quot;http://schemas.android.com/apk/res-auto&quot;</span>
    xmlns<span class="token operator">:</span>tools<span class="token operator">=</span><span class="token string">&quot;http://schemas.android.com/tools&quot;</span>
    android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">&quot;match_parent&quot;</span>
    android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">&quot;match_parent&quot;</span>
    tools<span class="token operator">:</span>context<span class="token operator">=</span><span class="token string">&quot;.MainActivity&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>LinearLayout
    android<span class="token operator">:</span>id<span class="token operator">=</span><span class="token string">&quot;@+id/btn_ll&quot;</span>
    android<span class="token operator">:</span>layout_alignParentBottom<span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
    android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">&quot;match_parent&quot;</span>
    android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">&quot;wrap_content&quot;</span>
    android<span class="token operator">:</span>orientation<span class="token operator">=</span><span class="token string">&quot;horizontal&quot;</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>Button
        android<span class="token operator">:</span>id<span class="token operator">=</span><span class="token string">&quot;@+id/use_photo&quot;</span>
        android<span class="token operator">:</span>layout_weight<span class="token operator">=</span><span class="token string">&quot;1&quot;</span>
        android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">&quot;0dp&quot;</span>
        android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">&quot;wrap_content&quot;</span>
        android<span class="token operator">:</span>text<span class="token operator">=</span><span class="token string">&quot;&#x76F8;&#x518C;&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>Button
        android<span class="token operator">:</span>id<span class="token operator">=</span><span class="token string">&quot;@+id/start_camera&quot;</span>
        android<span class="token operator">:</span>layout_weight<span class="token operator">=</span><span class="token string">&quot;1&quot;</span>
        android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">&quot;0dp&quot;</span>
        android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">&quot;wrap_content&quot;</span>
        android<span class="token operator">:</span>text<span class="token operator">=</span><span class="token string">&quot;&#x62CD;&#x7167;&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>LinearLayout<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>TextView
    android<span class="token operator">:</span>layout_above<span class="token operator">=</span><span class="token string">&quot;@id/btn_ll&quot;</span>
    android<span class="token operator">:</span>id<span class="token operator">=</span><span class="token string">&quot;@+id/result_text&quot;</span>
    android<span class="token operator">:</span>textSize<span class="token operator">=</span><span class="token string">&quot;16sp&quot;</span>
    android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">&quot;match_parent&quot;</span>
    android<span class="token operator">:</span>hint<span class="token operator">=</span><span class="token string">&quot;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x4F1A;&#x5728;&#x8FD9;&#x91CC;&#x663E;&#x793A;&quot;</span>
    android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">&quot;100dp&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>ImageView
    android<span class="token operator">:</span>layout_alignParentTop<span class="token operator">=</span><span class="token string">&quot;true&quot;</span>
    android<span class="token operator">:</span>layout_above<span class="token operator">=</span><span class="token string">&quot;@id/result_text&quot;</span>
    android<span class="token operator">:</span>id<span class="token operator">=</span><span class="token string">&quot;@+id/show_image&quot;</span>
    android<span class="token operator">:</span>layout_width<span class="token operator">=</span><span class="token string">&quot;match_parent&quot;</span>
    android<span class="token operator">:</span>layout_height<span class="token operator">=</span><span class="token string">&quot;match_parent&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>RelativeLayout<span class="token operator">&gt;</span>
</pre><p>6&#x3001;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<code>ImageRecognition.java</code>&#x7684;Java&#x7A0B;&#x5E8F;&#xFF0C;&#x8FD9;&#x4E2A;&#x7A0B;&#x5E8F;&#x7684;&#x4F5C;&#x7528;&#x5C31;&#x662F;&#x8C03;&#x7528;<code>paddle-mobile/src/jni/paddle_mobile_jni.cpp</code>&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x5BF9;&#x5E94;&#x7684;&#x662F;&#x91CC;&#x9762;&#x7684;&#x51FD;&#x6570;&#x3002;&#x76EE;&#x524D;&#x652F;&#x6301;&#x4E00;&#x4E0B;&#x51E0;&#x4E2A;&#x63A5;&#x53E3;&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>paddlemobile1<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImageRecognition</span> <span class="token punctuation">{</span>
    <span class="token comment">// set thread num</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">setThread</span><span class="token punctuation">(</span><span class="token keyword">int</span> threadCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Load seperated parameters</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">boolean</span> <span class="token function">load</span><span class="token punctuation">(</span>String modelDir<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// load qualified model</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">boolean</span> <span class="token function">loadQualified</span><span class="token punctuation">(</span>String modelDir<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Load combined parameters</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">boolean</span> <span class="token function">loadCombined</span><span class="token punctuation">(</span>String modelPath<span class="token punctuation">,</span> String paramPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// load qualified model</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">boolean</span> <span class="token function">loadCombinedQualified</span><span class="token punctuation">(</span>String modelPath<span class="token punctuation">,</span> String paramPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// object detection</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">predictImage</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span>ddims<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// predict yuv image</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">predictYuv</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buf<span class="token punctuation">,</span> <span class="token keyword">int</span> imgWidth<span class="token punctuation">,</span> <span class="token keyword">int</span> imgHeight<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ddims<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span>meanValues<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// clear model</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><p>7&#x3001;&#x7136;&#x540E;&#x7F16;&#x5199;&#x4E00;&#x4E2A;<code>PhotoUtil.java</code>&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#x3002;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>paddlemobile1<span class="token punctuation">;</span>

<span class="token keyword">import</span> android<span class="token punctuation">.</span>app<span class="token punctuation">.</span>Activity<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Context<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Intent<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>database<span class="token punctuation">.</span>Cursor<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span>Bitmap<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span>BitmapFactory<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>net<span class="token punctuation">.</span>Uri<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Build<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>MediaStore<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>support<span class="token punctuation">.</span>v4<span class="token punctuation">.</span>content<span class="token punctuation">.</span>FileProvider<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Log<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>File<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Arrays<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PhotoUtil</span> <span class="token punctuation">{</span>
<span class="token comment">// start camera</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> Uri <span class="token function">start_camera</span><span class="token punctuation">(</span>Activity activity<span class="token punctuation">,</span> <span class="token keyword">int</span> requestCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Uri imageUri<span class="token punctuation">;</span>
    <span class="token comment">// save image in cache path</span>
    File outputImage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>activity<span class="token punctuation">.</span><span class="token function">getExternalCacheDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;out_image.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>outputImage<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            outputImage<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        outputImage<span class="token punctuation">.</span><span class="token function">createNewFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Build<span class="token punctuation">.</span>VERSION<span class="token punctuation">.</span>SDK_INT <span class="token operator">&gt;=</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// compatible with Android 7.0 or over</span>
        imageUri <span class="token operator">=</span> FileProvider<span class="token punctuation">.</span><span class="token function">getUriForFile</span><span class="token punctuation">(</span>activity<span class="token punctuation">,</span>
                <span class="token string">&quot;com.example.paddlemobile1&quot;</span><span class="token punctuation">,</span> outputImage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        imageUri <span class="token operator">=</span> Uri<span class="token punctuation">.</span><span class="token function">fromFile</span><span class="token punctuation">(</span>outputImage<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// set system camera Action</span>
    Intent intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span>MediaStore<span class="token punctuation">.</span>ACTION_IMAGE_CAPTURE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// set save photo path</span>
    intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span>MediaStore<span class="token punctuation">.</span>EXTRA_OUTPUT<span class="token punctuation">,</span> imageUri<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// set photo quality, min is 0, max is 1</span>
    intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span>MediaStore<span class="token punctuation">.</span>EXTRA_VIDEO_QUALITY<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    activity<span class="token punctuation">.</span><span class="token function">startActivityForResult</span><span class="token punctuation">(</span>intent<span class="token punctuation">,</span> requestCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> imageUri<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// get picture in photo</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">use_photo</span><span class="token punctuation">(</span>Activity activity<span class="token punctuation">,</span> <span class="token keyword">int</span> requestCode<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Intent intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span>Intent<span class="token punctuation">.</span>ACTION_PICK<span class="token punctuation">)</span><span class="token punctuation">;</span>
    intent<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;image/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    activity<span class="token punctuation">.</span><span class="token function">startActivityForResult</span><span class="token punctuation">(</span>intent<span class="token punctuation">,</span> requestCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// get photo from Uri</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> String <span class="token function">get_path_from_URI</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> Uri uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    String result<span class="token punctuation">;</span>
    Cursor cursor <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        result <span class="token operator">=</span> uri<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        cursor<span class="token punctuation">.</span><span class="token function">moveToFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> idx <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span>MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>ImageColumns<span class="token punctuation">.</span>DATA<span class="token punctuation">)</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">/</span><span class="token operator">/</span> Compress the image to the size of the training image&#xFF0C;and change RGB
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getScaledMatrix</span><span class="token punctuation">(</span>Bitmap bitmap<span class="token punctuation">,</span> <span class="token keyword">int</span> desWidth<span class="token punctuation">,</span>
                               <span class="token keyword">int</span> desHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dataBuf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">float</span><span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">*</span> desWidth <span class="token operator">*</span> desHeight<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> rIndex<span class="token punctuation">;</span>
    <span class="token keyword">int</span> gIndex<span class="token punctuation">;</span>
    <span class="token keyword">int</span> bIndex<span class="token punctuation">;</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pixels <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>desWidth <span class="token operator">*</span> desHeight<span class="token punctuation">]</span><span class="token punctuation">;</span>
    Bitmap bm <span class="token operator">=</span> Bitmap<span class="token punctuation">.</span><span class="token function">createScaledBitmap</span><span class="token punctuation">(</span>bitmap<span class="token punctuation">,</span> desWidth<span class="token punctuation">,</span> desHeight<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bm<span class="token punctuation">.</span><span class="token function">getPixels</span><span class="token punctuation">(</span>pixels<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> desWidth<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> desWidth<span class="token punctuation">,</span> desHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pixels<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> clr <span class="token operator">=</span> pixels<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        j <span class="token operator">=</span> i <span class="token operator">/</span> desHeight<span class="token punctuation">;</span>
        k <span class="token operator">=</span> i <span class="token operator">%</span> desWidth<span class="token punctuation">;</span>
        rIndex <span class="token operator">=</span> j <span class="token operator">*</span> desWidth <span class="token operator">+</span> k<span class="token punctuation">;</span>
        gIndex <span class="token operator">=</span> rIndex <span class="token operator">+</span> desHeight <span class="token operator">*</span> desWidth<span class="token punctuation">;</span>
        bIndex <span class="token operator">=</span> gIndex <span class="token operator">+</span> desHeight <span class="token operator">*</span> desWidth<span class="token punctuation">;</span>
        dataBuf<span class="token punctuation">[</span>rIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>clr <span class="token operator">&amp;</span> <span class="token number">0x00ff0000</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">148</span><span class="token punctuation">;</span>
        dataBuf<span class="token punctuation">[</span>gIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>clr <span class="token operator">&amp;</span> <span class="token number">0x0000ff00</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">148</span><span class="token punctuation">;</span>
        dataBuf<span class="token punctuation">[</span>bIndex<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>clr <span class="token operator">&amp;</span> <span class="token number">0x000000ff</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">148</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bm<span class="token punctuation">.</span><span class="token function">isRecycled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        bm<span class="token punctuation">.</span><span class="token function">recycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dataBuf<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">/</span><span class="token operator">/</span> compress picture
<span class="token keyword">public</span> <span class="token keyword">static</span> Bitmap <span class="token function">getScaleBitmap</span><span class="token punctuation">(</span>String filePath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    BitmapFactory<span class="token punctuation">.</span>Options opt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BitmapFactory<span class="token punctuation">.</span>Options</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    opt<span class="token punctuation">.</span>inJustDecodeBounds <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    BitmapFactory<span class="token punctuation">.</span><span class="token function">decodeFile</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> opt<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> bmpWidth <span class="token operator">=</span> opt<span class="token punctuation">.</span>outWidth<span class="token punctuation">;</span>
    <span class="token keyword">int</span> bmpHeight <span class="token operator">=</span> opt<span class="token punctuation">.</span>outHeight<span class="token punctuation">;</span>

    <span class="token keyword">int</span> maxSize <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>

    <span class="token operator">/</span><span class="token operator">/</span> compress picture with inSampleSize
    opt<span class="token punctuation">.</span>inSampleSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bmpWidth <span class="token operator">/</span> opt<span class="token punctuation">.</span>inSampleSize <span class="token operator">&lt;</span> maxSize <span class="token operator">||</span> bmpHeight <span class="token operator">/</span> opt<span class="token punctuation">.</span>inSampleSize <span class="token operator">&lt;</span> maxSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        opt<span class="token punctuation">.</span>inSampleSize <span class="token operator">*=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    opt<span class="token punctuation">.</span>inJustDecodeBounds <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> BitmapFactory<span class="token punctuation">.</span><span class="token function">decodeFile</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><ul>
<li>start_camera()&#x65B9;&#x6CD5;&#x662F;&#x542F;&#x52A8;&#x76F8;&#x673A;&#x5E76;&#x8FD4;&#x56DE;&#x56FE;&#x7247;&#x7684;URI&#x3002;</li>
<li>use_photo()&#x65B9;&#x6CD5;&#x662F;&#x6253;&#x5F00;&#x76F8;&#x518C;&#xFF0C;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x56FE;&#x7247;URI&#x5728;&#x56DE;&#x5230;&#x51FD;&#x6570;&#x4E2D;&#x83B7;&#x53D6;&#x3002;</li>
<li>get_path_from_URI()&#x65B9;&#x6CD5;&#x662F;&#x628A;&#x56FE;&#x7247;&#x7684;URI&#x8F6C;&#x6362;&#x6210;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#x3002;</li>
<li>getScaledMatrix()&#x65B9;&#x6CD5;&#x662F;&#x628A;&#x56FE;&#x7247;&#x538B;&#x7F29;&#x6210;&#x8DDF;&#x8BAD;&#x7EC3;&#x65F6;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x5E76;&#x8F6C;&#x6362;&#x6210;&#x9884;&#x6D4B;&#x9700;&#x8981;&#x7528;&#x7684;&#x6570;&#x636E;&#x683C;&#x5F0F;&#x6D6E;&#x70B9;&#x6570;&#x7EC4;&#x3002;</li>
<li>getScaleBitmap()&#x65B9;&#x6CD5;&#x662F;&#x5BF9;&#x56FE;&#x7247;&#x8FDB;&#x884C;&#x7B49;&#x6BD4;&#x4F8B;&#x538B;&#x7F29;&#xFF0C;&#x51CF;&#x5C11;&#x5185;&#x5B58;&#x7684;&#x652F;&#x51FA;&#x3002;</li>
</ul>
<p>8&#x3001;&#x6700;&#x540E;&#x4FEE;&#x6539;<code>MainActivity.java</code>&#xFF0C;&#x4FEE;&#x6539;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre data-role="codeBlock" data-info="java" class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>paddlemobile1<span class="token punctuation">;</span>

<span class="token keyword">import</span> android<span class="token punctuation">.</span>Manifest<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>SuppressLint<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>app<span class="token punctuation">.</span>Activity<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Context<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>Intent<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>content<span class="token punctuation">.</span>pm<span class="token punctuation">.</span>PackageManager<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>graphics<span class="token punctuation">.</span>Bitmap<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>net<span class="token punctuation">.</span>Uri<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Bundle<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>os<span class="token punctuation">.</span>Environment<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>support<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>NonNull<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>support<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Nullable<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>support<span class="token punctuation">.</span>v4<span class="token punctuation">.</span>app<span class="token punctuation">.</span>ActivityCompat<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>support<span class="token punctuation">.</span>v4<span class="token punctuation">.</span>content<span class="token punctuation">.</span>ContextCompat<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>support<span class="token punctuation">.</span>v7<span class="token punctuation">.</span>app<span class="token punctuation">.</span>AppCompatActivity<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Log<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>view<span class="token punctuation">.</span>View<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>Button<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>ImageView<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>TextView<span class="token punctuation">;</span>
<span class="token keyword">import</span> android<span class="token punctuation">.</span>widget<span class="token punctuation">.</span>Toast<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>bumptech<span class="token punctuation">.</span>glide<span class="token punctuation">.</span>Glide<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>bumptech<span class="token punctuation">.</span>glide<span class="token punctuation">.</span>load<span class="token punctuation">.</span>engine<span class="token punctuation">.</span>DiskCacheStrategy<span class="token punctuation">;</span>
<span class="token keyword">import</span> com<span class="token punctuation">.</span>bumptech<span class="token punctuation">.</span>glide<span class="token punctuation">.</span>request<span class="token punctuation">.</span>RequestOptions<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>File<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>FileOutputStream<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStream<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ArrayList<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Arrays<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String TAG <span class="token operator">=</span> MainActivity<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> USE_PHOTO <span class="token operator">=</span> <span class="token number">1001</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> START_CAMERA <span class="token operator">=</span> <span class="token number">1002</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> Uri image_uri<span class="token punctuation">;</span>
    <span class="token keyword">private</span> ImageView show_image<span class="token punctuation">;</span>
    <span class="token keyword">private</span> TextView result_text<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String assets_path <span class="token operator">=</span> <span class="token string">&quot;paddle_models&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> load_result <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ddims <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> PADDLE_MODEL <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;lenet&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;alexnet&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;vgg16&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;resnet&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;googlenet&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;mobilenet_v1&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;mobilenet_v2&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;inception_v1&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;inception_v2&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;squeezenet&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// load paddle-mobile api</span>
<span class="token keyword">static</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        System<span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token string">&quot;paddle-mobile&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsatisfiedLinkError</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NullPointerException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span>Bundle savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setContentView</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// initialize view</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">request_permissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    show_image <span class="token operator">=</span> <span class="token punctuation">(</span>ImageView<span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>show_image<span class="token punctuation">)</span><span class="token punctuation">;</span>
    result_text <span class="token operator">=</span> <span class="token punctuation">(</span>TextView<span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>result_text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Button use_photo <span class="token operator">=</span> <span class="token punctuation">(</span>Button<span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>use_photo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Button start_photo <span class="token operator">=</span> <span class="token punctuation">(</span>Button<span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span>R<span class="token punctuation">.</span>id<span class="token punctuation">.</span>start_camera<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// use photo click</span>
    use_photo<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span>View view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            PhotoUtil<span class="token punctuation">.</span><span class="token function">use_photo</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> USE_PHOTO<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//                load_model();</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre><pre data-role="codeBlock" data-info="java" class="language-java">    <span class="token comment">// start camera click</span>
    start_photo<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span>View view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            image_uri <span class="token operator">=</span> PhotoUtil<span class="token punctuation">.</span><span class="token function">start_camera</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> START_CAMERA<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// copy file from assets to sdcard</span>
    String sdcard_path <span class="token operator">=</span> Environment<span class="token punctuation">.</span><span class="token function">getExternalStorageDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> File<span class="token punctuation">.</span>separator <span class="token operator">+</span> assets_path<span class="token punctuation">;</span>
    <span class="token function">copy_file_from_asset</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> assets_path<span class="token punctuation">,</span> sdcard_path<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// load model</span>
    <span class="token function">load_model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// load infer model</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">load_model</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    String model_path <span class="token operator">=</span> Environment<span class="token punctuation">.</span><span class="token function">getExternalStorageDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> File<span class="token punctuation">.</span>separator <span class="token operator">+</span> assets_path <span class="token operator">+</span> File<span class="token punctuation">.</span>separator <span class="token operator">+</span> PADDLE_MODEL<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> model_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    load_result <span class="token operator">=</span> ImageRecognition<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>model_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>load_result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;model load success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;model load fail&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// clear infer model</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">clear_model</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ImageRecognition<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;model is clear&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// copy file from asset to sdcard</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">copy_file_from_asset</span><span class="token punctuation">(</span>Context context<span class="token punctuation">,</span> String oldPath<span class="token punctuation">,</span> String newPath<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        String<span class="token punctuation">[</span><span class="token punctuation">]</span> fileNames <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span>oldPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>fileNames<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// directory</span>
            File file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>newPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                file<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// copy recursivelyC</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>String fileName <span class="token operator">:</span> fileNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">copy_file_from_asset</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> oldPath <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> fileName<span class="token punctuation">,</span> newPath <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;copy files finish&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// file</span>
            File file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>newPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// if file exists will never copy</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// copy file to new path</span>
            InputStream is <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getAssets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>oldPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            FileOutputStream fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> byteCount<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>byteCount <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                fos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> byteCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            fos<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onActivityResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> requestCode<span class="token punctuation">,</span> <span class="token keyword">int</span> resultCode<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> Intent data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    String image_path<span class="token punctuation">;</span>
    RequestOptions options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skipMemoryCache</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">diskCacheStrategy</span><span class="token punctuation">(</span>DiskCacheStrategy<span class="token punctuation">.</span>NONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>resultCode <span class="token operator">==</span> Activity<span class="token punctuation">.</span>RESULT_OK<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>requestCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> USE_PHOTO<span class="token operator">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    Log<span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;user photo data is null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                image_uri <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Glide<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>image_uri<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span>show_image<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// get image path from uri</span>
                image_path <span class="token operator">=</span> PhotoUtil<span class="token punctuation">.</span><span class="token function">get_path_from_URI</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> image_uri<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// show result</span>
                result_text<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// predict image</span>
                <span class="token function">predict_image</span><span class="token punctuation">(</span>PhotoUtil<span class="token punctuation">.</span><span class="token function">get_path_from_URI</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> image_uri<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> START_CAMERA<span class="token operator">:</span>
                <span class="token comment">// show photo</span>
                Glide<span class="token punctuation">.</span><span class="token function">with</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>image_uri<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span>show_image<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// get image path from uri</span>
                image_path <span class="token operator">=</span> PhotoUtil<span class="token punctuation">.</span><span class="token function">get_path_from_URI</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> image_uri<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// show result</span>
                result_text<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// predict image</span>
                <span class="token function">predict_image</span><span class="token punctuation">(</span>PhotoUtil<span class="token punctuation">.</span><span class="token function">get_path_from_URI</span><span class="token punctuation">(</span>MainActivity<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> image_uri<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@SuppressLint</span><span class="token punctuation">(</span><span class="token string">&quot;SetTextI18n&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">predict_image</span><span class="token punctuation">(</span>String image_path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// picture to float array</span>
    Bitmap bmp <span class="token operator">=</span> PhotoUtil<span class="token punctuation">.</span><span class="token function">getScaleBitmap</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inputData <span class="token operator">=</span> PhotoUtil<span class="token punctuation">.</span><span class="token function">getScaledMatrix</span><span class="token punctuation">(</span>bmp<span class="token punctuation">,</span> ddims<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ddims<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// get predict result</span>
        <span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> ImageRecognition<span class="token punctuation">.</span><span class="token function">predictImage</span><span class="token punctuation">(</span>inputData<span class="token punctuation">,</span> ddims<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>TAG<span class="token punctuation">,</span> <span class="token string">&quot;origin predict result:&quot;</span> <span class="token operator">+</span> Arrays<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> end <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> time <span class="token operator">=</span> end <span class="token operator">-</span> start<span class="token punctuation">;</span>
        Log<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;result length&quot;</span><span class="token punctuation">,</span> String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// show predict result and time</span>
        <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token function">get_max_result</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        String show_text <span class="token operator">=</span> <span class="token string">&quot;result&#xFF1A;&quot;</span> <span class="token operator">+</span> r <span class="token operator">+</span> <span class="token string">&quot;\nprobability&#xFF1A;&quot;</span> <span class="token operator">+</span> result<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;\ntime&#xFF1A;&quot;</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">&quot;ms&quot;</span><span class="token punctuation">;</span>
        result_text<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>show_text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">get_max_result</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">float</span> probability <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> result<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>probability <span class="token operator">&lt;</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            probability <span class="token operator">=</span> result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            r <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> r<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// request permissions</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">request_permissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    List<span class="token generics function"><span class="token punctuation">&lt;</span>String<span class="token punctuation">&gt;</span></span> permissionList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ContextCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>CAMERA<span class="token punctuation">)</span> <span class="token operator">!=</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        permissionList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>CAMERA<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>ContextCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>WRITE_EXTERNAL_STORAGE<span class="token punctuation">)</span> <span class="token operator">!=</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        permissionList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>WRITE_EXTERNAL_STORAGE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>ContextCompat<span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>READ_EXTERNAL_STORAGE<span class="token punctuation">)</span> <span class="token operator">!=</span> PackageManager<span class="token punctuation">.</span>PERMISSION_GRANTED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        permissionList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Manifest<span class="token punctuation">.</span>permission<span class="token punctuation">.</span>READ_EXTERNAL_STORAGE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// if list is not empty will request permissions</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>permissionList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ActivityCompat<span class="token punctuation">.</span><span class="token function">requestPermissions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> permissionList<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span>permissionList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> requestCode<span class="token punctuation">,</span> <span class="token annotation punctuation">@NonNull</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> permissions<span class="token punctuation">,</span> <span class="token annotation punctuation">@NonNull</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> grantResults<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> grantResults<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>requestCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>grantResults<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> grantResults<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

                    <span class="token keyword">int</span> grantResult <span class="token operator">=</span> grantResults<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>grantResult <span class="token operator">==</span> PackageManager<span class="token punctuation">.</span>PERMISSION_DENIED<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        String s <span class="token operator">=</span> permissions<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                        Toast<span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> s <span class="token operator">+</span> <span class="token string">&quot; permission was denied&quot;</span><span class="token punctuation">,</span> Toast<span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// clear model before destroy app</span>
    <span class="token function">clear_model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><ul>
<li>load_model()&#x65B9;&#x6CD5;&#x662F;&#x52A0;&#x8F7D;&#x9884;&#x6D4B;&#x6A21;&#x578B;&#x7684;&#x3002;</li>
<li>clear_model()&#x65B9;&#x6CD5;&#x662F;&#x6E05;&#x7A7A;&#x9884;&#x6D4B;&#x6A21;&#x578B;&#x7684;&#x3002;</li>
<li>copy_file_from_asset()&#x65B9;&#x6CD5;&#x662F;&#x628A;&#x9884;&#x6D4B;&#x6A21;&#x578B;&#x590D;&#x5236;&#x5230;&#x5185;&#x5B58;&#x5361;&#x4E0A;&#x3002;</li>
<li>predict_image()&#x65B9;&#x6CD5;&#x662F;&#x9884;&#x6D4B;&#x56FE;&#x7247;&#x7684;&#x3002;</li>
<li>get_max_result()&#x65B9;&#x6CD5;&#x662F;&#x83B7;&#x53D6;&#x6982;&#x7387;&#x6700;&#x5927;&#x7684;&#x9884;&#x6D4B;&#x7ED3;&#x679C;&#x3002;</li>
<li>request_permissions()&#x65B9;&#x6CD5;&#x662F;&#x52A8;&#x6001;&#x8BF7;&#x6C42;&#x6743;&#x9650;&#x7684;&#x3002;</li>
</ul>
<p>&#x56E0;&#x4E3A;&#x4F7F;&#x7528;&#x5230;&#x56FE;&#x50CF;&#x52A0;&#x8F7D;&#x6846;&#x67B6;Glide&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x5728;<code>build.gradle</code>&#x52A0;&#x5165;&#x4EE5;&#x4E0B;&#x7684;&#x5F15;&#x7528;&#x3002;</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>implementation &apos;com.github.bumptech.glide:glide:4.3.1&apos;
</code></pre><p>8&#x3001;&#x6700;&#x540E;&#x8FD0;&#x884C;&#x9879;&#x76EE;&#xFF0C;&#x9009;&#x62E9;&#x56FE;&#x7247;&#x9884;&#x6D4B;&#x5C31;&#x4F1A;&#x5F97;&#x5230;&#x7ED3;&#x679C;&#x3002;</p>
<h2 class="mume-header" id="179-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6%E9%83%A8%E7%BD%B2%E7%96%91%E9%9A%BE">17.9 &#x79FB;&#x52A8;&#x7AEF;&#x5F00;&#x6E90;&#x6846;&#x67B6;&#x90E8;&#x7F72;&#x7591;&#x96BE;</h2>

<p>&#x589E;&#x52A0;&#x5E38;&#x89C1;&#x7684;&#x51E0;&#x4E2A;&#x95EE;&#x9898;</p>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>